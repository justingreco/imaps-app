"use strict";(globalThis.webpackChunkimaps_app=globalThis.webpackChunkimaps_app||[]).push([[5072],{40237:(t,n,e)=>{e.d(n,{N:()=>i});const i={convertToGEGeometry:function(t,n){return null==n?null:t.convertJSONToGeometry(n)},exportPoint:function(t,n,e){const i=new s(t.getPointX(n),t.getPointY(n),e),o=t.hasZ(n),r=t.hasM(n);return o&&(i.z=t.getPointZ(n)),r&&(i.m=t.getPointM(n)),i},exportPolygon:function(t,n,e){return new o(t.exportPaths(n),e,t.hasZ(n),t.hasM(n))},exportPolyline:function(t,n,e){return new r(t.exportPaths(n),e,t.hasZ(n),t.hasM(n))},exportMultipoint:function(t,n,e){return new a(t.exportPoints(n),e,t.hasZ(n),t.hasM(n))},exportExtent:function(t,n,e){const i=t.hasZ(n),s=t.hasM(n),o=new c(t.getXMin(n),t.getYMin(n),t.getXMax(n),t.getYMax(n),e);if(i){const e=t.getZExtent(n);o.zmin=e.vmin,o.zmax=e.vmax}if(s){const e=t.getMExtent(n);o.mmin=e.vmin,o.mmax=e.vmax}return o}};class s{constructor(t,n,e){this.x=t,this.y=n,this.spatialReference=e,this.z=void 0,this.m=void 0}}class o{constructor(t,n,e,i){this.rings=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,e&&(this.hasZ=e),i&&(this.hasM=i)}}class r{constructor(t,n,e,i){this.paths=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,e&&(this.hasZ=e),i&&(this.hasM=i)}}class a{constructor(t,n,e,i){this.points=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,e&&(this.hasZ=e),i&&(this.hasM=i)}}class c{constructor(t,n,e,i,s){this.xmin=t,this.ymin=n,this.xmax=e,this.ymax=i,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},85981:(t,n,e)=>{e.d(n,{AR:()=>M,Gr:()=>f,JG:()=>h,Jk:()=>l,KU:()=>p,Ue:()=>c,al:()=>u,ct:()=>m,nF:()=>g,zk:()=>d});var i=e(16889),s=e(21530),o=e(11186),r=e(71353),a=e(11185);function c(t){return t?{origin:(0,r.a)(t.origin),vector:(0,r.a)(t.vector)}:{origin:(0,r.c)(),vector:(0,r.c)()}}function h(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c();return u(t.origin,t.vector,n)}function u(t,n){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c();return(0,o.c)(e.origin,t),(0,o.c)(e.vector,n),e}function d(t,n){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c();return(0,o.c)(e.origin,t),(0,o.b)(e.vector,n,t),e}function l(t,n){const e=(0,o.b)(a.WM.get(),n,t.origin),s=(0,o.e)(t.vector,e),r=(0,o.e)(t.vector,t.vector),c=(0,i.uZ)(s/r,0,1),h=(0,o.b)(a.WM.get(),(0,o.g)(a.WM.get(),t.vector,c),e);return(0,o.e)(h,h)}function g(t,n,e){return m(t,n,0,1,e)}function p(t,n,e){return(0,o.a)(e,t.origin,(0,o.g)(e,t.vector,n))}function m(t,n,e,s,r){const{vector:c,origin:h}=t,u=(0,o.b)(a.WM.get(),n,h),d=(0,o.e)(c,u)/(0,o.p)(c);return(0,o.g)(r,c,(0,i.uZ)(d,e,s)),(0,o.a)(r,r,t.origin)}function f(t,n){if(x(t,function(t,n){const e=_.get();return e.origin=t,e.vector=n,e}(n.origin,n.direction),!1,v)){const{tA:n,pB:e,distance2:i}=v;if(n>=0&&n<=1)return i;if(n<0)return(0,o.d)(t.origin,e);if(n>1)return(0,o.d)((0,o.a)(a.WM.get(),t.origin,t.vector),e)}return null}function M(t,n,e){return!!x(t,n,!0,v)&&((0,o.c)(e,v.pA),!0)}function x(t,n,e,s){const r=1e-6,c=t.origin,h=(0,o.a)(a.WM.get(),c,t.vector),u=n.origin,d=(0,o.a)(a.WM.get(),u,n.vector),l=a.WM.get(),g=a.WM.get();if(l[0]=c[0]-u[0],l[1]=c[1]-u[1],l[2]=c[2]-u[2],g[0]=d[0]-u[0],g[1]=d[1]-u[1],g[2]=d[2]-u[2],Math.abs(g[0])<r&&Math.abs(g[1])<r&&Math.abs(g[2])<r)return!1;const p=a.WM.get();if(p[0]=h[0]-c[0],p[1]=h[1]-c[1],p[2]=h[2]-c[2],Math.abs(p[0])<r&&Math.abs(p[1])<r&&Math.abs(p[2])<r)return!1;const m=l[0]*g[0]+l[1]*g[1]+l[2]*g[2],f=g[0]*p[0]+g[1]*p[1]+g[2]*p[2],M=l[0]*p[0]+l[1]*p[1]+l[2]*p[2],x=g[0]*g[0]+g[1]*g[1]+g[2]*g[2],v=(p[0]*p[0]+p[1]*p[1]+p[2]*p[2])*x-f*f;if(Math.abs(v)<r)return!1;let _=(m*f-M*x)/v,b=(m+f*_)/x;e&&(_=(0,i.uZ)(_,0,1),b=(0,i.uZ)(b,0,1));const y=a.WM.get(),w=a.WM.get();return y[0]=c[0]+_*p[0],y[1]=c[1]+_*p[1],y[2]=c[2]+_*p[2],w[0]=u[0]+b*g[0],w[1]=u[1]+b*g[1],w[2]=u[2]+b*g[2],s.tA=_,s.tB=b,s.pA=y,s.pB=w,s.distance2=(0,o.d)(y,w),!0}const v={tA:0,tB:0,pA:(0,r.c)(),pB:(0,r.c)(),distance2:0},_=new s.x((()=>({origin:null,vector:null})))},19995:(t,n,e)=>{e.d(n,{_W:()=>l,iV:()=>m,oj:()=>M});var i=e(92026),s=e(79803),o=e(40237),r=e(92975),a=e(81753);const c=[0,0];function h(t,n){if(!n)return null;if("x"in n){const e={x:0,y:0};return[e.x,e.y]=t(n.x,n.y,c),null!=n.z&&(e.z=n.z),null!=n.m&&(e.m=n.m),e}if("xmin"in n){const e={xmin:0,ymin:0,xmax:0,ymax:0};return[e.xmin,e.ymin]=t(n.xmin,n.ymin,c),[e.xmax,e.ymax]=t(n.xmax,n.ymax,c),n.hasZ&&(e.zmin=n.zmin,e.zmax=n.zmax,e.hasZ=!0),n.hasM&&(e.mmin=n.mmin,e.mmax=n.mmax,e.hasM=!0),e}return"rings"in n?{rings:u(n.rings,t),hasM:n.hasM,hasZ:n.hasZ}:"paths"in n?{paths:u(n.paths,t),hasM:n.hasM,hasZ:n.hasZ}:"points"in n?{points:d(n.points,t),hasM:n.hasM,hasZ:n.hasZ}:void 0}function u(t,n){const e=[];for(const i of t)e.push(d(i,n));return e}function d(t,n){const e=[];for(const i of t){const t=n(i[0],i[1],[0,0]);e.push(t),i.length>2&&t.push(i[2]),i.length>3&&t.push(i[3])}return e}async function l(t,n){if(!n)return;const e=Array.isArray(t)?t.map((t=>(0,i.pC)(t.geometry)&&t.geometry.spatialReference)):[t];await(0,s.iQ)(e.map((t=>({source:t,dest:n}))))}const g=h.bind(null,a.hG),p=h.bind(null,a.R6);function m(t,n,e,i){if(!t)return t;if(e||(e=n,n=t.spatialReference),!(0,r.JY)(n)||!(0,r.JY)(e)||(0,r.fS)(n,e))return t;if((0,a.Q8)(n,e)){const n=(0,r.sS)(e)?g(t):p(t);return n.spatialReference=e,n}return(0,s.oj)(o.N,[t],n,e,null,i)[0]}const f=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(t,n,e){if(!t||!t.length||!n||!e||(0,r.fS)(n,e))return t;const i={geometries:t,inSpatialReference:n,outSpatialReference:e,resolve:null};return this._jobs.push(i),new Promise((t=>{i.resolve=t,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const t=this._jobs.shift();if(!t)return;const{geometries:n,inSpatialReference:e,outSpatialReference:i,resolve:c}=t;(0,a.Q8)(e,i)?(0,r.sS)(i)?c(n.map(g)):c(n.map(p)):c((0,s.oj)(o.N,n,e,i,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function M(t,n,e){return f.push(t,n,e)}},97731:(t,n,e)=>{e.d(n,{E6:()=>h,Kj:()=>l,RQ:()=>m,T:()=>r,ep:()=>c,hu:()=>o,kG:()=>d,tM:()=>p,u_:()=>u,yK:()=>a,zF:()=>g});var i=e(6394);e(90045);(0,e(67077).c)();class s{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}function o(t,n){if(!t)throw n=n||"assert",console.log(new Error(n).stack),new s(n)}function r(t,n){t||(n=n||"",console.warn("Verify failed: "+n+"\n"+new Error("verify").stack))}function a(t,n,e,i){let s,o=(e[0]-t[0])/n[0],r=(i[0]-t[0])/n[0];o>r&&(s=o,o=r,r=s);let a=(e[1]-t[1])/n[1],c=(i[1]-t[1])/n[1];if(a>c&&(s=a,a=c,c=s),o>c||a>r)return!1;a>o&&(o=a),c<r&&(r=c);let h=(e[2]-t[2])/n[2],u=(i[2]-t[2])/n[2];return h>u&&(s=h,h=u,u=s),!(o>u||h>r)&&(u<r&&(r=u),!(r<0))}function c(t,n,e,s,o){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:(0,i.a)();const a=(s[o]-e[o])*(n[0]-t[0])-(s[0]-e[0])*(n[o]-t[o]),c=(s[0]-e[0])*(t[o]-e[o])-(s[o]-e[o])*(t[0]-e[0]);if(0===a)return!1;const h=c/a;return r[0]=t[0]+h*(n[0]-t[0]),r[1]=t[o]+h*(n[o]-t[o]),!0}function h(t,n){return Math.log(t)/Math.log(n)}function u(t,n,e,i){t[12]=n,t[13]=e,t[14]=i}function d(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&1===t[15]}function l(t,n,e){return 2*Math.atan(Math.sqrt(n*n+e*e)*Math.tan(.5*t)/n)}function g(t,n,e){return 2*Math.atan(Math.sqrt(n*n+e*e)*Math.tan(.5*t)/e)}function p(t,n,e){return 2*Math.atan(n*Math.tan(.5*t)/Math.sqrt(n*n+e*e))}function m(t,n,e){return 2*Math.atan(e*Math.tan(.5*t)/Math.sqrt(n*n+e*e))}},54357:(t,n,e)=>{e.r(n),e.d(n,{SceneLayerSnappingSourceWorker:()=>p,default:()=>m});var i=e(27366),s=e(92026),o=e(66978),r=(e(32718),e(25243),e(63780),e(93169),e(75366),e(69912)),a=e(11186),c=e(71353),h=e(85981),u=e(23470),d=e(92536),l=e(78329),g=e(11438);let p=class{constructor(){this._idToComponent=new Map,this._components=new l.Z((t=>t.bounds)),this._edges=new l.Z((t=>t.bounds)),this._tmpLineSegment=(0,h.Ue)(),this._tmpP1=(0,c.c)(),this._tmpP2=(0,c.c)(),this._tmpP3=(0,c.c)(),this.remoteClient=null}async fetchCandidates(t,n){await Promise.resolve(),(0,o.k_)(n),await this._ensureEdgeLocations(t,n);const e=[];return this._edges.forEachNeighbor((n=>this._addCandidates(t,n,e)),t.bounds),{result:{candidates:e}}}async _ensureEdgeLocations(t,n){const e=[];if(this._components.forEachNeighbor((t=>{if((0,s.Wi)(t.info)){const{id:n,uid:i}=t;e.push({id:n,uid:i})}}),t.bounds),!e.length)return;const i={components:e},o=await this.remoteClient.invoke("fetchAllEdgeLocations",i,(0,s.Pt)(n,{}));for(const s of o.components)this._setFetchEdgeLocations(s)}async add(t){const n=new f(t.id,t.bounds);return this._idToComponent.set(n.id,n),this._components.add([n]),{result:{}}}async remove(t){const n=this._idToComponent.get(t.id);if(n){const t=[];this._edges.forEachNeighbor((e=>{e.component===n&&t.push(e)}),n.bounds),this._edges.remove(t),this._components.remove([n]),this._idToComponent.delete(n.id)}return{result:{}}}_setFetchEdgeLocations(t){const n=this._idToComponent.get(t.id);if((0,s.Wi)(n)||t.uid!==n.uid)return;const e=g.extractComponentsEdgeLocationsLayout.createView(t.locations),i=new Array(e.count),o=(0,c.c)(),r=(0,c.c)();for(let s=0;s<e.count;s++){const c=(0,u.c)(),h=(0,u.g)(c);e.position0.getVec(s,o),e.position1.getVec(s,r),(0,a.C)(h,h,o,.5),(0,a.C)(h,h,r,.5),(0,a.a)(h,h,t.origin),c[3]=(0,a.i)(h,o);const d=new M(n,s,c);i[s]=d}this._edges.add(i);const{objectIds:h,origin:d}=t;n.info={locations:e,objectIds:h,origin:d}}_addCandidates(t,n,e){const{locations:i,origin:s,objectIds:o}=n.component.info,r=i.position0.getVec(n.index,this._tmpP1),c=i.position1.getVec(n.index,this._tmpP2);(0,a.a)(r,r,s),(0,a.a)(c,c,s);const h=o[i.componentIndex.get(n.index)];this._addEdgeCandidate(t,h,r,c,e),this._addVertexCandidate(t,h,r,e),this._addVertexCandidate(t,h,c,e)}_addEdgeCandidate(t,n,e,i,s){if(!(t.types&d.r.EDGE))return;const o=(0,u.g)(t.bounds),r=(0,h.zk)(e,i,this._tmpLineSegment),l=(0,h.nF)(r,o,this._tmpP3);if(!(0,u.m)(t.bounds,l))return null;s.push({type:"edge",objectId:n,target:(0,c.a)(l),distance:(0,a.i)(o,l),start:(0,c.a)(e),end:(0,c.a)(i)})}_addVertexCandidate(t,n,e,i){if(!(t.types&d.r.VERTEX))return;const s=(0,u.g)(t.bounds);if(!(0,u.m)(t.bounds,e))return null;i.push({type:"vertex",objectId:n,target:(0,c.a)(e),distance:(0,a.i)(s,e)})}};function m(){return new p}p=(0,i._)([(0,r.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],p);class f{constructor(t,n){this.id=t,this.bounds=n,this.info=null,this.uid=++f.uid}}f.uid=0;class M{constructor(t,n,e){this.component=t,this.index=n,this.bounds=e}}}}]);
//# sourceMappingURL=5072.26a7ccf2.chunk.js.map