"use strict";(globalThis.webpackChunkimaps_app=globalThis.webpackChunkimaps_app||[]).push([[8340],{88340:(e,t,o)=>{o.r(t),o.d(t,{Bookmarks:()=>$e,default:()=>We});var i=o(72791),s=o(27366),a=o(98928),r=o(100),n=o(92026),d=o(94172),l=o(8025),u=(o(63780),o(93169),o(89125)),k=o(49861),m=o(69912),c=o(76969),h=o(26838),b=o(69407),_=o(85015);o(25243);let p=class extends _.Z{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}};(0,s._)([(0,k.Cb)()],p.prototype,"bookmark",void 0),(0,s._)([(0,k.Cb)({readOnly:!0})],p.prototype,"editedBookmark",null),(0,s._)([(0,k.Cb)()],p.prototype,"state",null),(0,s._)([(0,k.Cb)()],p.prototype,"validationState",void 0),(0,s._)([(0,k.Cb)()],p.prototype,"loading",void 0),p=(0,s._)([(0,m.j)("esri.widgets.Bookmarks.UserState")],p);const g=p;var v=o(13894),B=o(40281),w=o(10064),f=o(91505),E=o(32718),y=o(2284),I=o(99505);const S="esri.widgets.Bookmarks.BookmarksViewModel",C=E.Z.getLogger(S),x=B.Z.ofType(y.Z),A={width:128,height:128,format:"png"},T={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},U={time:!0};let M=class extends((0,I._)(f.Z.EventedAccessor)){constructor(e){super(e),this.abilities={...U},this.activeBookmark=null}destroy(){this.view=null,this._set("activeBookmark",null)}castAbilities(e){return{...U,...e}}set bookmarks(e){void 0!==e?this._override("bookmarks",e):this._clearOverride("bookmarks")}get bookmarks(){return this.get("view.map.bookmarks")||new x}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...T,...e})}get defaultCreateOptions(){return T}set defaultEditOptions(e){this._set("defaultEditOptions",{...T,...e})}get defaultEditOptions(){return T}get state(){const e=this.get("view");return e&&!e.ready?"loading":"ready"}get view(){return this._get("view")}set view(e){e&&"2d"!==e.type&&C.error(new w.Z("view:invalid-view","SceneView is not supported",{view:e})),this._set("view",e)}async createBookmark(e){const{view:t,defaultCreateOptions:o,abilities:i}=this;if(!t){const e=new w.Z("create-bookmark:invalid-view","Cannot create a bookmark without a view.");throw C.error(e),e}const{takeScreenshot:s,screenshotSettings:a,captureViewpoint:r,captureRotation:d,captureScale:l,captureTimeExtent:u}={...o,...e},k=s?await this._createThumbnail(a):void 0,m=i.time&&u&&(0,n.pC)(t.timeExtent)?t.timeExtent.clone():void 0;return new y.Z({...k&&{thumbnail:k},...u&&{timeExtent:m},...r&&{viewpoint:this._createViewpoint({view:t,captureScale:l,captureRotation:d})}})}async editBookmark(e,t){const{view:o,defaultEditOptions:i}=this;if(!o){const e=new w.Z("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");throw C.error(e),e}const{takeScreenshot:s,screenshotSettings:a,captureViewpoint:r,captureRotation:d,captureScale:l,captureTimeExtent:u}={...i,...t},k=s?await this._createThumbnail(a):void 0;return k&&(e.thumbnail=k),r&&(e.viewpoint=this._createViewpoint({view:o,captureScale:l,captureRotation:d})),u&&(0,n.pC)(o.timeExtent)&&(e.timeExtent=o.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:e}),e}goTo(e){const{abilities:t,view:o}=this;if(!o){const e=new w.Z("go-to:invalid-view","Cannot go to a bookmark without a view");return C.error(e),Promise.reject(e)}const i=e?.viewpoint;if(!i){const t=new w.Z("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:e});return C.error(t),Promise.reject(t)}this._set("activeBookmark",e);const s={target:i},a=this.callGoTo(s),r=e?.timeExtent;return t.time&&r&&(o.timeExtent=r),this.emit("bookmark-select",{bookmark:e}),a.catch((()=>{})).then((()=>this._set("activeBookmark",null))),a}async _createThumbnail(e){const t=await this.view.takeScreenshot({...A,...e});return new h.A({url:t.dataUrl})}_createViewpoint(e){let{view:t,captureRotation:o,captureScale:i}=e;const s=t.viewpoint?.clone();return new v.Z({targetGeometry:t.extent?.clone(),rotation:o&&s?.rotation||0,scale:i&&s?.scale||0})}};(0,s._)([(0,k.Cb)()],M.prototype,"abilities",void 0),(0,s._)([(0,u.p)("abilities")],M.prototype,"castAbilities",null),(0,s._)([(0,k.Cb)({readOnly:!0})],M.prototype,"activeBookmark",void 0),(0,s._)([(0,k.Cb)({type:x})],M.prototype,"bookmarks",null),(0,s._)([(0,k.Cb)()],M.prototype,"defaultCreateOptions",null),(0,s._)([(0,k.Cb)()],M.prototype,"defaultEditOptions",null),(0,s._)([(0,k.Cb)({readOnly:!0})],M.prototype,"state",null),(0,s._)([(0,k.Cb)({value:null})],M.prototype,"view",null),M=(0,s._)([(0,m.j)(S)],M);const N=M;var O=o(70098),R=o(61524),Z=o(96919),H=o(80975),D=o(80532),P=o(93531),F=o(67005),L=o(70281);const V="data-bookmark-uid",q="esri-bookmarks esri-widget--panel",j="esri-bookmarks__loader-container",z="esri-bookmarks__loader",K="esri-bookmarks__list",Y="esri-bookmarks__list--sortable",G="esri-bookmarks__bookmark",$="esri-bookmarks__bookmark-button",W="esri-bookmarks__bookmark-image-container",X="esri-bookmarks__bookmark-edit-button-container",J="esri-bookmarks__bookmark-edit-button",Q="esri-bookmarks_bookmark-drag-handle",ee="esri-bookmarks_bookmark-drag-handle-icon",te="esri-bookmarks__bookmark-icon",oe="esri-bookmarks__image",ie="esri-bookmarks__bookmark-label",se="esri-bookmarks__bookmark-name",ae="esri-bookmarks__bookmark-time-extent",re="esri-bookmarks__bookmark--active",ne="esri-widget__content--empty",de="esri-bookmarks__no-bookmarks-heading",le="esri-widget__no-bookmark-icon",ue="esri-bookmarks__no-bookmarks-description",ke="esri-bookmarks__adding-bookmark",me="esri-bookmarks__add-bookmark",ce="esri-bookmarks__add-bookmark-button",he="esri-bookmarks__add-bookmark-icon",be="esri-bookmarks__authoring-card",_e="esri-bookmarks__authoring-container",pe="esri-bookmarks__authoring-form",ge="esri-bookmarks__authoring-label",ve="esri-bookmarks__authoring-actions",Be="esri-bookmarks__authoring-input--invalid",we="esri-bookmarks__authoring-delete-button",fe="esri-bookmarks__authoring-cancel-button",Ee="esri-bookmarks__time-extent-container",ye="esri-bookmarks__time-extent",Ie="esri-bookmarks__time-extent-group",Se="esri-bookmarks__time-extent-date",Ce="esri-bookmarks__time-extent-time",xe="esri-widget",Ae="esri-widget--disabled",Te="esri-button",Ue="esri-button--tertiary",Me="esri-input",Ne="esri-icon-handle-vertical",Oe="esri-icon-plus",Re="esri-icon-edit",Ze="esri-icon-handle-horizontal",He="esri-icon-refresh",De="esri-icon-link",Pe="esri-icon-erase",Fe="esri-icon-bookmark",Le="esri-widget__heading",Ve="esri-icon-loading-indicator",qe="esri-rotating",je={addBookmark:!0,thumbnail:!0,time:!0},ze=/^https:\/\/.*/i;let Ke=class extends b.Z{constructor(e,t){super(e,t),this._handles=new r.Z,this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._addBookmarkButtonNode=null,this._focusAddBookmarkButton=!1,this._focusEditInputBox=!1,this._focusAddInputBox=!1,this._focusUrlEditInputBox=!1,this._sortable=null,this._sortableNode=null,this._focusSortUid=null,this._selectedSortUid=null,this._sortableSavedItems=null,this._editIncludeTimeExtent=null,this._userState=null,this.defaultCreateOptions=null,this.defaultEditOptions=null,this.bookmarks=null,this.disabled=!1,this.editingEnabled=!1,this.headingLevel=2,this.goToOverride=null,this.iconClass=Fe,this.label=void 0,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.view=null,this.viewModel=new N,this.visibleElements={...je}}initialize(){this.own([(0,d.YP)((()=>this.viewModel?.bookmarks),(()=>this._bookmarksInitialized()),d.nn),(0,d.YP)((()=>this.editingEnabled),(()=>this._toggleSorting()),d.nn)])}destroy(){this._destroySortable(),this._handles.destroy(),this._handles=null,this._editMenu.destroy()}loadDependencies(){return Promise.all([Promise.resolve().then(o.bind(o,5176)),Promise.resolve().then(o.bind(o,59997))])}get _editMenuItems(){const{messages:e,_userState:t}=this,o=t?.editedBookmark?.thumbnail?.url;return[new R.Z({label:e?.menu.refreshThumbnail,iconClass:He,clickFunction:()=>this._refreshThumbnail()}),new R.Z({label:ze.test(o)?e?.menu.editImageUrl:e?.menu.useImageUrl,iconClass:De,clickFunction:()=>this._startUseImageUrl()}),o?new R.Z({label:e?.menu.removeThumbnail,iconClass:Pe,clickFunction:()=>this._removeThumbnail()}):null].filter(Boolean)}get _editMenu(){const{_editMenuItems:e,messages:t,disabled:o}=this,i=this._get("_editMenu");i&&i.destroy();const s=new O.Z({disabled:o,iconClass:Ze,label:t?.menu.label});return s.items=e,s}castVisibleElements(e){return{...je,...e}}endAddBookmark(){this._userState=null}goTo(e){return this.viewModel.goTo(e)}render(){const{state:e}=this.viewModel,t="loading"===e?this.renderLoading():this.renderBookmarks();return(0,F.u)("div",{class:this.classes(q,xe,{[Ae]:this.disabled})},t)}startAddBookmark(){this._userState=new g({state:"add"}),this._focusAddInputBox=!0,this.scheduleRender()}renderLoading(){return(0,F.u)("div",{class:j,key:"loader",tabIndex:this.disabled?-1:null},(0,F.u)("div",{class:z}))}renderNoBookmarksContainer(){const{messages:e,disabled:t}=this;return(0,F.u)("div",{class:ne,key:"no-bookmarks",tabIndex:t?-1:null},(0,F.u)("span",{"aria-hidden":"true",class:this.classes(le,Fe)}),(0,F.u)(Z.X6,{level:this.headingLevel,class:this.classes(Le,de)},e?.noBookmarksHeading),(0,F.u)("p",{class:ue},e?.noBookmarksDescription))}renderAddBookmarkLoading(){return(0,F.u)("div",{key:"adding-bookmark",class:ke},(0,F.u)("span",{"aria-hidden":"true",class:this.classes(Ve,qe)}),this.messages?.addingBookmark)}renderBookmarkItems(e){if(!e)return null;const{_userState:t,editingEnabled:o}=this;return e.map((e=>o&&e&&t&&("edit"===t.state||"edit-thumbnail"===t.state)&&t.bookmark===e?"edit-thumbnail"===t.state?this.renderEditingBookmarkUrl(t.editedBookmark):this.renderEditingBookmark(t.editedBookmark):this.renderBookmark(e))).toArray()}renderBookmarksContainer(e){const{_userState:t,editingEnabled:o,disabled:i}=this,s="add"===t?.state,a=o&&!s?this.renderAddBookmarkButton():null,r=o?s&&t.loading?this.renderAddBookmarkLoading():"add"===t?.state?this.renderAddingBookmark():null:null;return[(0,F.u)("ul",{key:"bookmark-list","aria-label":this.messages?.widgetLabel,class:this.classes(K,{[Y]:this.editingEnabled}),afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"data-node-ref":"_sortableNode",bind:this,tabIndex:i?-1:null},this.renderBookmarkItems(e)),a,r]}renderAddBookmarkButton(){return this.visibleElements.addBookmark?(0,F.u)("div",{key:"add-bookmark-item",class:me},(0,F.u)("button",{class:this.classes(Te,Ue,ce),disabled:this.disabled,onclick:this.startAddBookmark,afterCreate:this._storeAddBookmarkButton,afterUpdate:this._storeAddBookmarkButton,"data-node-ref":"_addBookmarkButtonNode",bind:this,type:"button"},(0,F.u)("span",{"aria-hidden":"true",class:this.classes(he,Oe)}),this.messages?.addBookmark)):null}renderBookmarks(){const{bookmarks:e}=this.viewModel,t=e&&e.filter(Boolean),o=t&&t.length,i=o||this.editingEnabled?this.renderBookmarksContainer(t):null;return[o?null:this.renderNoBookmarksContainer(),i]}renderEditContainer(e){const{messagesCommon:t,disabled:o}=this;return(0,F.u)("div",{class:X,key:"edit-container"},(0,F.u)("button",{disabled:o,title:t?.edit,"aria-label":t?.edit,"data-bookmark":e,onclick:this._showEditBookmarkForm,bind:this,class:J,type:"button"},(0,F.u)("span",{"aria-hidden":"true",class:Re})))}renderDragHandle(e){const{messagesCommon:t,disabled:o}=this,i={[V]:e.uid};return(0,F.u)("div",{role:"button",tabIndex:o?-1:0,key:"drag-handle",bind:this,class:Q,onkeydown:this._dragHandleKeydown,afterCreate:this._focusDragHandle,afterUpdate:this._focusDragHandle,onblur:this._dragHandleBlur,"aria-pressed":this._selectedSortUid===e.uid?"true":"false","aria-label":t?.dragHandleLabel,title:t?.dragHandleTitle,...i},(0,F.u)("span",{"aria-hidden":"true",class:this.classes(ee,Ne)}))}renderBookmarkImageIcon(){return(0,F.u)("span",{"aria-hidden":"true",class:this.classes(te,Fe)})}renderBookmarkImage(e){const{visibleElements:t}=this,{thumbnail:o}=e,i=o&&o.url||"";return t.thumbnail&&i?(0,F.u)("img",{src:i,alt:"",class:oe}):null}renderBookmarkTimeSwitch(e){const{messages:t,disabled:o}=this,{timeExtent:i}=e,{view:s}=this.viewModel;return s.timeExtent||i?(0,F.u)("calcite-label",{layout:"inline-space-between","disable-spacing":"true"},t.includeTimeExtent,(0,F.u)("calcite-switch",{scale:"s",disabled:o,checked:!!i,onCalciteSwitchChange:e=>this._editIncludeTimeExtent=!!e.detail.switched})):null}renderBookmarkTimeExtent(e){const{visibleElements:t}=this,{timeExtent:o}=e;return o?(0,F.u)("span",{class:ye},[(0,n.pC)(o.start)&&(0,F.u)("span",{key:"start-date-group",class:Ie},(0,F.u)("span",{key:"start-date",class:Se},this._formatDate(o.start)),t.time&&(0,F.u)("span",{key:"start-time",class:Ce},this._formatTime(o.start))),(0,n.pC)(o.end)&&((0,n.Wi)(o.start)||o.start.getTime()!==o.end.getTime())&&(0,F.u)("span",{key:"end-date-group",class:Ie},(0,F.u)("span",{key:"end-date",class:Se},this._formatDate(o.end)),t.time&&(0,F.u)("span",{key:"end-time",class:Ce},this._formatTime(o.end)))]):null}renderBookmarkButton(e){const{messagesCommon:t,disabled:o}=this,{name:i,timeExtent:s}=e,{abilities:a}=this.viewModel,r=i||t?.untitled,n=(0,F.u)("div",{class:W},this.renderBookmarkImage(e)||this.renderBookmarkImageIcon()),d=a.time&&s?(0,F.u)("span",{key:"time-extent",class:ae},this.renderBookmarkTimeExtent(e)):null;return(0,F.u)("button",{disabled:o,key:"bookmark-button",class:$,bind:this,"data-bookmark":e,onclick:this._goToBookmark,type:"button"},n,(0,F.u)("div",{class:ie},(0,F.u)("span",{key:"bookmark-title",class:se},r),d))}renderBookmark(e){const{activeBookmark:t}=this.viewModel,o={[re]:t===e},i=this.editingEnabled?this.renderEditContainer(e):null,s={[V]:e.uid},a=this.editingEnabled?this.renderDragHandle(e):null;return(0,F.u)("li",{key:e,class:this.classes(G,o),...s},a,this.renderBookmarkButton(e),i)}renderEditingBookmarkName(e){const{messages:t,_userState:o,disabled:i}=this,s="name-required"===o.validationState;return(0,F.u)("label",{class:ge},t?.title,s?(0,F.u)("strong",null,t?.invalidTitle):null,(0,F.u)("input",{required:!0,disabled:i,bind:this,class:this.classes(Me,s?Be:null),type:"text",value:e.name,afterCreate:this._storeEditInput,afterUpdate:this._focusEditInput,"data-bookmark":e,"data-node-ref":"_editInputNode",placeholder:t?.titlePlaceholder}))}renderEditingBookmarkUrlActions(){const{messagesCommon:e,disabled:t}=this;return(0,F.u)("div",{class:ve},(0,F.u)("input",{type:"button",disabled:t,value:e?.back,class:this.classes(Te,Ue),onclick:this._closeUrlEditBookmarkForm,bind:this}),(0,F.u)("input",{class:Te,disabled:t,type:"submit",value:e?.add}))}renderEditingBookmarkActions(){const{messagesCommon:e,disabled:t}=this,{bookmark:o}=this._userState;return(0,F.u)("div",{class:ve},(0,F.u)("input",{type:"button",disabled:t,value:e?.delete,class:this.classes(Te,Ue,we),"data-bookmark":o,onclick:this._deleteBookmark,bind:this}),(0,F.u)("input",{disabled:t,type:"button",value:e?.cancel,class:this.classes(Te,Ue),onclick:this._closeEditBookmarkForm,bind:this}),(0,F.u)("input",{class:Te,disabled:t,type:"submit",value:e?.save}))}renderEditingBookmarkUrlInput(e){const{messages:t,_userState:o,disabled:i}=this,s=e.thumbnail?.url,a=ze.test(s)?s:null,r="absolute-url-required"===o.validationState;return(0,F.u)("label",{class:ge},r?(0,F.u)("strong",null,t?.invalidImageUrl):null,(0,F.u)("input",{required:!0,disabled:i,bind:this,class:this.classes(Me,r?Be:null),type:"text",value:a,afterCreate:this._storeUrlEditInput,afterUpdate:this._focusUrlEditInput,"data-bookmark":e,"data-node-ref":"_urlEditInputNode",title:t?.imageUrlTooltip,placeholder:t&&`https://<${t.imageUrlPlaceholder}>`}))}renderEditingBookmarkUrl(e){const t={[V]:e.uid};return(0,F.u)("li",{key:"edit-bookmark-url-form",class:be,...t},(0,F.u)("form",{class:pe,disabled:this.disabled,onsubmit:this._editBookmarkUrlSubmit,bind:this},this.renderEditingBookmarkUrlInput(e),this.renderEditingBookmarkUrlActions()))}renderEditingBookmark(e){const t={[V]:e.uid},{abilities:o}=this.viewModel,i=o.time?(0,F.u)("div",{key:"edit-bookmark-time-container",class:Ee},this.renderBookmarkTimeSwitch(e),this._editIncludeTimeExtent&&this.renderBookmarkTimeExtent(e)):null;return(0,F.u)("li",{key:"edit-bookmark-form",class:be,...t},(0,F.u)("form",{class:pe,disabled:this.disabled,onsubmit:this._editBookmarkSubmit,bind:this},(0,F.u)("div",{class:_e},(0,F.u)("div",{class:W},this.renderBookmarkImage(e),this._editMenu.render()),this.renderEditingBookmarkName(e)),i,this.renderEditingBookmarkActions()))}renderAddingBookmarkName(){const{_userState:e,messages:t,disabled:o}=this,i="name-required"===e.validationState;return(0,F.u)("label",{class:ge},t?.title,i?(0,F.u)("strong",null,t?.invalidTitle):null,(0,F.u)("input",{required:!0,disabled:o,bind:this,class:this.classes(Me,i?Be:null),type:"text",afterCreate:this._storeAddInput,afterUpdate:this._focusAddInput,"data-node-ref":"_addInputNode",value:"",placeholder:t?.titlePlaceholder}))}renderAddingBookmarkActions(){const{messagesCommon:e,disabled:t}=this;return(0,F.u)("div",{class:this.classes(ve)},(0,F.u)("input",{type:"button",disabled:t,value:e?.cancel,class:this.classes(Te,Ue,fe),onclick:this._endAddBookmark.bind(this),bind:this}),(0,F.u)("input",{class:Te,disabled:t,type:"submit",value:e?.add}))}renderAddingBookmark(){return(0,F.u)("div",{key:"add-bookmark-form",class:be},(0,F.u)("form",{class:pe,onsubmit:this._addBookmarkSubmit,bind:this},this.renderAddingBookmarkName(),this.renderAddingBookmarkActions()))}_formatDate(e){return e?(0,c.p6)(e,(0,c.Ze)("short-date")):null}_formatTime(e){return e?(0,c.p6)(e,(0,c.Ze)("long-time")):null}_dragHandleBlur(){this._selectedSortUid=null,this.scheduleRender()}_dragHandleKeydown(e){const{_sortableSavedItems:t}=this,o=(0,a.kK)(e);if(!["ArrowDown","ArrowUp","Escape","Tab"," ","Enter"].includes(o))return;const{_sortable:i,_selectedSortUid:s}=this,r=i.toArray(),n=e.target.getAttribute(V),d=r.indexOf(n);if((0,H.pf)(o)){const e=s&&s===n;return this._selectedSortUid=e?null:n,this._sortableSavedItems=e?null:this._sortable.toArray(),void this.scheduleRender()}if("Tab"===o)return this._selectedSortUid=null,void this.scheduleRender();if("Escape"===o&&t)return e.stopPropagation(),this._selectedSortUid=null,this._updateSortItems(t,i,n),void this.scheduleRender();if(-1===d||!s)return;const l="ArrowUp"===o?d-1:d+1;l>=r.length||l<=-1||(function(e,t,o){e.splice(o,0,e.splice(t,1)[0])}(r,d,l),this._updateSortItems(r,i,n))}_updateSortItems(e,t,o){t.sort(e),this._sortBookmarks(t),this._focusSortUid=o,this._selectedSortUid=o}_focusDragHandle(e){const{_focusSortUid:t}=this;e&&t&&e.getAttribute(V)===t&&(e.focus(),this._focusSortUid=null)}_toggleSorting(){const{_sortable:e,_sortableNode:t,editingEnabled:o,disabled:i}=this;if(t)if(e)e.option("disabled",i||!o);else{const e=L.ZP.create(t,{dataIdAttr:V,handle:`.${Q}`,group:"bookmarks",disabled:i||!o,onSort:()=>this._sortBookmarks(e)});this._sortable=e}}_sortNodeCreated(e){this._sortableNode=e,this._toggleSorting()}_sortBookmarks(e){const{bookmarks:t}=this.viewModel;if(!t)return;const o=e.toArray();t.sort(((e,t)=>{const i=o.indexOf(e.uid),s=o.indexOf(t.uid);return i>s?1:i<s?-1:0}))}_destroySortable(){const{_sortable:e}=this;e&&e.destroy(),this._sortable=null}_endAddBookmark(){this._focusAddBookmarkButton=!0,this.endAddBookmark()}_bookmarksInitialized(){const e="bookmarks-init",{_handles:t}=this;t.remove(e),t.add((0,d.on)((()=>this.viewModel?.bookmarks),"change",(()=>this._bookmarksChanged())),e)}_bookmarksChanged(){const e="bookmarks-change",{bookmarks:t}=this.viewModel,{_handles:o}=this;o.remove(e);const i=t.map((e=>(0,d.YP)((()=>[e?.name,e?.thumbnail?.url]),(()=>this.scheduleRender()))));o.add(i,e),this.scheduleRender()}_showEditBookmarkForm(e){const t=e.currentTarget["data-bookmark"];this._editIncludeTimeExtent=!!t.timeExtent,this._focusEditInputBox=!0,this._userState=new g({bookmark:t,state:"edit"}),this.viewModel.goTo(t),this.scheduleRender()}_closeUrlEditBookmarkForm(){this._focusEditInputBox=!0,this._userState.state="edit"}_closeEditBookmarkForm(){this._userState=null}_addBookmarkSubmit(e){e.preventDefault();const{_addInputNode:t,_userState:o}=this,i=t&&t.value.trim();i?(o.loading=!0,this.viewModel.createBookmark().then((e=>{e.name=i,this.viewModel.bookmarks.add(e),this._endAddBookmark()}))):o.validationState="name-required"}async _editBookmarkAndClose(e,t){const{viewModel:o}=this;await o.editBookmark(e,{...o.defaultEditOptions,...t}),this._closeEditBookmarkForm()}_editBookmarkSubmit(e){e.preventDefault();const{_editInputNode:t,_userState:o,_editIncludeTimeExtent:i}=this,s=t&&t.value.trim();s?(o.bookmark.name=s,o.bookmark.thumbnail=o.editedBookmark.thumbnail,i||(o.bookmark.timeExtent=null),this._editBookmarkAndClose(o.bookmark,{takeScreenshot:!1,captureTimeExtent:i})):o.validationState="name-required"}_storeAddBookmarkButton(e){this._addBookmarkButtonNode=e,this._focusAddBookmark()}_storeEditInput(e){this._editInputNode=e,this._focusEditInput()}_storeAddInput(e){this._addInputNode=e,this._focusAddInput()}_storeUrlEditInput(e){this._urlEditInputNode=e,this._focusUrlEditInput()}_focusUrlEditInput(){this._urlEditInputNode&&this._focusUrlEditInputBox&&(this._focusUrlEditInputBox=!1,this._urlEditInputNode.focus())}_focusAddInput(){this._addInputNode&&this._focusAddInputBox&&(this._focusAddInputBox=!1,this._addInputNode.focus())}_focusAddBookmark(){this._addBookmarkButtonNode&&this._focusAddBookmarkButton&&(this._focusAddBookmarkButton=!1,this._addBookmarkButtonNode.focus())}_focusEditInput(){this._editInputNode&&this._focusEditInputBox&&(this._focusEditInputBox=!1,this._editInputNode.focus())}_deleteBookmark(e){const t=e.currentTarget["data-bookmark"];this.viewModel.bookmarks.remove(t)}_goToBookmark(e){const t=e.currentTarget["data-bookmark"];this.endAddBookmark(),this._closeEditBookmarkForm(),this.viewModel.goTo(t)}async _refreshThumbnail(){const{_userState:e,_editMenu:t,viewModel:o}=this;e.validationState=void 0,await o.editBookmark(this._userState.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}),t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_removeThumbnail(){const{_userState:e,_editMenu:t}=this;e.editedBookmark.thumbnail=null,e.validationState=void 0,t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_startUseImageUrl(){this._userState.state="edit-thumbnail",this._editMenu.open=!1,this._focusUrlEditInputBox=!0,this.scheduleRender()}_editBookmarkUrlSubmit(e){e.preventDefault();const{_urlEditInputNode:t,_userState:o}=this,i=t.value;ze.test(i)?(i&&(o.editedBookmark.thumbnail=new h.A({url:i})),this._closeUrlEditBookmarkForm()):o.validationState="absolute-url-required"}};(0,s._)([(0,k.Cb)()],Ke.prototype,"_editIncludeTimeExtent",void 0),(0,s._)([(0,k.Cb)({type:g})],Ke.prototype,"_userState",void 0),(0,s._)([(0,k.Cb)({readOnly:!0})],Ke.prototype,"_editMenuItems",null),(0,s._)([(0,k.Cb)({readOnly:!0})],Ke.prototype,"_editMenu",null),(0,s._)([(0,l.B)("viewModel.defaultCreateOptions")],Ke.prototype,"defaultCreateOptions",void 0),(0,s._)([(0,l.B)("viewModel.defaultEditOptions")],Ke.prototype,"defaultEditOptions",void 0),(0,s._)([(0,l.B)("viewModel.bookmarks")],Ke.prototype,"bookmarks",void 0),(0,s._)([(0,k.Cb)()],Ke.prototype,"disabled",void 0),(0,s._)([(0,k.Cb)()],Ke.prototype,"editingEnabled",void 0),(0,s._)([(0,k.Cb)()],Ke.prototype,"headingLevel",void 0),(0,s._)([(0,l.B)("viewModel.goToOverride")],Ke.prototype,"goToOverride",void 0),(0,s._)([(0,k.Cb)()],Ke.prototype,"iconClass",void 0),(0,s._)([(0,k.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Ke.prototype,"label",void 0),(0,s._)([(0,k.Cb)(),(0,D.H)("esri/widgets/Bookmarks/t9n/Bookmarks")],Ke.prototype,"messages",void 0),(0,s._)([(0,k.Cb)(),(0,D.H)("esri/t9n/common")],Ke.prototype,"messagesCommon",void 0),(0,s._)([(0,k.Cb)(),(0,D.H)("esri/core/t9n/Units")],Ke.prototype,"messagesUnits",void 0),(0,s._)([(0,k.Cb)()],Ke.prototype,"uiStrings",void 0),(0,s._)([(0,l.B)("viewModel.view")],Ke.prototype,"view",void 0),(0,s._)([(0,k.Cb)({type:N}),(0,P.s)(["select-bookmark","bookmark-edit","bookmark-select"])],Ke.prototype,"viewModel",void 0),(0,s._)([(0,k.Cb)()],Ke.prototype,"visibleElements",void 0),(0,s._)([(0,u.p)("visibleElements")],Ke.prototype,"castVisibleElements",null),(0,s._)([(0,k.Cb)()],Ke.prototype,"endAddBookmark",null),(0,s._)([(0,k.Cb)()],Ke.prototype,"startAddBookmark",null),Ke=(0,s._)([(0,m.j)("esri.widgets.Bookmarks")],Ke);const Ye=Ke;var Ge=o(80184);const $e=e=>{const t=(0,i.useRef)(),o=(0,i.useRef)(!1),[s,a]=(0,i.useState)();return(0,i.useEffect)((()=>{var i,r;return o.current||(o.current=!0,a((i=t.current,r=e.view,new Ye({view:r,container:i,editingEnabled:!0})))),()=>{s&&s.destroy()}}),[]),(0,Ge.jsx)("div",{ref:t})},We=$e}}]);
//# sourceMappingURL=8340.68306b32.chunk.js.map