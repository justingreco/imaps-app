"use strict";(globalThis.webpackChunkimaps_app=globalThis.webpackChunkimaps_app||[]).push([[8458],{17481:(e,t,o)=>{o.r(t),o.d(t,{Bookmarks:()=>Ye,default:()=>We});var i=o(72791),s=o(85580),a=o(9283);const r={title:"Bookmarks Tips",tips:[{title:"Saving Bookmarks",text:"Bookmarks are automatically saved to your local storage in your browser.  Next time you open iMAPS in the same browser you will see the bookmarks from your last session."}]};var n=o(27366),d=o(98928),l=o(100),u=o(92026),k=o(94172),m=o(49861),c=(o(63780),o(89125)),h=o(69912),b=o(76969),_=o(26838),p=o(69407),g=o(85015);o(25243);let v=class extends g.Z{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}};(0,n._)([(0,m.Cb)()],v.prototype,"bookmark",void 0),(0,n._)([(0,m.Cb)({readOnly:!0})],v.prototype,"editedBookmark",null),(0,n._)([(0,m.Cb)()],v.prototype,"state",null),(0,n._)([(0,m.Cb)()],v.prototype,"validationState",void 0),(0,n._)([(0,m.Cb)()],v.prototype,"loading",void 0),v=(0,n._)([(0,h.j)("esri.widgets.Bookmarks.UserState")],v);const B=v;var f=o(13894),w=o(40281),E=o(10064),y=o(91505),C=o(2284),S=o(99505);const I=w.Z.ofType(C.Z),x={width:128,height:128,format:"png"},A={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},T={time:!0};let U=class extends((0,S._)(y.Z.EventedAccessor)){constructor(e){super(e),this.abilities={...T},this.activeBookmark=null,this.view=null}destroy(){this.view=null,this._set("activeBookmark",null)}castAbilities(e){return{...T,...e}}get bookmarks(){return this.view?.map?.bookmarks??new I}set bookmarks(e){this._overrideIfSome("bookmarks",e)}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...A,...e})}get defaultCreateOptions(){return A}set defaultEditOptions(e){this._set("defaultEditOptions",{...A,...e})}get defaultEditOptions(){return A}get state(){const e=this.get("view");return e&&!e.ready?"loading":"ready"}async createBookmark(e){const{view:t,defaultCreateOptions:o,abilities:i}=this;if(!t)throw new E.Z("create-bookmark:invalid-view","Cannot create a bookmark without a view.");const{takeScreenshot:s,screenshotSettings:a,captureViewpoint:r,captureRotation:n,captureScale:d,captureTimeExtent:l}={...o,...e},k=s?await this._createThumbnail(a):void 0,m=i.time&&l&&(0,u.pC)(t.timeExtent)?t.timeExtent.clone():void 0;return new C.Z({...k&&{thumbnail:k},...l&&{timeExtent:m},...r&&{viewpoint:this._createViewpoint({view:t,captureScale:d,captureRotation:n})}})}async editBookmark(e,t){const{view:o,defaultEditOptions:i}=this;if(!o)throw new E.Z("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");const{takeScreenshot:s,screenshotSettings:a,captureViewpoint:r,captureRotation:n,captureScale:d,captureTimeExtent:l}={...i,...t},k=s?await this._createThumbnail(a):void 0;return k&&(e.thumbnail=k),r&&(e.viewpoint=this._createViewpoint({view:o,captureScale:d,captureRotation:n})),l&&(0,u.pC)(o.timeExtent)&&(e.timeExtent=o.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:e}),e}goTo(e){const{abilities:t,view:o}=this;if(!o)throw new E.Z("go-to:invalid-view","Cannot go to a bookmark without a view");const i=e?.viewpoint;if(!i)throw new E.Z("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:e});this._set("activeBookmark",e);const s={target:i},a=this.callGoTo(s),r=e?.timeExtent;return t.time&&r&&(o.timeExtent=r),this.emit("bookmark-select",{bookmark:e}),a.catch((()=>{})).then((()=>this._set("activeBookmark",null))),a}async _createThumbnail(e){const t=await this.view.takeScreenshot({...x,...e});return new _.A({url:t.dataUrl})}_createViewpoint(e){let{view:t,captureRotation:o,captureScale:i}=e;const s=t.viewpoint?.clone();return new f.Z({targetGeometry:t.extent?.clone(),rotation:o&&s?.rotation||0,scale:i&&s?.scale||0})}};(0,n._)([(0,m.Cb)()],U.prototype,"abilities",void 0),(0,n._)([(0,c.p)("abilities")],U.prototype,"castAbilities",null),(0,n._)([(0,m.Cb)({readOnly:!0})],U.prototype,"activeBookmark",void 0),(0,n._)([(0,m.Cb)({type:I})],U.prototype,"bookmarks",null),(0,n._)([(0,m.Cb)()],U.prototype,"defaultCreateOptions",null),(0,n._)([(0,m.Cb)()],U.prototype,"defaultEditOptions",null),(0,n._)([(0,m.Cb)({readOnly:!0})],U.prototype,"state",null),(0,n._)([(0,m.Cb)()],U.prototype,"view",void 0),U=(0,n._)([(0,h.j)("esri.widgets.Bookmarks.BookmarksViewModel")],U);const M=U;var N=o(70098),O=o(61524),R=o(96919),Z=o(80975),D=o(80532),H=o(28907),$=o(67005),F=o(70281);const P="data-bookmark-uid",V="esri-bookmarks esri-widget--panel",j="esri-bookmarks__loader-container",q="esri-bookmarks__loader",L="esri-bookmarks__list",z="esri-bookmarks__list--sortable",G="esri-bookmarks__bookmark",K="esri-bookmarks__bookmark-button",Y="esri-bookmarks__bookmark-image-container",W="esri-bookmarks__bookmark-edit-button-container",X="esri-bookmarks__bookmark-edit-button",J="esri-bookmarks_bookmark-drag-handle",Q="esri-bookmarks_bookmark-drag-handle-icon",ee="esri-bookmarks__bookmark-icon",te="esri-bookmarks__image",oe="esri-bookmarks__bookmark-label",ie="esri-bookmarks__bookmark-name",se="esri-bookmarks__bookmark-time-extent",ae="esri-bookmarks__bookmark--active",re="esri-widget__content--empty",ne="esri-bookmarks__no-bookmarks-heading",de="esri-widget__no-bookmark-icon",le="esri-bookmarks__no-bookmarks-description",ue="esri-bookmarks__adding-bookmark",ke="esri-bookmarks__add-bookmark",me="esri-bookmarks__add-bookmark-button",ce="esri-bookmarks__add-bookmark-icon",he="esri-bookmarks__authoring-card",be="esri-bookmarks__authoring-container",_e="esri-bookmarks__authoring-form",pe="esri-bookmarks__authoring-label",ge="esri-bookmarks__authoring-actions",ve="esri-bookmarks__authoring-input--invalid",Be="esri-bookmarks__authoring-delete-button",fe="esri-bookmarks__authoring-cancel-button",we="esri-bookmarks__time-extent-container",Ee="esri-bookmarks__time-extent",ye="esri-bookmarks__time-extent-group",Ce="esri-bookmarks__time-extent-date",Se="esri-bookmarks__time-extent-time",Ie="esri-widget",xe="esri-widget--disabled",Ae="esri-button",Te="esri-button--tertiary",Ue="esri-input",Me="esri-icon-handle-vertical",Ne="esri-icon-plus",Oe="esri-icon-edit",Re="esri-icon-handle-horizontal",Ze="esri-icon-refresh",De="esri-icon-link",He="esri-icon-erase",$e="esri-icon-bookmark",Fe="esri-widget__heading",Pe="esri-icon-loading-indicator",Ve="esri-rotating",je={addBookmark:!0,thumbnail:!0,time:!0},qe=/^https:\/\/.*/i;let Le=class extends p.Z{constructor(e,t){super(e,t),this._handles=new l.Z,this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._addBookmarkButtonNode=null,this._focusAddBookmarkButton=!1,this._focusEditInputBox=!1,this._focusAddInputBox=!1,this._focusUrlEditInputBox=!1,this._sortable=null,this._sortableNode=null,this._focusSortUid=null,this._selectedSortUid=null,this._sortableSavedItems=null,this._editIncludeTimeExtent=null,this._userState=null,this.disabled=!1,this.editingEnabled=!1,this.headingLevel=2,this.iconClass=$e,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.viewModel=new M,this.visibleElements={...je}}initialize(){this.addHandles([(0,k.YP)((()=>this.viewModel?.bookmarks),(()=>this._bookmarksInitialized()),k.nn),(0,k.YP)((()=>this.editingEnabled),(()=>this._toggleSorting()),k.nn)])}destroy(){this._destroySortable(),this._handles.destroy(),this._handles=null,this._editMenu.destroy()}loadDependencies(){return Promise.all([Promise.resolve().then(o.bind(o,67777)),Promise.resolve().then(o.bind(o,39754))])}get _editMenuItems(){const{messages:e,_userState:t}=this,o=t?.editedBookmark?.thumbnail?.url;return[new O.Z({label:e?.menu.refreshThumbnail,iconClass:Ze,clickFunction:()=>this._refreshThumbnail()}),new O.Z({label:qe.test(o)?e?.menu.editImageUrl:e?.menu.useImageUrl,iconClass:De,clickFunction:()=>this._startUseImageUrl()}),o?new O.Z({label:e?.menu.removeThumbnail,iconClass:He,clickFunction:()=>this._removeThumbnail()}):null].filter(Boolean)}get _editMenu(){const{_editMenuItems:e,messages:t,disabled:o}=this,i=this._get("_editMenu");i&&i.destroy();const s=new N.Z({disabled:o,iconClass:Re,label:t?.menu.label});return s.items=e,s}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(e){this.viewModel.defaultEditOptions=e}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(e){this.viewModel.bookmarks=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...je,...e}}endAddBookmark(){this._userState=null}goTo(e){return this.viewModel.goTo(e)}render(){const{state:e}=this.viewModel,t="loading"===e?this.renderLoading():this.renderBookmarks();return(0,$.u)("div",{class:this.classes(V,Ie,{[xe]:this.disabled})},t)}startAddBookmark(){this._userState=new B({state:"add"}),this._focusAddInputBox=!0,this.scheduleRender()}renderLoading(){return(0,$.u)("div",{class:j,key:"loader",tabIndex:this.disabled?-1:null},(0,$.u)("div",{class:q}))}renderNoBookmarksContainer(){const{messages:e,disabled:t}=this;return(0,$.u)("div",{class:re,key:"no-bookmarks",tabIndex:t?-1:null},(0,$.u)("span",{"aria-hidden":"true",class:this.classes(de,$e)}),(0,$.u)(R.X6,{level:this.headingLevel,class:this.classes(Fe,ne)},e?.noBookmarksHeading),(0,$.u)("p",{class:le},e?.noBookmarksDescription))}renderAddBookmarkLoading(){return(0,$.u)("div",{key:"adding-bookmark",class:ue},(0,$.u)("span",{"aria-hidden":"true",class:this.classes(Pe,Ve)}),this.messages?.addingBookmark)}renderBookmarkItems(e){if(!e)return null;const{_userState:t,editingEnabled:o}=this;return e.map((e=>o&&e&&t&&("edit"===t.state||"edit-thumbnail"===t.state)&&t.bookmark===e?"edit-thumbnail"===t.state?this.renderEditingBookmarkUrl(t.editedBookmark):this.renderEditingBookmark(t.editedBookmark):this.renderBookmark(e))).toArray()}renderBookmarksContainer(e){const{_userState:t,editingEnabled:o,disabled:i}=this,s="add"===t?.state,a=o&&!s?this.renderAddBookmarkButton():null,r=o?s&&t.loading?this.renderAddBookmarkLoading():"add"===t?.state?this.renderAddingBookmark():null:null;return[(0,$.u)("ul",{key:"bookmark-list","aria-label":this.messages?.widgetLabel,class:this.classes(L,{[z]:this.editingEnabled}),afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"data-node-ref":"_sortableNode",bind:this,tabIndex:i?-1:null},this.renderBookmarkItems(e)),a,r]}renderAddBookmarkButton(){return this.visibleElements.addBookmark?(0,$.u)("div",{key:"add-bookmark-item",class:ke},(0,$.u)("button",{class:this.classes(Ae,Te,me),disabled:this.disabled,onclick:this.startAddBookmark,afterCreate:this._storeAddBookmarkButton,afterUpdate:this._storeAddBookmarkButton,"data-node-ref":"_addBookmarkButtonNode",bind:this,type:"button"},(0,$.u)("span",{"aria-hidden":"true",class:this.classes(ce,Ne)}),this.messages?.addBookmark)):null}renderBookmarks(){const{bookmarks:e}=this.viewModel,t=e&&e.filter(Boolean),o=t&&t.length,i=o||this.editingEnabled?this.renderBookmarksContainer(t):null;return[o?null:this.renderNoBookmarksContainer(),i]}renderEditContainer(e){const{messagesCommon:t,disabled:o}=this,i=this._getBookmarkTitle(e);return(0,$.u)("div",{class:W,key:"edit-container"},(0,$.u)("button",{disabled:o,title:`${t?.edit} ${i}`,"aria-label":`${t?.edit} ${i}`,"data-bookmark":e,onclick:this._showEditBookmarkForm,bind:this,class:X,type:"button"},(0,$.u)("span",{"aria-hidden":"true",class:Oe})))}renderDragHandle(e){const{messagesCommon:t,disabled:o}=this,i=this._getBookmarkTitle(e),s={[P]:e.uid};return(0,$.u)("div",{role:"button",tabIndex:o?-1:0,key:"drag-handle",bind:this,class:J,onkeydown:this._dragHandleKeydown,afterCreate:this._focusDragHandle,afterUpdate:this._focusDragHandle,onblur:this._dragHandleBlur,"aria-pressed":this._selectedSortUid===e.uid?"true":"false","aria-label":`${t?.dragHandleTitle} ${i}`,title:`${t?.dragHandleTitle} ${i}`,...s},(0,$.u)("span",{"aria-hidden":"true",class:this.classes(Q,Me)}))}renderBookmarkImageIcon(){return(0,$.u)("span",{"aria-hidden":"true",class:this.classes(ee,$e)})}renderBookmarkImage(e){const{visibleElements:t}=this,{thumbnail:o}=e,i=o&&o.url||"";return t.thumbnail&&i?(0,$.u)("img",{src:i,alt:"",class:te}):null}renderBookmarkTimeSwitch(e){const{messages:t,disabled:o}=this,{timeExtent:i}=e,{view:s}=this.viewModel;return s.timeExtent||i?(0,$.u)("calcite-label",{layout:"inline-space-between","disable-spacing":"true"},t.includeTimeExtent,(0,$.u)("calcite-switch",{scale:"s",disabled:o,checked:!!i,onCalciteSwitchChange:e=>this._editIncludeTimeExtent=!!e.detail.switched})):null}renderBookmarkTimeExtent(e){const{visibleElements:t}=this,{timeExtent:o}=e;return o?(0,$.u)("span",{class:Ee},[(0,u.pC)(o.start)&&(0,$.u)("span",{key:"start-date-group",class:ye},(0,$.u)("span",{key:"start-date",class:Ce},this._formatDate(o.start)),t.time&&(0,$.u)("span",{key:"start-time",class:Se},this._formatTime(o.start))),(0,u.pC)(o.end)&&((0,u.Wi)(o.start)||o.start.getTime()!==o.end.getTime())&&(0,$.u)("span",{key:"end-date-group",class:ye},(0,$.u)("span",{key:"end-date",class:Ce},this._formatDate(o.end)),t.time&&(0,$.u)("span",{key:"end-time",class:Se},this._formatTime(o.end)))]):null}renderBookmarkButton(e){const{disabled:t}=this,{timeExtent:o}=e,{abilities:i}=this.viewModel,s=this._getBookmarkTitle(e),a=(0,$.u)("div",{class:Y},this.renderBookmarkImage(e)||this.renderBookmarkImageIcon()),r=i.time&&o?(0,$.u)("span",{key:"time-extent",class:se},this.renderBookmarkTimeExtent(e)):null;return(0,$.u)("button",{disabled:t,key:"bookmark-button",class:K,bind:this,"data-bookmark":e,onclick:this._goToBookmark,type:"button"},a,(0,$.u)("div",{class:oe},(0,$.u)("span",{key:"bookmark-title",class:ie},s),r))}renderBookmark(e){const{activeBookmark:t}=this.viewModel,o={[ae]:t===e},i=this.editingEnabled?this.renderEditContainer(e):null,s={[P]:e.uid},a=this.editingEnabled?this.renderDragHandle(e):null;return(0,$.u)("li",{key:e,class:this.classes(G,o),...s},a,this.renderBookmarkButton(e),i)}renderEditingBookmarkName(e){const{messages:t,_userState:o,disabled:i}=this,s="name-required"===o.validationState;return(0,$.u)("label",{class:pe},t?.title,s?(0,$.u)("strong",null,t?.invalidTitle):null,(0,$.u)("input",{required:!0,disabled:i,bind:this,class:this.classes(Ue,s?ve:null),type:"text",value:e.name,afterCreate:this._storeEditInput,afterUpdate:this._focusEditInput,"data-bookmark":e,"data-node-ref":"_editInputNode",placeholder:t?.titlePlaceholder}))}renderEditingBookmarkUrlActions(){const{messagesCommon:e,disabled:t}=this;return(0,$.u)("div",{class:ge},(0,$.u)("input",{type:"button",disabled:t,value:e?.back,class:this.classes(Ae,Te),onclick:this._closeUrlEditBookmarkForm,bind:this}),(0,$.u)("input",{class:Ae,disabled:t,type:"submit",value:e?.add}))}renderEditingBookmarkActions(){const{messagesCommon:e,disabled:t}=this,{bookmark:o}=this._userState;return(0,$.u)("div",{class:ge},(0,$.u)("input",{type:"button",disabled:t,value:e?.delete,class:this.classes(Ae,Te,Be),"data-bookmark":o,onclick:this._deleteBookmark,bind:this}),(0,$.u)("input",{disabled:t,type:"button",value:e?.cancel,class:this.classes(Ae,Te),onclick:this._closeEditBookmarkForm,bind:this}),(0,$.u)("input",{class:Ae,disabled:t,type:"submit",value:e?.save}))}renderEditingBookmarkUrlInput(e){const{messages:t,_userState:o,disabled:i}=this,s=e.thumbnail?.url,a=qe.test(s)?s:null,r="absolute-url-required"===o.validationState;return(0,$.u)("label",{class:pe},r?(0,$.u)("strong",null,t?.invalidImageUrl):null,(0,$.u)("input",{required:!0,disabled:i,bind:this,class:this.classes(Ue,r?ve:null),type:"text",value:a,afterCreate:this._storeUrlEditInput,afterUpdate:this._focusUrlEditInput,"data-bookmark":e,"data-node-ref":"_urlEditInputNode",title:t?.imageUrlTooltip,placeholder:t&&`https://<${t.imageUrlPlaceholder}>`}))}renderEditingBookmarkUrl(e){const t={[P]:e.uid};return(0,$.u)("li",{key:"edit-bookmark-url-form",class:he,...t},(0,$.u)("form",{class:_e,disabled:this.disabled,onsubmit:this._editBookmarkUrlSubmit,bind:this},this.renderEditingBookmarkUrlInput(e),this.renderEditingBookmarkUrlActions()))}renderEditingBookmark(e){const t={[P]:e.uid},{abilities:o}=this.viewModel,i=o.time?(0,$.u)("div",{key:"edit-bookmark-time-container",class:we},this.renderBookmarkTimeSwitch(e),this._editIncludeTimeExtent&&this.renderBookmarkTimeExtent(e)):null;return(0,$.u)("li",{key:"edit-bookmark-form",class:he,...t},(0,$.u)("form",{class:_e,disabled:this.disabled,onsubmit:this._editBookmarkSubmit,bind:this},(0,$.u)("div",{class:be},(0,$.u)("div",{class:Y},this.renderBookmarkImage(e),this._editMenu.render()),this.renderEditingBookmarkName(e)),i,this.renderEditingBookmarkActions()))}renderAddingBookmarkName(){const{_userState:e,messages:t,disabled:o}=this,i="name-required"===e.validationState;return(0,$.u)("label",{class:pe},t?.title,i?(0,$.u)("strong",null,t?.invalidTitle):null,(0,$.u)("input",{required:!0,disabled:o,bind:this,class:this.classes(Ue,i?ve:null),type:"text",afterCreate:this._storeAddInput,afterUpdate:this._focusAddInput,"data-node-ref":"_addInputNode",value:"",placeholder:t?.titlePlaceholder}))}renderAddingBookmarkActions(){const{messagesCommon:e,disabled:t}=this;return(0,$.u)("div",{class:this.classes(ge)},(0,$.u)("input",{type:"button",disabled:t,value:e?.cancel,class:this.classes(Ae,Te,fe),onclick:this._endAddBookmark.bind(this),bind:this}),(0,$.u)("input",{class:Ae,disabled:t,type:"submit",value:e?.add}))}renderAddingBookmark(){return(0,$.u)("div",{key:"add-bookmark-form",class:he},(0,$.u)("form",{class:_e,onsubmit:this._addBookmarkSubmit,bind:this},this.renderAddingBookmarkName(),this.renderAddingBookmarkActions()))}_getBookmarkTitle(e){return e.name||this.messagesCommon?.untitled}_formatDate(e){return e?(0,b.p6)(e,(0,b.Ze)("short-date")):null}_formatTime(e){return e?(0,b.p6)(e,(0,b.Ze)("long-time")):null}_dragHandleBlur(){this._selectedSortUid=null,this.scheduleRender()}_dragHandleKeydown(e){const{_sortableSavedItems:t}=this,o=(0,d.kK)(e);if(!["ArrowDown","ArrowUp","Escape","Tab"," ","Enter"].includes(o))return;const{_sortable:i,_selectedSortUid:s}=this,a=i.toArray(),r=e.target.getAttribute(P),n=a.indexOf(r);if((0,Z.pf)(o)){const e=s&&s===r;return this._selectedSortUid=e?null:r,this._sortableSavedItems=e?null:this._sortable.toArray(),void this.scheduleRender()}if("Tab"===o)return this._selectedSortUid=null,void this.scheduleRender();if("Escape"===o&&t)return e.stopPropagation(),this._selectedSortUid=null,this._updateSortItems(t,i,r),void this.scheduleRender();if(-1===n||!s)return;const l="ArrowUp"===o?n-1:n+1;l>=a.length||l<=-1||(function(e,t,o){e.splice(o,0,e.splice(t,1)[0])}(a,n,l),this._updateSortItems(a,i,r))}_updateSortItems(e,t,o){t.sort(e),this._sortBookmarks(t),this._focusSortUid=o,this._selectedSortUid=o}_focusDragHandle(e){const{_focusSortUid:t}=this;e&&t&&e.getAttribute(P)===t&&(e.focus(),this._focusSortUid=null)}_toggleSorting(){const{_sortable:e,_sortableNode:t,editingEnabled:o,disabled:i}=this;if(t)if(e)e.option("disabled",i||!o);else{const e=F.ZP.create(t,{dataIdAttr:P,handle:`.${J}`,group:"bookmarks",disabled:i||!o,onSort:()=>this._sortBookmarks(e)});this._sortable=e}}_sortNodeCreated(e){this._sortableNode=e,this._toggleSorting()}_sortBookmarks(e){const{bookmarks:t}=this.viewModel;if(!t)return;const o=e.toArray();t.sort(((e,t)=>{const i=o.indexOf(e.uid),s=o.indexOf(t.uid);return i>s?1:i<s?-1:0}))}_destroySortable(){const{_sortable:e}=this;e&&e.destroy(),this._sortable=null}_endAddBookmark(){this._focusAddBookmarkButton=!0,this.endAddBookmark()}_bookmarksInitialized(){const e="bookmarks-init",{_handles:t}=this;t.remove(e),t.add((0,k.on)((()=>this.viewModel?.bookmarks),"change",(()=>this._bookmarksChanged())),e)}_bookmarksChanged(){const e="bookmarks-change",{bookmarks:t}=this.viewModel,{_handles:o}=this;o.remove(e);const i=t.map((e=>(0,k.YP)((()=>[e?.name,e?.thumbnail?.url]),(()=>this.scheduleRender()))));o.add(i,e),this.scheduleRender()}_showEditBookmarkForm(e){const t=e.currentTarget["data-bookmark"];this._editIncludeTimeExtent=!!t.timeExtent,this._focusEditInputBox=!0,this._userState=new B({bookmark:t,state:"edit"}),this.viewModel.goTo(t),this.scheduleRender()}_closeUrlEditBookmarkForm(){this._focusEditInputBox=!0,this._userState.state="edit"}_closeEditBookmarkForm(){this._userState=null}_addBookmarkSubmit(e){e.preventDefault();const{_addInputNode:t,_userState:o}=this,i=t&&t.value.trim();i?(o.loading=!0,this.viewModel.createBookmark().then((e=>{e.name=i,this.viewModel.bookmarks.add(e),this._endAddBookmark()}))):o.validationState="name-required"}async _editBookmarkAndClose(e,t){const{viewModel:o}=this;await o.editBookmark(e,{...o.defaultEditOptions,...t}),this._closeEditBookmarkForm()}_editBookmarkSubmit(e){e.preventDefault();const{_editInputNode:t,_userState:o,_editIncludeTimeExtent:i}=this,s=t&&t.value.trim();s?(o.bookmark.name=s,o.bookmark.thumbnail=o.editedBookmark.thumbnail,i||(o.bookmark.timeExtent=null),this._editBookmarkAndClose(o.bookmark,{takeScreenshot:!1,captureTimeExtent:i})):o.validationState="name-required"}_storeAddBookmarkButton(e){this._addBookmarkButtonNode=e,this._focusAddBookmark()}_storeEditInput(e){this._editInputNode=e,this._focusEditInput()}_storeAddInput(e){this._addInputNode=e,this._focusAddInput()}_storeUrlEditInput(e){this._urlEditInputNode=e,this._focusUrlEditInput()}_focusUrlEditInput(){this._urlEditInputNode&&this._focusUrlEditInputBox&&(this._focusUrlEditInputBox=!1,this._urlEditInputNode.focus())}_focusAddInput(){this._addInputNode&&this._focusAddInputBox&&(this._focusAddInputBox=!1,this._addInputNode.focus())}_focusAddBookmark(){this._addBookmarkButtonNode&&this._focusAddBookmarkButton&&(this._focusAddBookmarkButton=!1,this._addBookmarkButtonNode.focus())}_focusEditInput(){this._editInputNode&&this._focusEditInputBox&&(this._focusEditInputBox=!1,this._editInputNode.focus())}_deleteBookmark(e){const t=e.currentTarget["data-bookmark"];this.viewModel.bookmarks.remove(t)}_goToBookmark(e){const t=e.currentTarget["data-bookmark"];this.endAddBookmark(),this._closeEditBookmarkForm(),this.viewModel.goTo(t)}async _refreshThumbnail(){const{_userState:e,_editMenu:t,viewModel:o}=this;e.validationState=void 0,await o.editBookmark(this._userState.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}),t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_removeThumbnail(){const{_userState:e,_editMenu:t}=this;e.editedBookmark.thumbnail=null,e.validationState=void 0,t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_startUseImageUrl(){this._userState.state="edit-thumbnail",this._editMenu.open=!1,this._focusUrlEditInputBox=!0,this.scheduleRender()}_editBookmarkUrlSubmit(e){e.preventDefault();const{_urlEditInputNode:t,_userState:o}=this,i=t.value;qe.test(i)?(i&&(o.editedBookmark.thumbnail=new _.A({url:i})),this._closeUrlEditBookmarkForm()):o.validationState="absolute-url-required"}};(0,n._)([(0,m.Cb)()],Le.prototype,"_editIncludeTimeExtent",void 0),(0,n._)([(0,m.Cb)({type:B})],Le.prototype,"_userState",void 0),(0,n._)([(0,m.Cb)({readOnly:!0})],Le.prototype,"_editMenuItems",null),(0,n._)([(0,m.Cb)({readOnly:!0})],Le.prototype,"_editMenu",null),(0,n._)([(0,m.Cb)()],Le.prototype,"defaultCreateOptions",null),(0,n._)([(0,m.Cb)()],Le.prototype,"defaultEditOptions",null),(0,n._)([(0,m.Cb)()],Le.prototype,"bookmarks",null),(0,n._)([(0,m.Cb)()],Le.prototype,"disabled",void 0),(0,n._)([(0,m.Cb)()],Le.prototype,"editingEnabled",void 0),(0,n._)([(0,m.Cb)()],Le.prototype,"headingLevel",void 0),(0,n._)([(0,m.Cb)()],Le.prototype,"goToOverride",null),(0,n._)([(0,m.Cb)()],Le.prototype,"iconClass",void 0),(0,n._)([(0,m.Cb)()],Le.prototype,"label",null),(0,n._)([(0,m.Cb)(),(0,D.H)("esri/widgets/Bookmarks/t9n/Bookmarks")],Le.prototype,"messages",void 0),(0,n._)([(0,m.Cb)(),(0,D.H)("esri/t9n/common")],Le.prototype,"messagesCommon",void 0),(0,n._)([(0,m.Cb)(),(0,D.H)("esri/core/t9n/Units")],Le.prototype,"messagesUnits",void 0),(0,n._)([(0,m.Cb)()],Le.prototype,"uiStrings",void 0),(0,n._)([(0,m.Cb)()],Le.prototype,"view",null),(0,n._)([(0,m.Cb)({type:M}),(0,H.s)(["select-bookmark","bookmark-edit","bookmark-select"])],Le.prototype,"viewModel",void 0),(0,n._)([(0,m.Cb)()],Le.prototype,"visibleElements",void 0),(0,n._)([(0,c.p)("visibleElements")],Le.prototype,"castVisibleElements",null),(0,n._)([(0,m.Cb)()],Le.prototype,"endAddBookmark",null),(0,n._)([(0,m.Cb)()],Le.prototype,"startAddBookmark",null),Le=(0,n._)([(0,h.j)("esri.widgets.Bookmarks")],Le);const ze=Le;const Ge=e=>{const t=(0,i.useRef)(),o=(0,i.useRef)(!1),[s,a]=(0,i.useState)(),[n,d]=(0,i.useState)(!1);(0,i.useEffect)((()=>{var i,r;return o.current||(o.current=!0,a((i=t.current,r=e.view,new ze({view:r,container:i,editingEnabled:!0})))),()=>{s&&s.destroy()}}),[]),(0,i.useEffect)((()=>{d(e.isActive)}),[e.isActive]);const l=(0,i.useCallback)((t=>{e.toolDismissed()}),[]),u=(0,i.useCallback)((t=>{e.showTips(r)}),[]);return{bookmarkRef:t,isActive:n,toolDismissed:l,tipsClicked:u}};var Ke=o(80184);const Ye=e=>{const{bookmarkRef:t,isActive:o,toolDismissed:i,tipsClicked:r}=Ge(e);return(0,Ke.jsxs)(s.N$,{id:"bookmarks-panel",heading:"Bookmarks","data-panel":"bookmarks",hidden:!o,closed:!o||void 0,closable:!0,onCalcitePanelClose:i,children:[(0,Ke.jsx)(s.G1,{id:"tip",icon:"lightbulb",text:"Tips",slot:"header-actions-end",onClick:r}),(0,Ke.jsx)(s.G1,{id:"collapseTool",icon:"chevron-up",text:"",slot:"header-actions-end",onClick:a.F$}),(0,Ke.jsx)(s.$A,{label:"Show Tip",referenceElement:"tip",children:"Show Tip"}),(0,Ke.jsx)(s.$A,{label:"Collapse",referenceElement:"collapseTool",children:"Collapse"}),(0,Ke.jsx)("div",{ref:t})]})},We=i.memo(Ye)}}]);
//# sourceMappingURL=8458.20c4faf2.chunk.js.map