{"version":3,"file":"static/js/4402.6d708a24.chunk.js","mappings":"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","sources":["components/Panels/Layers/DevPlanFilter.tsx","components/Panels/Layers/utils/layers.tsx","components/Panels/Layers/utils/tips.ts","components/Panels/Layers/utils/useLayers.ts","components/Panels/Layers/Layers.tsx"],"sourcesContent":["import {\n    CalciteSlider,\n  } from \"@esri/calcite-components-react\";\n  import React, { useCallback } from \"react\";\n  import { useEffect, useRef, useState } from \"react\";\n  import \"./Layers.css\";\n  export const DevPlanFilter = (args: any) => {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const loaded = useRef(false);\n    const [maxYear, setMaxYear] = useState<number>(0);\n    const [minYear, setMinYear] = useState<number>(0);\n\n    const getMinMax = async (layer: __esri.FeatureLayer, datefield: string) => {\n        (args.layer as __esri.FeatureLayer).queryFeatures({\n          where: `EXTRACT(YEAR,${datefield}) >= 2010`,\n          returnGeometry: false,\n            outStatistics: [{\n              statisticType: 'max',\n              onStatisticField: datefield,\n              outStatisticFieldName: 'MAX_DATE'\n            },{\n              statisticType: 'min',\n              onStatisticField: datefield,\n              outStatisticFieldName: 'MIN_DATE'\n            }],\n            outFields: ['MAX_DATE','MIN_DATE']\n\n        }).then((stats) => {\n          if (stats?.features.length) {\n            const max = new Date(stats.features[0].getAttribute('MAX_DATE')).getFullYear();\n            const min = new Date(stats.features[0].getAttribute('MIN_DATE')).getFullYear();\n            layer.definitionExpression = `EXTRACT(YEAR FROM ${args.datefield}) >= ${min}\n            AND EXTRACT(YEAR FROM ${args.datefield}) <= ${max}\n            `;\n            layer.refresh();\n            setMaxYear(max);\n            setMinYear(min);\n            \n          }\n        }).catch(reason => {\n          console.log(reason);\n        });\n\n    }\n    useEffect( () => {\n     if (args.layer && args.datefield && !loaded.current) {\n        loaded.current = true;\n        getMinMax(args.layer, args.datefield).then(() => {\n\n        });\n     }\n\n    }, []); // only after first render\n\n  \n    return (\n      <div>\n        {/* <CalciteInputDatePicker overlay-positioning=\"fixed\" scale=\"m\" max={`2022-11-11`}\n        onCalciteInputDatePickerChange={e => {\n            console.log(e.detail);\n        }}\n        ></CalciteInputDatePicker> */}\n        <CalciteSlider \n          labelHandles \n          labelTicks \n          min={minYear} \n          max={maxYear} \n          maxValue={maxYear} \n          minValue={maxYear - 1} \n          minLabel={minYear.toString()} \n          maxLabel={maxYear.toString()}\n          onCalciteSliderChange={(e) => {\n            args.layer.definitionExpression = `EXTRACT(YEAR FROM ${args.datefield}) >= ${e.target.minValue}\n            AND EXTRACT(YEAR FROM ${args.datefield}) <= ${e.target.maxValue}\n            `;\n            args.layer.refresh();\n          }}\n          ></CalciteSlider>\n      </div>\n    );\n  };\n  export default DevPlanFilter;\n  ","import MapView from \"@arcgis/core/views/MapView\";\nimport WebMap from \"@arcgis/core/WebMap\";\nimport Collection from \"@arcgis/core/core/Collection\";\nimport ActionToggle from \"@arcgis/core/support/actions/ActionToggle\";\nimport LayerList from \"@arcgis/core/widgets/LayerList\";\nimport { lazy, Suspense } from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport FeatureLayer from \"@arcgis/core/layers/FeatureLayer\";\nimport DevPlanFilter from \"../DevPlanFilter\";\nconst OpacitySlider = lazy(() => import(\"../OpacitySlider\"));\n\nexport function initializeLayers(\n  ref: HTMLDivElement,\n  view: MapView\n): Promise<LayerList> {\n  return new Promise((resolve, reject) => {\n    addLayersFromWebmap(view).then(() => {\n      const layers = new LayerList({\n        view: view,\n        container: ref,\n        listItemCreatedFunction: layerListItemCreated,\n      });\n      layers.on(\n        \"trigger-action\",\n        (event: __esri.LayerListTriggerActionEvent) => {\n          if (event.item.layer.title === \"Property\") {\n            togglePropertyLabels(event);\n          }\n        }\n      );\n      resolve(layers);\n    });\n  });\n}\n\nfunction addLayersFromWebmap(view: MapView) {\n  return new Promise((resolve, reject) => {\n    const map = new WebMap({\n      portalItem: {\n        id: \"95092428774c4b1fb6a3b6f5fed9fbc4\",\n      },\n    });\n    map.load().then(() => {\n      const groups = view.map.allLayers\n        .filter((layer) => {\n          return layer.type === \"group\";\n        })\n        .toArray();\n      groups.forEach((group) => {\n        const match = map.allLayers.find((layer) => {\n          return layer.type === \"group\" && layer.title === group.title;\n        }) as __esri.GroupLayer;\n\n        (group as __esri.GroupLayer).addMany(\n          match.layers\n            .filter((layer) => {\n              return (\n                (group as __esri.GroupLayer).findLayerById(layer.id) ===\n                undefined\n              );\n            })\n            .toArray()\n        );\n      });\n      resolve(true);\n    });\n  });\n}\nconst setPropertyColor = (layer: FeatureLayer, light: boolean) => {\n  const renderer = (layer.renderer as __esri.SimpleRenderer).clone();\n  if (light) {\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.r = 0;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.g = 0;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.b = 0;\n  } else {\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.r = 255;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.g = 255;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.b = 255;\n  }\n  layer.renderer = renderer;\n};\nconst togglePropertyColor = (layer: FeatureLayer, sections: any) => {\n  if (sections.length > 1) {\n    setPropertyColor(layer, !sections.getItemAt(1).getItemAt(0).value);\n  }\n};\nexport const togglePropertyLabels = (\n  event: __esri.LayerListTriggerActionEvent\n) => {\n  if (event.item.layer.title === \"Property\") {\n    togglePropertyColor(\n      event.item.layer as FeatureLayer,\n      event.item.actionsSections\n    );\n    if (!(event.item.layer as __esri.FeatureLayer).labelsVisible) {\n      (event.item.layer as __esri.FeatureLayer).labelsVisible = true;\n    }\n    const selected = event.item.actionsSections\n      .getItemAt(0)\n      .filter((section) => {\n        return (section as ActionToggle).value;\n      });\n\n    const selectedTitles = selected.map((section) => {\n      return (section as ActionToggle).title;\n    });\n\n    const selectedExpressions = propertyLabelExpressions.filter(\n      (expression) => {\n        return selectedTitles.includes(expression.title);\n      }\n    );\n    const expressions = selectedExpressions.map((expression) => {\n      return expression.expression;\n    });\n    const expression = expressions.join(\"+ TextFormatting.NewLine+\");\n    (event.item.layer as __esri.FeatureLayer).labelingInfo = [];\n\n    //if ((event.action as ActionToggle).value) {\n    (event.item.layer as __esri.FeatureLayer).labelingInfo = [\n      {\n        // autocasts as new LabelClass()\n        symbol: {\n          type: \"text\", // autocasts as new TextSymbol()\n          color: \"black\",\n          haloColor: \"white\",\n          haloSize: 1,\n          font: {\n            family: \"AvenirNext LT Pro Regular\",\n            style: \"normal\",\n            weight: \"bold\",\n          },\n        },\n        labelExpressionInfo: {\n          expression: expression,\n        },\n        maxScale: 0,\n        minScale: 5000,\n      } as any,\n    ];\n    // }\n    // } else {\n    //   (event.item.layer as __esri.FeatureLayer).labelingInfo = (\n    //     event.item.layer as __esri.FeatureLayer\n    //   ).labelingInfo.filter((info) => {\n    //     return info.labelExpressionInfo.expression != expression.expression;\n    //   });\n    // }\n  }\n};\nconst propertyLabelExpressions: any[] = [\n  {\n    expression: `First(Split($feature['SITE_ADDRESS'], ' '))`,\n    title: \"Address\",\n  },\n  {\n    expression: `$feature['PIN_NUM']`,\n    title: \"PIN\",\n  },\n  {\n    expression: `$feature['REID']`,\n    title: \"REID\",\n  },\n  {\n    expression: `When(IsEmpty($feature[\"SALE_DATE\"]),null, Concatenate(Month($feature[\"SALE_DATE\"])+1, '/',Day($feature[\"SALE_DATE\"]), '/',Year($feature[\"SALE_DATE\"])))`,\n    title: \"Sale Date\",\n  },\n  {\n    expression: `Text($feature.TOTSALPRICE,'$#,###')`,\n    title: \"Sale Price\",\n  },\n];\n\nconst addPropertyLabelToggles = (item: any) => {\n  if (\n    item.layer.title === \"Property\" &&\n    item.layer.type !== \"group\" &&\n    item.actionsSections.length === 0\n  ) {\n    let toggles: Collection = new Collection();\n    toggles.addMany(\n      propertyLabelExpressions.map((expression) => {\n        return new ActionToggle({\n          value: item.layer.labelingInfo?.find((info: any) => {\n            return (\n              info.labelExpressionInfo?.expression.includes(\n                expression.expression\n              ) && item.layer.labelsVisible\n            );\n          }),\n          title: expression.title,\n          visible: true,\n        });\n      })\n    );\n    (item as __esri.ListItem).actionsSections.push(toggles);\n\n    toggles = new Collection();\n    toggles.add(\n      new ActionToggle({\n        value: item.layer.renderer.symbol.outline.color.isBright,\n        title: \"Light Outline\",\n        visible: true,\n      }) as any\n    );\n    (item as __esri.ListItem).actionsSections.push(toggles);\n\n    (item as __esri.ListItem).actionsOpen = true;\n    setTimeout(() => {\n      const title = document.createElement(\"h4\");\n      title.id = \"labels-actions-title\";\n      title.textContent = \"Labels\";\n      title.setAttribute(\"style\", \"padding: 0.5em;margin: 0;\");\n      const actions = document.querySelector(\".esri-layer-list__item-actions\");\n      if (\n        actions?.parentElement &&\n        !document.getElementById(\"labels-actions-title\")\n      ) {\n        actions.prepend(title);\n      }\n    }, 500);\n  }\n};\n\nconst addDevPlanFilters = (item: any) => {\n  if (\n    item.layer.title.includes('Development Plans') &&\n    item.layer.type !== \"group\" &&\n    item.actionsSections.length === 0\n  ) {\n    const filter = document.createElement(\"filter-container\");\n    const root = createRoot(filter as HTMLDivElement);\n    root.render(\n      <Suspense fallback={\"\"}>\n        <DevPlanFilter datefield={'apply_date'} layer={item.layer} />\n      </Suspense>\n    );\n    ((item as __esri.ListItem).panel.content as any[]).push(filter);\n  }\n}\n\nconst createPanel = (item: __esri.ListItem) => {\n  if (\n    item.visible &&\n    !item.panel &&\n    item.layer.type !== \"group\" &&\n    item.layer.type !== undefined\n  ) {\n    const slider = document.createElement(\"slider-container\");\n    const root = createRoot(slider as HTMLDivElement);\n    root.render(\n      <Suspense fallback={\"\"}>\n        <OpacitySlider value={item.layer.opacity} layer={item.layer} />\n      </Suspense>\n    );\n\n    item.panel = {\n      content: [slider, \"legend\"],\n      open: false,\n    } as __esri.ListItemPanel;\n    addDevPlanFilters(item);\n\n  }\n};\n\nconst layerListItemCreated = (event: any): void => {\n  const item = event.item;\n  createPanel(item);\n  item.open = item.layer.visible;\n  item.layer.watch(\"visible\", (visible: boolean) => {\n    // if (item.panel) {\n    //   item.panel.open = visible;\n    // }\n    item.open = visible;\n    createPanel(item);\n\n    if (visible) {\n      if (item.layer.parent) {\n        if (item.layer.parent.type === \"group\") {\n          item.layer.parent.visible = true;\n        }\n      }\n      if (item.layer.parent.parent) {\n        if (item.layer.parent.parent.type === \"group\") {\n          item.layer.parent.parent.visible = true;\n        }\n      }\n    }\n  });\n  addPropertyLabelToggles(item);\n};\n\nexport const filterLayers = (\n  value: string,\n  layerList: __esri.LayerList\n): void => {\n  if (!value) {\n    value = \"\";\n  }\n  layerList.operationalItems.forEach((item: __esri.ListItem) => {\n    if (item.layer.type === \"group\") {\n      let open = false;\n      (item.layer as __esri.GroupLayer).layers.forEach((layer) => {\n        if (layer.title.toLowerCase().includes(value.toLowerCase())) {\n          layer.listMode = \"show\";\n          open = true;\n        } else {\n          layer.listMode = \"hide\";\n        }\n        //handle second level group layers\n        if (layer.type === \"group\") {\n          (layer as __esri.GroupLayer).layers.forEach((sublayer) => {\n            if (sublayer.title.toLowerCase().includes(value.toLowerCase())) {\n              layer.listMode = \"show\";\n              sublayer.listMode = \"show\";\n              open = true;\n            } else {\n              sublayer.listMode = \"hide\";\n            }\n          });\n        }\n      });\n      item.open = value.length > 0 && open;\n      if (!value.length || open) {\n        document\n          .getElementById(\n            `${(layerList as any).id}_${(item as any).uid}__title`\n          )\n          ?.parentElement?.parentElement?.parentElement?.removeAttribute(\n            \"hidden\"\n          );\n      }\n      if (!open) {\n        document\n          .getElementById(\n            `${(layerList as any).id}_${(item as any).uid}__title`\n          )\n          ?.parentElement?.parentElement?.parentElement?.setAttribute(\n            \"hidden\",\n            \"\"\n          );\n      }\n    }\n  });\n};\n\nexport const resetLayers = (list: __esri.LayerList) => {\n  const groups: Collection<__esri.GroupLayer> = list?.view.map.allLayers.filter(layer => {\n    return layer.type === 'group';\n  }) as Collection<__esri.GroupLayer>;\n  groups.forEach((group) => {\n    group.visible = group.title === 'Property';\n    group.layers.forEach(layer => {\n      layer.visible = layer.title === \"Property\";\n    })\n  });  \n};\n","export const tips = {title: 'Layer List Tips', tips: [\n    {\n      title: 'Group Layers',\n      text: 'Layers in the layer list are now grouped based on category, making it easier to find layers.',\n    }\n]}","import { useCallback, useEffect, useRef, useState } from \"react\";\nimport { initializeLayers } from \"./layers\";\nimport { tips } from \"./tips\";\n\nconst useLayers = (args: any) => {\n\n    const ref = useRef() as any;\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const loaded = useRef(false);\n    const [layerList, setLayerList] = useState<__esri.LayerList>();\n    const [isLoading, setIsLoading] = useState(true);\n    const [isActive, setIsActive] = useState(false);\n  \n    useEffect(() => {\n      if (!loaded.current) {\n        loaded.current = true;\n        initializeLayers(ref.current, args.view).then(\n          (layerList: __esri.LayerList) => {\n            setLayerList(layerList);\n            layerList.when(() => {\n              setIsLoading(false);\n            });\n          }\n        );\n      }\n      return () => {\n        layerList && layerList?.destroy();\n      };\n    }, []); // only after first render\n  \n    useEffect(() => {\n      setIsActive(args.isActive);\n    }, [args.isActive]);\n    const panelDismissed = useCallback((e: any) => {\n        args.panelDismissed();\n        }, []);\n    const tipsClicked = useCallback((e: any) => {\n        args.showTips(tips);\n        }, []);    \n    return {\n        ref,\n        layerList,\n        isLoading,\n        isActive,\n        panelDismissed,\n        tipsClicked        \n        }        \n}\nexport default useLayers;","import {\n  CalciteAction,\n  CalciteInput,\n  CalciteScrim,\n  CalcitePanel,\n} from \"@esri/calcite-components-react\";\nimport React from \"react\";\nimport { filterLayers, resetLayers } from \"./utils/layers\";\nimport \"./Layers.css\";\nimport useLayers from \"./utils/useLayers\";\nexport const Layers = (args: any) => {\n  \n  const { \n    ref,\n    layerList,\n    isLoading,\n    isActive,\n    panelDismissed,\n    tipsClicked      \n  } = useLayers(args);\n\n  return (\n    <CalcitePanel\n      id=\"layers-panel\"\n      heading=\"Layers\"\n      hidden={!isActive}\n      closed={!isActive ? true : undefined}\n      dismissed={!isActive ? true : undefined}\n      dismissible\n      onCalcitePanelDismiss={panelDismissed}\n    >\n      <CalciteAction icon=\"lightbulb\"  text=\"Tips\" slot=\"header-actions-end\" onClick={tipsClicked}></CalciteAction>\n      <div className=\"layers\">\n        {layerList && (\n          <div className=\"row sticky\">\n            <CalciteInput\n              clearable\n              placeholder=\"Filter by layer name\"\n              scale=\"m\"\n              onCalciteInputInput={(e) => {\n                if (layerList) {\n                  filterLayers(e.target.value, layerList);\n                }\n              }}\n            ></CalciteInput>\n            <CalciteAction\n              text=\"clear\"\n              icon=\"viewHide\"\n              scale=\"s\"\n              onClick={() => resetLayers(layerList)}\n            ></CalciteAction>\n          </div>\n        )}\n        <div ref={ref}></div>\n        <CalciteScrim\n          loading\n          hidden={isLoading ? undefined : true}\n        ></CalciteScrim>\n      </div>\n    </CalcitePanel>\n  );\n};\nexport default Layers;\n"],"names":["args","loaded","useRef","maxYear","setMaxYear","useState","minYear","setMinYear","useEffect","layer","datefield","current","async","queryFeatures","where","returnGeometry","outStatistics","statisticType","onStatisticField","outStatisticFieldName","outFields","then","stats","features","length","max","Date","getAttribute","getFullYear","min","definitionExpression","refresh","catch","reason","console","log","getMinMax","labelHandles","labelTicks","maxValue","minValue","minLabel","toString","maxLabel","onCalciteSliderChange","e","target","OpacitySlider","lazy","initializeLayers","ref","view","Promise","resolve","reject","map","WebMap","portalItem","id","load","allLayers","filter","type","toArray","forEach","group","match","find","title","addMany","layers","undefined","findLayerById","addLayersFromWebmap","LayerList","container","listItemCreatedFunction","layerListItemCreated","on","event","item","togglePropertyLabels","sections","actionsSections","light","renderer","clone","symbol","outline","color","r","g","b","setPropertyColor","getItemAt","value","labelsVisible","selectedTitles","section","selectedExpressions","propertyLabelExpressions","expression","includes","expressions","join","labelingInfo","haloColor","haloSize","font","family","style","weight","labelExpressionInfo","maxScale","minScale","createPanel","visible","panel","slider","document","createElement","createRoot","render","Suspense","fallback","opacity","content","open","push","addDevPlanFilters","watch","parent","toggles","Collection","ActionToggle","info","add","isBright","actionsOpen","setTimeout","textContent","setAttribute","actions","querySelector","parentElement","getElementById","prepend","addPropertyLabelToggles","tips","text","layerList","setLayerList","isLoading","setIsLoading","isActive","setIsActive","when","destroy","panelDismissed","useCallback","tipsClicked","showTips","Layers","useLayers","heading","hidden","closed","dismissed","dismissible","onCalcitePanelDismiss","icon","slot","onClick","className","clearable","placeholder","scale","onCalciteInputInput","operationalItems","toLowerCase","listMode","sublayer","uid","removeAttribute","filterLayers","list","loading"],"sourceRoot":""}