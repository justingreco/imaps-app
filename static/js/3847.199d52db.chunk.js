"use strict";(globalThis.webpackChunkimaps_app=globalThis.webpackChunkimaps_app||[]).push([[3847,3513],{23847:(e,t,o)=>{o.r(t),o.d(t,{default:()=>se});var i=o(72791),l=o(85580),n=o(97426),a=o(33513),r=o(61459),s=o(16851),c=o(58009),p=o(80045),y=o(76200),d=o(75021),u=o(49729),m=o(86828);let h,b,f,g,x,S,v,C,w,j,N,L,O,Z="",_=new r.Z({color:[255,0,0,.5],style:"solid",outline:{width:2,color:[255,0,0,1]}}),T=new s.Z({width:1,color:[255,0,0,1],style:"solid",cap:"round",join:"round"}),k=new c.Z({color:[255,0,0,1],haloColor:[255,255,255,1],haloSize:"1px",text:"",xoffset:3,yoffset:3,font:{size:10,family:"Aerial",weight:"bold"}});function I(e,t,o){const i=new n.Z({view:t,layer:e,updateOnGraphicClick:!0});return i.on("create",J),i}function J(e){"complete"===e.state&&("polygon"===e.graphic.geometry.type&&(e.graphic.symbol=_,x.polygonLayer.add(e.graphic),w.create(e.tool)),"polyline"===e.graphic.geometry.type&&(e.graphic.symbol=T,x.polylineLayer.add(e.graphic),C.create(e.tool)),"text"===Z&&(e.graphic.symbol=k,x.textLayer.add(e.graphic),j.create("point")),"point"===Z&&(e.graphic.symbol=S,x.pointLayer.add(e.graphic),v.create("point")),L&&L.remove(),L=N.highlight(e.graphic),O=e.graphic)}function M(e,t,o){Z=e,o(e===t?"":e),""===t&&P(),["polygon","rectangle","circle"].includes(e)&&w.create(e),["polyline"].includes(e)&&C.create(e),"text"===e&&C.create("point"),"point"===e&&C.create("point")}let E=!1;function R(e,t,o){const i=document.getElementById("polygon-preview");i&&!E&&(_.color=e,_.outline.color=t,_.outline.width=o,w&&(w.activeFillSymbol=_,x.polygonLayer&&F(x.polygonLayer,_)),E=!0,i.innerHTML="",m.l3(_,{node:i,size:24}).then((()=>E=!1)))}function F(e,t){O&&(e.remove(O),O.symbol=t,O=O.clone(),e.add(O),L=N.highlight(O))}function U(e,t,o){(0,y.default)(`${e.url}${e.cimRef.replace(".","")}`).then((e=>{S=new d.Z({data:{type:"CIMSymbolReference",symbol:null===e||void 0===e?void 0:e.data}}),u.ZB(S,t),u.PI(S,o),x.pointLayer&&F(x.pointLayer,S),v.pointSymbol=S;const i=document.getElementById("icon-preview");i&&(i.innerHTML="",m.l3(S,{node:i,size:o}))}))}function G(e,t){T.color=e,T.width=t,C&&(C.polylineSymbol=T,C.updateGraphics.forEach((e=>{e.symbol=T})),x.polylineLayer&&F(x.polylineLayer,T));const o=document.getElementById("line-preview");o&&(o.innerHTML="",m.l3(T,{node:o,size:t}))}function z(e,t,o,i,l,n){k.color=t,k.font.size=e,k.haloColor=i,k.haloSize=l?o:0,k.text=n,j.pointSymbol=k,x.textLayer&&F(x.textLayer,k)}function P(){v.cancel(),C.cancel(),w.cancel(),j.cancel()}var $=o(51995),D=o(80184);function B(e){const t=(0,i.useRef)(null),o=(0,i.useRef)(null),[n,a]=(0,i.useState)(),[r,s]=(0,i.useState)(0);return(0,i.useEffect)((()=>{!n&&e.color&&(a(new $.Z(e.color)),s(100*(1-e.color[3])))}),[e.color]),(0,D.jsxs)("div",{id:e.id,children:[(0,D.jsxs)(l.ZK,{children:[e.label," Color",(0,D.jsx)(l.ln,{id:`${e.id}-popover-button`,width:"half",iconEnd:"pencil",color:"neutral",appearance:"outline",children:(0,D.jsx)(l.jv,{color:null===n||void 0===n?void 0:n.toHex()})})]}),(0,D.jsx)(l.qZ,{ref:t,overlayPositioning:"fixed",placement:"top-leading",label:"",referenceElement:`${e.id}-popover-button`,children:(0,D.jsxs)(l.N$,{heading:"Color",children:[(0,D.jsx)(l.G1,{icon:"x",text:"",slot:"header-actions-end",onClick:()=>{var o;null===(o=t.current)||void 0===o||o.toggle();const i=new $.Z(n);i.a=1-r/100,e.colorSet(i)}}),(0,D.jsx)(l.ne,{ref:o,hideSaved:!0,hideHex:!0,hideChannels:!0,value:n?n.toHex():"#FF0000",onCalciteColorPickerInput:e=>a(new $.Z(e.target.value))})]})}),!e.hideTransparency&&(0,D.jsxs)(l.ZK,{children:[e.label," Transparency",(0,D.jsxs)("div",{className:"slider-input",children:[(0,D.jsx)(l.XQ,{max:100,min:0,value:r,onCalciteSliderInput:t=>{let o=t.target.value;o>100&&(o=100),o<0&&(o=0),s(o);const i=new $.Z(n);i.a=1-r/100,e.colorSet(i)}}),(0,D.jsx)(l.e,{max:100,min:0,type:"number",numberButtonType:"none",suffixText:"%",value:r,onCalciteInputInput:t=>{let o=parseInt(t.target.value);o>100&&(o=100),o<0&&(o=0),s(o);const i=new $.Z(n);i.a=1-r/100,e.colorSet(i)}})]})]})]})}const W=i.memo(B);function A(e){const[t,o]=(0,i.useState)();return(0,i.useEffect)((()=>{o(e.value)}),[e.value]),(0,D.jsxs)(l.ZK,{children:[e.label,(0,D.jsxs)("div",{className:"slider-input",children:[(0,D.jsx)(l.XQ,{max:e.max,min:e.min,value:t,onCalciteSliderInput:t=>{o(t.target.value),e.sizeSet(t.target.value)}}),(0,D.jsx)(l.e,{type:"number",numberButtonType:"none",min:e.min,max:e.max,value:t,suffixText:"px",onCalciteInputInput:t=>{o(parseFloat(t.target.value)),e.sizeSet(parseFloat(t.target.value))}})]})]})}const K=i.memo(A);function H(e){const[t,o]=(0,i.useState)(new $.Z([255,0,0,1])),[l,n]=(0,i.useState)(2);return(0,i.useEffect)((()=>{t&&l&&e.polylineSymbolUpdated(t,l)}),[t,l]),(0,D.jsxs)("div",{id:"line-symbols",children:[(0,D.jsx)("div",{id:"line-preview",className:"preview"}),(0,D.jsx)(W,{id:"line",label:"Line",color:t.toRgba(),colorSet:t=>{o(t),e.polylineSymbolUpdated(t,l)}}),(0,D.jsx)(K,{value:l,min:.1,max:18,label:"Width",sizeSet:o=>{n(o),e.polylineSymbolUpdated(t,l)}})]})}const q=i.memo(H);function X(e){const[t,o]=(0,i.useState)(new $.Z([255,0,0,.5])),[l,n]=(0,i.useState)(new $.Z([255,0,0,1])),[a,r]=(0,i.useState)(2);return(0,i.useEffect)((()=>{t&&l&&a&&e.polygonSymbolUpdated(t,l,a)}),[t,l,a]),(0,D.jsxs)("div",{id:"polygon-symbols",children:[(0,D.jsx)("div",{id:"polygon-preview",className:"preview"}),(0,D.jsx)(W,{id:"polygon-fill",color:t.toRgba(),label:"Fill",colorSet:t=>{o(t),e.polygonSymbolUpdated(t,l,a)}}),(0,D.jsx)(W,{id:"polygon-outline",color:l.toRgba(),label:"Outline",colorSet:o=>{n(o),e.polygonSymbolUpdated(t,o,a)}}),(0,D.jsx)(K,{label:"Outline Width",min:.1,max:18,value:a,sizeSet:o=>{r(o),e.polygonSymbolUpdated(t,l,a)}})]})}const Q=i.memo(X);function V(e){const[t,o]=(0,i.useState)(new $.Z([255,0,0,1])),[n,a]=(0,i.useState)(10),[r,s]=(0,i.useState)(!1),[c,p]=(0,i.useState)(1),[y,d]=(0,i.useState)(new $.Z([255,255,255,1])),[u,m]=(0,i.useState)("");return(0,D.jsxs)("div",{id:"text-symbols",children:[(0,D.jsxs)(l.ZK,{children:["Text",(0,D.jsx)(l.e,{type:"textarea",scale:"m",value:u,onCalciteInputInput:e=>{m(e.target.value)},onCalciteInputChange:o=>{requestAnimationFrame((()=>{e.textSymbolUpdated(n,t,c,y,r,u)}))}})]}),(0,D.jsx)(W,{id:"font",label:"Font",color:t.toRgba(),hideTransparency:!0,colorSet:t=>{o(t),e.textSymbolUpdated(n,t,c,y,r,u)}}),(0,D.jsxs)(l.ZK,{children:["Font Size",(0,D.jsx)(l.e,{type:"number",min:5,max:125,value:n.toString(),onCalciteInputInput:o=>{a(parseFloat(o.target.value)),e.textSymbolUpdated(n,t,c,y,r,u)}})]}),(0,D.jsxs)(l.ZK,{layout:"inline",children:["Halo",(0,D.jsx)(l.$p,{checked:!!r||void 0,onCalciteSwitchChange:o=>{s(o.target.checked),e.textSymbolUpdated(n,t,c,y,r,u)}})]}),(0,D.jsxs)("div",{id:"halo",hidden:!r||void 0,children:[(0,D.jsx)(W,{id:"halo",label:"",color:y.toRgba(),hideTransparency:!0,colorSet:o=>{d(o),e.textSymbolUpdated(n,t,c,o,r,u)}}),(0,D.jsxs)(l.ZK,{children:["Size",(0,D.jsx)(l.e,{type:"number",min:1,max:10,value:c.toString(),onCalciteInputInput:o=>{p(parseFloat(o.target.value)),e.textSymbolUpdated(n,t,c,y,r,u)}})]})]})]})}const Y=i.memo(V);o(75655),o(35738),o(85026);function ee(e){return(0,D.jsxs)("div",{id:"icon-picker",children:[(0,D.jsx)("div",{id:"icon-preview",className:"preview"}),(0,D.jsx)(l.ZK,{alignment:"start",scale:"m",layout:"default",children:(0,D.jsx)("button",{className:"change-symbol-trigger",type:"button",onClick:()=>{e.pickerClicked()},children:(0,D.jsxs)("div",{className:"container",children:[e.symbol&&(0,D.jsx)("div",{className:"icon-symbol",children:(0,D.jsx)("img",{src:`${e.symbol.url}${e.symbol.thumbnail.href.replace(".","")}`,alt:e.symbol.title,width:50,height:50})}),(0,D.jsx)("div",{className:"icon-label",children:e.symbol.title}),(0,D.jsx)(l.oh,{icon:"chevron-right"})]})})})]})}const te=i.memo(ee);function oe(e){const[t,o]=(0,i.useState)([]);return(0,i.useEffect)((()=>{t&&e.symbols&&o(e.symbols)}),[]),(0,D.jsx)("div",{id:"icon-selection",children:(0,D.jsx)(l.N$,{showBackButton:!0,heading:"Change Symbol",onCalcitePanelBackClick:()=>{e.backClicked()},children:(0,D.jsx)("div",{className:"palette",children:t&&t.map(((t,o)=>(0,D.jsx)("img",{onClick:()=>{e.iconSelected(t),e.backClicked()},className:"item",alt:t.title,src:`${t.url}${t.thumbnail.href.replace(".","")}`},`icon-${o}`)))})})})}const ie=i.memo(oe);function le(e){const[t,o]=(0,i.useState)([]),[n,a]=(0,i.useState)(),[r,s]=(0,i.useState)(16),c=["a63b3a4631ae41d4a1bc3ba6d9c85bfe","70ccf6bcbd304773a164be896e76edd3"],[d,u]=(0,i.useState)("main"),[m,h]=(0,i.useState)(new $.Z([255,0,0,1]));return(0,i.useEffect)((()=>{(function(e,t){return new Promise(((o,i)=>{const l=[];e.forEach((e=>{const o=new p.Z({styleUrl:`${t}/${e}/data`,name:"Pins"});l.push((0,y.default)(o.styleUrl))})),l.length;const n=[];Promise.all(l).then((e=>{e.forEach((e=>{e.data.items.forEach((t=>{t.url=e.url.replace("data",""),n.push(t)}))})),o(n)}))}))})(c,"https://www.arcgis.com/sharing/rest/content/items/").then((t=>{o(t),t.length&&(a(t[0]),e.pointSymbolUpdated(t[0],m,r))}))}),[]),(0,D.jsx)("div",{id:"point-symbols",children:t.length&&(0,D.jsxs)("div",{children:["main"===d&&(0,D.jsxs)(l.N$,{children:[(0,D.jsx)(te,{pickerClicked:()=>u("icon"),symbol:n}),(0,D.jsx)(W,{id:"point",label:"Point",color:m.toRgba(),colorSet:t=>{h(t),e.pointSymbolUpdated(n,t,r)}}),(0,D.jsxs)(l.ZK,{children:["Size",(0,D.jsx)(l.e,{type:"number",min:6,max:72,value:r.toString(),onCalciteInputChange:t=>{s(parseFloat(t.target.value)),e.pointSymbolUpdated(n,m,parseFloat(t.target.value))}})]})]}),"icon"===d&&(0,D.jsx)(ie,{iconSelected:t=>{a(t),e.pointSymbolUpdated(t,m,r)},backClicked:()=>u("main"),symbols:t})]})})}const ne=i.memo(le);var ae=o(9283);function re(e){const t=(0,i.useRef)(!1),[o,n]=(0,i.useState)(""),[r,s]=(0,i.useState)(!1),[c,p]=(0,i.useState)([]);(0,i.useEffect)((()=>{t.current||function(e,t,o,i){x=new a.default({listMode:"hide",id:"notes-layer"}),e.map.add(x),e.whenLayerView(x).then((e=>N=e)),h=x.pointLayer,b=x.polylineLayer,f=x.polygonLayer,g=x.textLayer,v=I(h,e),C=I(b,e),w=I(f,e),w.activeFillSymbol=_,C.activeLineSymbol=T,j=I(g,e),[v,C,w,j].forEach((e=>{null===e||void 0===e||e.on("create",(o=>{"cancel"===o.state&&null!==e.activeTool&&(t("select"),L&&L.remove())})),null===e||void 0===e||e.on("update",(e=>{"start"!==e.state&&"active"!==e.state||i([...e.graphics])}))}))}(e.view,n,0,p)}),[]),(0,i.useEffect)((()=>{s(e.isActive)}),[e.isActive]);const y=(0,i.useCallback)((t=>{e.toolDismissed(),P(),n("")}),[]);return(0,D.jsxs)(l.N$,{id:"sketch-panel",heading:"Sketch","data-panel":"sketch",hidden:!r,closed:!r||void 0,dismissed:!r||void 0,dismissible:!0,onCalcitePanelDismiss:y,children:[(0,D.jsx)(l.G1,{icon:"chevron-up",text:"",slot:"header-actions-end",onClick:ae.F$}),(0,D.jsxs)("div",{id:"sketch-tools",children:[(0,D.jsxs)("div",{className:"sticky",children:[(0,D.jsxs)(l.Te,{layout:"horizontal",children:[(0,D.jsx)(l.G1,{active:"point"===o||void 0,icon:"pin",text:"",onClick:()=>M("point",o,n)}),(0,D.jsx)(l.G1,{active:"polyline"===o||void 0,icon:"line",text:"",onClick:()=>M("polyline",o,n)}),(0,D.jsx)(l.G1,{active:"polygon"===o||void 0,icon:"polygon",text:"",onClick:()=>M("polygon",o,n)}),(0,D.jsx)(l.G1,{active:"rectangle"===o||void 0,icon:"rectangle",text:"",onClick:()=>M("rectangle",o,n)}),(0,D.jsx)(l.G1,{active:"circle"===o||void 0,icon:"circle",text:"",onClick:()=>M("circle",o,n)}),(0,D.jsx)(l.G1,{active:"text"===o||void 0,icon:"text",text:"",onClick:()=>M("text",o,n)})]}),(0,D.jsxs)(l.Te,{layout:"horizontal",children:[(0,D.jsx)(l.G1,{icon:"cursor",text:"",active:"select"===o||void 0,onClick:()=>{v.cancel(),w.cancel(),C.cancel(),j.cancel(),M("select",o,n)}}),(0,D.jsx)(l.G1,{icon:"trash",text:"",onClick:()=>(x.polygonLayer.graphics.removeAll(),x.pointLayer.graphics.removeAll(),x.polylineLayer.graphics.removeAll(),void x.textLayer.graphics.removeAll())})]})]}),(0,D.jsx)("div",{id:"point-symbols",className:"symbol",hidden:"point"!==o||void 0,children:(0,D.jsx)(ne,{pointSymbolUpdated:U})}),(0,D.jsx)("div",{id:"line-symbols",className:"symbol",hidden:"polyline"!==o||void 0,children:(0,D.jsx)(q,{polylineSymbolUpdated:G})}),(0,D.jsx)("div",{id:"polygon-symbols",className:"symbol",hidden:!["polygon","rectangle","circle"].includes(o)||void 0,children:(0,D.jsx)(Q,{polygonSymbolUpdated:R})}),(0,D.jsx)("div",{id:"text-symbols",className:"symbol",hidden:"text"!==o||void 0,children:(0,D.jsx)(Y,{textSymbolUpdated:z})}),c.length>0&&(0,D.jsxs)(l.ln,{onClick:()=>function(e,t){h.removeMany(e),f.removeMany(e),b.removeMany(e),g.removeMany(e),requestAnimationFrame((()=>{t((e=>[]))}))}(c,p),alignment:"center",color:"red",appearance:"transparent","icon-end":"trash",children:[c.length," ",c.length>1?"features":"feature"]})]})]})}const se=i.memo(re)},33513:(e,t,o)=>{o.r(t),o.d(t,{default:()=>z});var i=o(27366),l=(o(59486),o(52639)),n=(o(51508),o(40281)),a=o(10064),r=o(84652),s=o(92026),c=o(97642),p=o(18202),y=o(51370),d=o(49861),u=(o(25243),o(38511)),m=o(69912),h=o(31201),b=o(79803),f=o(50689),g=o(92975),x=o(16455),S=o(93655),v=o(30651),C=o(25820),w=o(6693),j=o(6061),N=o(29598),L=o(56811),O=o(83040),Z=o(61459),_=o(16851),T=o(16072),k=o(58009),I=o(78952),J=o(53866);function M(e){return e.layers.some((e=>null!=e.layerDefinition.visibilityField))}const E=new O.Z({name:"OBJECTID",alias:"OBJECTID",type:"oid",nullable:!1,editable:!1}),R=new O.Z({name:"title",alias:"Title",type:"string",nullable:!0,editable:!0});let F=class extends S.Z{constructor(e){super(e),this.visibilityMode="inherited"}initialize(){for(const e of this.graphics)e.sourceLayer=this.layer;this.graphics.on("after-add",(e=>{e.item.sourceLayer=this.layer})),this.graphics.on("after-remove",(e=>{e.item.sourceLayer=null}))}get sublayers(){return this.graphics}};(0,i._)([(0,d.Cb)({readOnly:!0})],F.prototype,"sublayers",null),(0,i._)([(0,d.Cb)()],F.prototype,"layer",void 0),(0,i._)([(0,d.Cb)()],F.prototype,"layerId",void 0),(0,i._)([(0,d.Cb)({readOnly:!0})],F.prototype,"visibilityMode",void 0),F=(0,i._)([(0,m.j)("esri.layers.MapNotesLayer.MapNotesSublayer")],F);const U=[{geometryType:"polygon",geometryTypeJSON:"esriGeometryPolygon",id:"polygonLayer",layerId:0,title:"Polygons",identifyingSymbol:(new Z.Z).toJSON()},{geometryType:"polyline",geometryTypeJSON:"esriGeometryPolyline",id:"polylineLayer",layerId:1,title:"Polylines",identifyingSymbol:(new _.Z).toJSON()},{geometryType:"multipoint",geometryTypeJSON:"esriGeometryMultipoint",id:"multipointLayer",layerId:2,title:"Multipoints",identifyingSymbol:(new T.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"pointLayer",layerId:3,title:"Points",identifyingSymbol:(new T.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"textLayer",layerId:4,title:"Text",identifyingSymbol:(new k.Z).toJSON()}];let G=class extends((0,w.h)((0,L.M)((0,j.q)((0,N.I)((0,c.R)(v.Z)))))){constructor(e){super(e),this.capabilities={operations:{supportsMapNotesEditing:!0}},this.featureCollections=null,this.featureCollectionJSON=null,this.featureCollectionType="notes",this.legendEnabled=!1,this.minScale=0,this.maxScale=0,this.spatialReference=I.Z.WGS84,this.sublayers=new n.Z(U.map((e=>new F({id:e.id,layerId:e.layerId,title:e.title,layer:this})))),this.title="Map Notes",this.type="map-notes",this.visibilityMode="inherited"}readCapabilities(e,t,o){return{operations:{supportsMapNotesEditing:!M(t)&&"portal-item"!==o?.origin}}}readFeatureCollections(e,t,o){if(!M(t))return null;const i=t.layers.map((e=>{const t=new x.default;return t.read(e,o),t}));return new n.Z({items:i})}readLegacyfeatureCollectionJSON(e,t){return M(t)?(0,r.d9)(t.featureCollection):null}readFullExtent(e,t){if(!t.layers.length||t.layers.every((e=>!e.layerDefinition.extent)))return new J.Z({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:I.Z.WGS84});const o=I.Z.fromJSON(t.layers[0].layerDefinition.spatialReference);return t.layers.reduce(((e,t)=>{const o=t.layerDefinition.extent;return o?J.Z.fromJSON(o).union(e):e}),new J.Z({spatialReference:o}))}readMinScale(e,t){for(const o of t.layers)if(null!=o.layerDefinition.minScale)return o.layerDefinition.minScale;return 0}readMaxScale(e,t){for(const o of t.layers)if(null!=o.layerDefinition.maxScale)return o.layerDefinition.maxScale;return 0}get multipointLayer(){return this._findSublayer("multipointLayer")}get pointLayer(){return this._findSublayer("pointLayer")}get polygonLayer(){return this._findSublayer("polygonLayer")}get polylineLayer(){return this._findSublayer("polylineLayer")}readSpatialReference(e,t){return t.layers.length?I.Z.fromJSON(t.layers[0].layerDefinition.spatialReference):I.Z.WGS84}readSublayers(e,t,o){if(M(t))return null;const i=[];let a=t.layers.reduce(((e,t)=>Math.max(e,t.layerDefinition.id??-1)),-1)+1;for(const{layerDefinition:n,featureSet:r}of t.layers){const e=n.geometryType??r.geometryType,t=n.id??a++,o=U.find((t=>e===t.geometryTypeJSON&&n.drawingInfo?.renderer?.symbol?.type===t.identifyingSymbol.type));if(o){const e=new F({id:o.id,title:n.name,layerId:t,layer:this,graphics:r.features.map((e=>{let{geometry:t,symbol:o,attributes:i,popupInfo:n}=e;return l.Z.fromJSON({attributes:i,geometry:t,symbol:o,popupTemplate:n})}))});i.push(e)}}return new n.Z(i)}writeSublayers(e,t,o,i){const{minScale:l,maxScale:n}=this;if((0,s.Wi)(e))return;const r=e.some((e=>e.graphics.length>0));if(!this.capabilities.operations.supportsMapNotesEditing)return void(r&&i?.messages?.push(new a.Z("map-notes-layer:editing-not-supported","New map notes cannot be added to this layer")));const c=[];let y=this.spatialReference.toJSON();e:for(const a of e)for(const e of a.graphics)if((0,s.pC)(e.geometry)){y=e.geometry.spatialReference.toJSON();break e}for(const a of U){const t=e.find((e=>a.id===e.id));this._writeMapNoteSublayer(c,t,a,l,n,y,i)}(0,p.RB)("featureCollection.layers",c,t)}get textLayer(){return this._findSublayer("textLayer")}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},e)),Promise.resolve(this)}read(e,t){"featureCollection"in e&&(e=(0,r.d9)(e),Object.assign(e,e.featureCollection)),super.read(e,t)}async beforeSave(){if((0,s.Wi)(this.sublayers))return;let e=null;const t=[];for(const i of this.sublayers)for(const o of i.graphics)if((0,s.pC)(o.geometry)){const i=o.geometry;e?(0,g.fS)(i.spatialReference,e)||((0,b.Up)(i.spatialReference,e)||(0,b.kR)()||await(0,b.zD)(),o.geometry=(0,b.iV)(i,e)):e=i.spatialReference,t.push(o)}const o=await(0,f.aX)(t.map((e=>e.geometry)));t.forEach(((e,t)=>e.geometry=o[t]))}_findSublayer(e){return(0,s.Wi)(this.sublayers)?null:this.sublayers?.find((t=>t.id===e))??null}_writeMapNoteSublayer(e,t,o,i,l,n,a){const c=[];if(!(0,s.Wi)(t)){for(const e of t.graphics)this._writeMapNote(c,e,o.geometryType,a);this._normalizeObjectIds(c,E),e.push({layerDefinition:{name:t.title,drawingInfo:{renderer:{type:"simple",symbol:(0,r.d9)(o.identifyingSymbol)}},id:t.layerId,geometryType:o.geometryTypeJSON,minScale:i,maxScale:l,objectIdField:"OBJECTID",fields:[E.toJSON(),R.toJSON()],spatialReference:n},featureSet:{features:c,geometryType:o.geometryTypeJSON}})}}_writeMapNote(e,t,o,i){if((0,s.Wi)(t))return;const{geometry:l,symbol:n,popupTemplate:a}=t;if((0,s.Wi)(l))return;if(l.type!==o)return void i?.messages?.push(new y.Z("map-notes-layer:invalid-geometry-type",`Geometry "${l.type}" cannot be saved in "${o}" layer`,{graphic:t}));if((0,s.Wi)(n))return void i?.messages?.push(new y.Z("map-notes-layer:no-symbol","Skipping map notes with no symbol",{graphic:t}));const r={attributes:{...t.attributes},geometry:l.toJSON(),symbol:n.toJSON()};(0,s.pC)(a)&&(r.popupInfo=a.toJSON()),e.push(r)}_normalizeObjectIds(e,t){const o=t.name;let i=(0,C.S)(o,e)+1;const l=new Set;for(const n of e){n.attributes||(n.attributes={});const{attributes:e}=n;(null==e[o]||l.has(e[o]))&&(e[o]=i++),l.add(e[o])}}};(0,i._)([(0,d.Cb)({readOnly:!0})],G.prototype,"capabilities",void 0),(0,i._)([(0,u.r)(["portal-item","web-map"],"capabilities",["layers"])],G.prototype,"readCapabilities",null),(0,i._)([(0,d.Cb)({readOnly:!0})],G.prototype,"featureCollections",void 0),(0,i._)([(0,u.r)(["web-map","portal-item"],"featureCollections",["layers"])],G.prototype,"readFeatureCollections",null),(0,i._)([(0,d.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{enabled:!0,target:"featureCollection"}}}}})],G.prototype,"featureCollectionJSON",void 0),(0,i._)([(0,u.r)(["web-map","portal-item"],"featureCollectionJSON",["featureCollection"])],G.prototype,"readLegacyfeatureCollectionJSON",null),(0,i._)([(0,d.Cb)({readOnly:!0,json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],G.prototype,"featureCollectionType",void 0),(0,i._)([(0,d.Cb)({json:{write:!1}})],G.prototype,"fullExtent",void 0),(0,i._)([(0,u.r)(["web-map","portal-item"],"fullExtent",["layers"])],G.prototype,"readFullExtent",null),(0,i._)([(0,d.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{target:"featureCollection.showLegend",overridePolicy(){return{enabled:null!=this.featureCollectionJSON}}}}}}})],G.prototype,"legendEnabled",void 0),(0,i._)([(0,d.Cb)({type:["show","hide"]})],G.prototype,"listMode",void 0),(0,i._)([(0,d.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],G.prototype,"minScale",void 0),(0,i._)([(0,u.r)(["web-map","portal-item"],"minScale",["layers"])],G.prototype,"readMinScale",null),(0,i._)([(0,d.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],G.prototype,"maxScale",void 0),(0,i._)([(0,u.r)(["web-map","portal-item"],"maxScale",["layers"])],G.prototype,"readMaxScale",null),(0,i._)([(0,d.Cb)({readOnly:!0})],G.prototype,"multipointLayer",null),(0,i._)([(0,d.Cb)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],G.prototype,"operationalLayerType",void 0),(0,i._)([(0,d.Cb)({readOnly:!0})],G.prototype,"pointLayer",null),(0,i._)([(0,d.Cb)({readOnly:!0})],G.prototype,"polygonLayer",null),(0,i._)([(0,d.Cb)({readOnly:!0})],G.prototype,"polylineLayer",null),(0,i._)([(0,d.Cb)({type:I.Z})],G.prototype,"spatialReference",void 0),(0,i._)([(0,u.r)(["web-map","portal-item"],"spatialReference",["layers"])],G.prototype,"readSpatialReference",null),(0,i._)([(0,d.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],G.prototype,"sublayers",void 0),(0,i._)([(0,u.r)("web-map","sublayers",["layers"])],G.prototype,"readSublayers",null),(0,i._)([(0,h.c)("web-map","sublayers")],G.prototype,"writeSublayers",null),(0,i._)([(0,d.Cb)({readOnly:!0})],G.prototype,"textLayer",null),(0,i._)([(0,d.Cb)()],G.prototype,"title",void 0),(0,i._)([(0,d.Cb)({readOnly:!0,json:{read:!1}})],G.prototype,"type",void 0),G=(0,i._)([(0,m.j)("esri.layers.MapNotesLayer")],G);const z=G},25820:(e,t,o)=>{o.d(t,{S:()=>l,X:()=>i});const i=1;function l(e,t){let o=0;for(const i of t){const t=i.attributes?.[e];"number"==typeof t&&isFinite(t)&&(o=Math.max(o,t))}return o}}}]);
//# sourceMappingURL=3847.199d52db.chunk.js.map