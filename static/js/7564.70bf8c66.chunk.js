"use strict";(globalThis.webpackChunkimaps_app=globalThis.webpackChunkimaps_app||[]).push([[7564],{17564:(e,t,l)=>{l.r(t),l.d(t,{Layers:()=>f,default:()=>h});var i=l(85580),n=l(72791),r=l(36279),a=l(40281),o=l(9676),s=l(35387),d=l(1250),c=l(80184);const u=(0,n.lazy)((()=>l.e(516).then(l.bind(l,50516))));function p(e,t){return new Promise(((l,i)=>{(function(e){return new Promise(((t,l)=>{const i=new r.Z({portalItem:{id:"95092428774c4b1fb6a3b6f5fed9fbc4"}});i.load().then((()=>{e.map.allLayers.filter((e=>"group"===e.type)).toArray().forEach((e=>{const t=i.allLayers.find((t=>"group"===t.type&&t.title===e.title));e.addMany(t.layers.filter((t=>void 0===e.findLayerById(t.id))).toArray())})),t(!0)}))}))})(t).then((()=>{const i=new s.Z({view:t,container:e,listItemCreatedFunction:b});i.on("trigger-action",(e=>{"Property"===e.item.layer.title&&y(e)})),l(i)}))}))}const y=e=>{if("Property"===e.item.layer.title){t=e.item.layer,(l=e.item.actionsSections).length>1&&((e,t)=>{const l=e.renderer.clone();t?(l.symbol.outline.color.r=0,l.symbol.outline.color.g=0,l.symbol.outline.color.b=0):(l.symbol.outline.color.r=255,l.symbol.outline.color.g=255,l.symbol.outline.color.b=255),e.renderer=l})(t,!l.getItemAt(1).getItemAt(0).value),e.item.layer.labelsVisible||(e.item.layer.labelsVisible=!0);const i=e.item.actionsSections.getItemAt(0).filter((e=>e.value)).map((e=>e.title)),n=m.filter((e=>i.includes(e.title))),r=n.map((e=>e.expression)),a=r.join("+ TextFormatting.NewLine+");e.item.layer.labelingInfo=[],e.item.layer.labelingInfo=[{symbol:{type:"text",color:"black",haloColor:"white",haloSize:1,font:{family:"AvenirNext LT Pro Regular",style:"normal",weight:"bold"}},labelExpressionInfo:{expression:a},maxScale:0,minScale:5e3}]}var t,l},m=[{expression:"First(Split($feature['SITE_ADDRESS'], ' '))",title:"Address"},{expression:"$feature['PIN_NUM']",title:"PIN"},{expression:"$feature['REID']",title:"REID"},{expression:'When(IsEmpty($feature["SALE_DATE"]),null, Concatenate(Month($feature["SALE_DATE"])+1, \'/\',Day($feature["SALE_DATE"]), \'/\',Year($feature["SALE_DATE"])))',title:"Sale Date"},{expression:"Text($feature.TOTSALPRICE,'$#,###')",title:"Sale Price"}],v=e=>{if(e.visible&&!e.panel&&"group"!==e.layer.type&&void 0!==e.layer.type){const t=document.createElement("slider-container");(0,d.createRoot)(t).render((0,c.jsx)(n.Suspense,{fallback:"",children:(0,c.jsx)(u,{value:e.layer.opacity,layer:e.layer})})),e.panel={content:[t,"legend"],open:!1}}},b=e=>{const t=e.item;v(t),t.open=t.layer.visible,t.layer.watch("visible",(e=>{t.open=e,v(t),e&&(t.layer.parent&&"group"===t.layer.parent.type&&(t.layer.parent.visible=!0),t.layer.parent.parent&&"group"===t.layer.parent.parent.type&&(t.layer.parent.parent.visible=!0))})),(e=>{if("Property"===e.layer.title&&"group"!==e.layer.type&&0===e.actionsSections.length){let t=new a.Z;t.addMany(m.map((t=>{var l;return new o.Z({value:null===(l=e.layer.labelingInfo)||void 0===l?void 0:l.find((l=>{var i;return(null===(i=l.labelExpressionInfo)||void 0===i?void 0:i.expression.includes(t.expression))&&e.layer.labelsVisible})),title:t.title,visible:!0})}))),e.actionsSections.push(t),t=new a.Z,t.add(new o.Z({value:e.layer.renderer.symbol.outline.color.isBright,title:"Light Outline",visible:!0})),e.actionsSections.push(t),e.actionsOpen=!0,setTimeout((()=>{const e=document.createElement("h4");e.id="labels-actions-title",e.textContent="Labels",e.setAttribute("style","padding: 0.5em;margin: 0;");const t=document.querySelector(".esri-layer-list__item-actions");null!==t&&void 0!==t&&t.parentElement&&!document.getElementById("labels-actions-title")&&t.prepend(e)}),500)}})(t)},f=e=>{const t=(0,n.useRef)(),l=(0,n.useRef)(!1),[r,a]=(0,n.useState)(),[o,s]=(0,n.useState)(!0),[d,u]=(0,n.useState)(!1);(0,n.useEffect)((()=>(l.current||(l.current=!0,p(t.current,e.view).then((e=>{a(e),e.when((()=>{s(!1)}))}))),()=>{r&&(null===r||void 0===r||r.destroy())})),[]),(0,n.useEffect)((()=>{u(e.isActive)}),[e.isActive]);const y=(0,n.useCallback)((t=>{e.panelDismissed()}),[]);return(0,c.jsx)(i.N$,{id:"layers-panel",heading:"Layers",hidden:!d,closed:!d||void 0,dismissed:!d||void 0,dismissible:!0,onCalcitePanelDismiss:y,children:(0,c.jsxs)("div",{className:"layers",children:[r&&(0,c.jsxs)("div",{className:"row sticky",children:[(0,c.jsx)(i.e,{clearable:!0,placeholder:"Filter by layer name",scale:"m",onCalciteInputInput:e=>{r&&((e,t)=>{e||(e=""),t.operationalItems.forEach((l=>{if("group"===l.layer.type){let u=!1;var i,n,r,a,o,s,d,c;l.layer.layers.forEach((t=>{t.title.toLowerCase().includes(e.toLowerCase())?(t.listMode="show",u=!0):t.listMode="hide","group"===t.type&&t.layers.forEach((l=>{l.title.toLowerCase().includes(e.toLowerCase())?(t.listMode="show",l.listMode="show",u=!0):l.listMode="hide"}))})),l.open=e.length>0&&u,(!e.length||u)&&(null===(i=document.getElementById(`${t.id}_${l.uid}__title`))||void 0===i||null===(n=i.parentElement)||void 0===n||null===(r=n.parentElement)||void 0===r||null===(a=r.parentElement)||void 0===a||a.removeAttribute("hidden")),u||null===(o=document.getElementById(`${t.id}_${l.uid}__title`))||void 0===o||null===(s=o.parentElement)||void 0===s||null===(d=s.parentElement)||void 0===d||null===(c=d.parentElement)||void 0===c||c.setAttribute("hidden","")}}))})(e.target.value,r)}}),(0,c.jsx)(i.G1,{text:"clear",icon:"viewHide",scale:"s",onClick:()=>{var e;(null===(e=r)||void 0===e?void 0:e.view.map.allLayers.filter((e=>"group"===e.type))).forEach((e=>{e.visible="Property"===e.title,e.layers.forEach((e=>{e.visible="Property"===e.title}))}))}})]}),(0,c.jsx)("div",{ref:t}),(0,c.jsx)(i.Ed,{loading:!0,hidden:!o||void 0})]})})},h=f}}]);
//# sourceMappingURL=7564.70bf8c66.chunk.js.map