"use strict";(globalThis.webpackChunkimaps_app=globalThis.webpackChunkimaps_app||[]).push([[1722],{21722:(e,t,i)=>{i.r(t),i.d(t,{Measure:()=>W,default:()=>S});var s=i(85580),a=i(72791),r=i(27366),n=(i(93169),i(66978)),l=i(94172),o=i(8025),d=(i(63780),i(25243),i(49861)),c=i(69912),u=i(69407),v=i(85015),h=i(68860),w=i(77671);let g=class extends v.Z{constructor(e){super(e),this.activeTool=null,this.activeViewModel=null,this.view=null}get areaUnit(){return this.defaultUnit}set areaUnit(e){void 0!==e?this._override("areaUnit",e):this._clearOverride("areaUnit")}get linearUnit(){return this.defaultUnit}set linearUnit(e){void 0!==e?this._override("linearUnit",e):this._clearOverride("linearUnit")}get state(){const{activeViewModel:e}=this;return e?e.state:"disabled"}};(0,r._)([(0,d.Cb)({type:["area","distance","direct-line"]})],g.prototype,"activeTool",void 0),(0,r._)([(0,d.Cb)()],g.prototype,"activeViewModel",void 0),(0,r._)([(0,d.Cb)({type:h.fN})],g.prototype,"areaUnit",null),(0,r._)([(0,d.Cb)(w.Y)],g.prototype,"defaultUnit",void 0),(0,r._)([(0,d.Cb)({type:h.oD})],g.prototype,"linearUnit",null),(0,r._)([(0,d.Cb)({readOnly:!0})],g.prototype,"state",null),(0,r._)([(0,d.Cb)()],g.prototype,"view",void 0),g=(0,r._)([(0,c.j)("esri.widgets.Measurement.MeasurementViewModel")],g);const p=g;i(80975);var _=i(80532),m=i(67005);const y="esri-measurement",U="esri-icon-measure";let b=class extends u.Z{constructor(e,t){super(e,t),this._widgets=new Map,this.activeTool=null,this.activeWidget=null,this.areaUnit=null,this.iconClass=U,this.label=void 0,this.linearUnit=null,this.messages=null,this.view=null,this.viewModel=new p}initialize(){this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel),this.view&&this.activeTool&&this._getActiveWidget().then((e=>{this._set("activeWidget",e)})),this.own([(0,l.YP)((()=>[this.view,this.activeTool]),(async()=>{this._set("activeWidget",await this._getActiveWidget())})),(0,l.YP)((()=>this.activeWidget),((e,t)=>{this.viewModel.set("activeViewModel",e?e.viewModel:null),t&&(t.visible=!1)})),(0,l.YP)((()=>[this.areaUnit,this.linearUnit,this.uiStrings]),(()=>this._updateSubWidgetProperties()))])}destroy(){this._destroyWidgets()}render(){const{activeWidget:e}=this,t=e&&!e.destroyed?e.render():null;return(0,m.u)("div",{class:y},t)}clear(){this.activeTool=null,this._destroyWidgets()}startMeasurement(){const{activeViewModel:e}=this.viewModel;e&&(0,n.R8)(e.start())}async _createWidget(e){const{areaUnit:t,linearUnit:s,view:a}=this;switch(e){case"area":{const{type:s}=a;switch(s){case"2d":return new(0,(await Promise.all([i.e(9058),i.e(5652),i.e(5710),i.e(1129),i.e(8431),i.e(370),i.e(5180),i.e(1421)]).then(i.bind(i,41421))).default)({view:a,unit:t,uiStrings:this._createUIStringsForWidget(e)});case"3d":return new(0,(await Promise.all([i.e(1378),i.e(9058),i.e(5652),i.e(5158),i.e(5710),i.e(2618),i.e(5269),i.e(4567),i.e(2110),i.e(3882),i.e(6211)]).then(i.bind(i,96211))).default)({view:a,unit:t,uiStrings:this._createUIStringsForWidget(e)});default:return null}}case"distance":return new(0,(await Promise.all([i.e(9058),i.e(5652),i.e(5710),i.e(1129),i.e(8431),i.e(370),i.e(5180),i.e(5107)]).then(i.bind(i,35107))).default)({view:a,unit:s,uiStrings:this._createUIStringsForWidget(e)});case"direct-line":return new(0,(await Promise.all([i.e(1378),i.e(9058),i.e(5652),i.e(5158),i.e(5710),i.e(2618),i.e(5269),i.e(4567),i.e(2110),i.e(3882),i.e(7899)]).then(i.bind(i,47899))).default)({view:a,unit:s,uiStrings:this._createUIStringsForWidget(e)});default:return null}}_destroyWidgets(){this._widgets.forEach((e=>e.destroy())),this._widgets.clear()}async _getActiveWidget(){const{activeTool:e,view:t}=this;if(!t||!e)return null;let i=null;if(this._widgets.has(e))i=this._widgets.get(e),i.visible=!0;else{if(i=await this._createWidget(e),!i)return null;await i.viewModel.start(),this._widgets.set(e,i)}return i}_createUIStringsForWidget(e){if(!this.uiStrings)return null;const t=e+"-"+this.view.type;return this.uiStrings[t]}_updateSubWidgetProperties(){this._widgets.forEach(((e,t)=>{const{areaUnit:i,linearUnit:s}=this;e.unit=function(e){return e&&("esri.widgets.AreaMeasurement2D"===e.declaredClass||"esri.widgets.AreaMeasurement3D"===e.declaredClass)}(e)?i:s,e.uiStrings=this._createUIStringsForWidget(t)}))}};(0,r._)([(0,o.B)("viewModel.activeTool")],b.prototype,"activeTool",void 0),(0,r._)([(0,d.Cb)({readOnly:!0})],b.prototype,"activeWidget",void 0),(0,r._)([(0,o.B)("viewModel.areaUnit")],b.prototype,"areaUnit",void 0),(0,r._)([(0,d.Cb)()],b.prototype,"iconClass",void 0),(0,r._)([(0,d.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],b.prototype,"label",void 0),(0,r._)([(0,o.B)("viewModel.linearUnit")],b.prototype,"linearUnit",void 0),(0,r._)([(0,d.Cb)(),(0,_.H)("esri/widgets/Measurement/t9n/Measurement")],b.prototype,"messages",void 0),(0,r._)([(0,d.Cb)()],b.prototype,"uiStrings",void 0),(0,r._)([(0,o.B)("viewModel.view")],b.prototype,"view",void 0),(0,r._)([(0,d.Cb)({type:p})],b.prototype,"viewModel",void 0),b=(0,r._)([(0,c.j)("esri.widgets.Measurement")],b);const M=b;var f=i(9283),C=i(80184);const W=e=>{const t=(0,a.useRef)(),i=(0,a.useRef)(!1),[r,n]=(0,a.useState)(""),[l,o]=(0,a.useState)(!1),[d,c]=(0,a.useState)();(0,a.useEffect)((()=>{if(!i.current){i.current=!0;const r=(s=t.current,a=e.view,new M({view:a,container:s,areaUnit:"imperial",linearUnit:"imperial"}));c(r),r.watch("activeTool",(e=>{n(e||""),null===d||void 0===d||d.clear()}))}var s,a;return()=>{d&&(null===d||void 0===d||d.destroy())}}),[]),(0,a.useEffect)((()=>{o(e.isActive)}),[e.isActive]);const u=(0,a.useCallback)((t=>{e.toolDismissed(),d.activeTool=null,null===d||void 0===d||d.clear()}),[]);return(0,C.jsxs)(s.N$,{id:"measure-panel",heading:"Measure","data-panel":"measure",hidden:!l,closed:!l||void 0,dismissed:!l||void 0,dismissible:!0,onCalcitePanelDismiss:u,children:[(0,C.jsx)(s.G1,{icon:"chevron-up",text:"",slot:"header-actions-end",onClick:f.F$}),(0,C.jsxs)("div",{id:"measure-tools",children:[(0,C.jsxs)("div",{className:"measure-container",children:[(0,C.jsx)(s.G1,{icon:"measure-line",text:"Distance",active:"distance"===r||void 0,onClick:()=>{n("distance"),d&&(d.activeTool="distance")}}),(0,C.jsx)(s.G1,{icon:"measure-area",text:"Area",active:"area"===r||void 0,onClick:()=>{n("area"),d&&(d.activeTool="area")}}),(0,C.jsx)(s.G1,{icon:"trash",text:"Clear",onClick:()=>{d&&(d.clear(),n(""))}})]}),(0,C.jsx)("div",{ref:t}),(0,C.jsx)("section",{hidden:""!==r||void 0,className:"measurement-hint",children:(0,C.jsx)("p",{children:"Select line or distance measurement tool"})})]})]})},S=a.memo(W)},77671:(e,t,i)=>{i.d(t,{Y:()=>a});var s=i(68860);const a={readOnly:!0,get(){return(0,s.RG)(this.view)}}}}]);
//# sourceMappingURL=1722.d2d4bd77.chunk.js.map