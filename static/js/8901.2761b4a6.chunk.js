"use strict";(globalThis.webpackChunkimaps_app=globalThis.webpackChunkimaps_app||[]).push([[8901],{80573:(e,t,s)=>{s.d(t,{Z:()=>d});var i=s(27366),r=s(85015),n=s(11582),a=s(79056),o=s(46784),l=s(92026),c=s(49861),h=(s(63780),s(93169),s(25243),s(69912));let _=0,u=class extends((0,o.eC)((0,n.J)((0,a.IG)(r.Z)))){constructor(e){super(e),this.id=`${Date.now().toString(16)}-analysis-${_++}`,this.title=null}get parent(){return this._get("parent")}set parent(e){const t=this.parent;if((0,l.pC)(t))switch(t.type){case"line-of-sight":t.removeAnalysis(this);break;case"2d":case"3d":t.analyses.includes(this)&&t.analyses.remove(this)}this._set("parent",e)}get isEditable(){return this.requiredPropertiesForEditing.every(l.pC)}};(0,i._)([(0,c.Cb)({type:String,constructOnly:!0,clonable:!1})],u.prototype,"id",void 0),(0,i._)([(0,c.Cb)({type:String})],u.prototype,"title",void 0),(0,i._)([(0,c.Cb)({constructOnly:!0})],u.prototype,"type",void 0),(0,i._)([(0,c.Cb)({clonable:!1,value:null})],u.prototype,"parent",null),(0,i._)([(0,c.Cb)({readOnly:!0})],u.prototype,"extent",void 0),(0,i._)([(0,c.Cb)({readOnly:!0})],u.prototype,"isEditable",null),(0,i._)([(0,c.Cb)({readOnly:!0})],u.prototype,"requiredPropertiesForEditing",void 0),(0,i._)([(0,c.Cb)({readOnly:!0})],u.prototype,"nonEditableMessage",void 0),u=(0,i._)([(0,h.j)("esri.analysis.Analysis")],u);const d=u},48681:(e,t,s)=>{s.d(t,{y1:()=>a});s(11186);var i=s(71353),r=(s(2170),s(80885)),n=(s(79803),s(78952));s(15559),s(80064);function a(e){return"mouse"!==e.pointerType||0===e.button}const o=(0,i.c)(),l=(0,i.c)(),c=(0,i.c)();new r.Z({rings:[[o,l,c]],spatialReference:n.Z.WGS84}),(0,i.c)()},92382:(e,t,s)=>{s.d(t,{G:()=>r,e:()=>i});class i{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.screenPoint=e,this.result=t}}class r{constructor(e,t){this.scenePoint=e,this.mapPoint=t}}},86509:(e,t,s)=>{s.d(t,{f:()=>l});var i=s(27366),r=s(94172),n=s(49861),a=(s(63780),s(93169),s(25243),s(69912)),o=s(45900);let l=class extends o.m{constructor(e){super(e)}initialize(){this.own((0,r.YP)((()=>this.analysisViewData.visible),(e=>this.visible=e),r.tX))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};(0,i._)([(0,n.Cb)({constructOnly:!0})],l.prototype,"analysis",void 0),(0,i._)([(0,n.Cb)()],l.prototype,"analysisViewData",void 0),l=(0,i._)([(0,a.j)("esri.views.interactive.AnalysisToolBase")],l)},44070:(e,t,s)=>{s.d(t,{f:()=>_});var i=s(63780),r=s(32718),n=s(92026),a=s(18722),o=s(37825),l=s(49800),c=s(8548);const h=r.Z.getLogger("esri.views.webgl.BufferObject");class _{constructor(e,t,s,i){this._context=e,this.bufferType=t,this.usage=s,this._glName=null,this._size=-1,this._indexType=void 0,e.instanceCounter.increment(c._g.BufferObject,this),this._glName=this._context.gl.createBuffer(),(0,o.zu)(this._context.gl),i&&this.setData(i)}static createIndex(e,t,s){return new _(e,c.w0.ELEMENT_ARRAY_BUFFER,t,s)}static createVertex(e,t,s){return new _(e,c.w0.ARRAY_BUFFER,t,s)}static createUniform(e,t,s){if(e.type!==l.zO.WEBGL2)throw new Error("Uniform buffers are supported in WebGL2 only!");return new _(e,c.w0.UNIFORM_BUFFER,t,s)}static createPixelPack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.l1.STREAM_READ,s=arguments.length>2?arguments[2]:void 0;if(e.type!==l.zO.WEBGL2)throw new Error("Pixel pack buffers are supported in WebGL2 only!");const i=new _(e,c.w0.PIXEL_PACK_BUFFER,t);return s&&i.setSize(s),i}static createPixelUnpack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.l1.STREAM_DRAW,s=arguments.length>2?arguments[2]:void 0;if(e.type!==l.zO.WEBGL2)throw new Error("Pixel unpack buffers are supported in WebGL2 only!");return new _(e,c.w0.PIXEL_UNPACK_BUFFER,t,s)}get glName(){return this._glName}get size(){return this._size}get indexType(){return this._indexType}get byteSize(){return this.bufferType===c.w0.ELEMENT_ARRAY_BUFFER?this._indexType===c.g.UNSIGNED_INT?4*this._size:2*this._size:this._size}get _isVAOAware(){return this.bufferType===c.w0.ELEMENT_ARRAY_BUFFER||this.bufferType===c.w0.ARRAY_BUFFER}dispose(){this._context?.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(c._g.BufferObject,this),this._context=null):this._glName&&h.warn("Leaked WebGL buffer object")}setSize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e<=0&&h.error("Buffer size needs to be positive!"),this.bufferType===c.w0.ELEMENT_ARRAY_BUFFER&&(0,n.pC)(t))switch(this._indexType=t,t){case c.g.UNSIGNED_SHORT:e*=2;break;case c.g.UNSIGNED_INT:e*=4}this._setBufferData(e)}setData(e){if(!e)return;let t=e.byteLength;this.bufferType===c.w0.ELEMENT_ARRAY_BUFFER&&((0,a.Uc)(e)&&(t/=2,this._indexType=c.g.UNSIGNED_SHORT),(0,a.ZY)(e)&&(t/=4,this._indexType=c.g.UNSIGNED_INT)),this._setBufferData(t,e)}_setBufferData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._size=e;const s=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const i=this._context.gl;(0,n.pC)(t)?i.bufferData(this.bufferType,t,this.usage):i.bufferData(this.bufferType,e,this.usage),(0,o.zu)(i),this._isVAOAware&&this._context.bindVAO(s)}setSubData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.byteLength;if(!e)return;(t<0||t>=this._size)&&h.error("offset is out of range!");let r=t,n=s,l=i,_=e.byteLength;this.bufferType===c.w0.ELEMENT_ARRAY_BUFFER&&((0,a.Uc)(e)?(_/=2,r*=2,n*=2,l*=2):(0,a.ZY)(e)&&(_/=4,r*=4,n*=4,l*=4)),void 0===i&&(i=_-1),s>=i&&h.error("end must be bigger than start!"),t+s-i>this._size&&h.error("An attempt to write beyond the end of the buffer!");const u=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const d=this._context.gl,f=ArrayBuffer.isView(e)?e.buffer:e,p=0===n&&l===e.byteLength?f:f.slice(n,l);d.bufferSubData(this.bufferType,r,p),(0,o.zu)(d),this._isVAOAware&&this._context.bindVAO(u)}setSubDataFromView(e,t,s,i){if(!e)return;(t<0||t>=this._size)&&h.error("offset is out of range!"),s>=i&&h.error("end must be bigger than start!"),t+s-i>this._size&&h.error("An attempt to write beyond the end of the buffer!");const r=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const n=this._context.gl;if(this._context.type===l.zO.WEBGL2)n.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,e,s,i-s);else{const r=0===s&&i===e.length?e:e.subarray(s,i);n.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,r)}(0,o.zu)(n),this._isVAOAware&&this._context.bindVAO(r)}getSubData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this._context.type!==l.zO.WEBGL2)return void h.error("Get buffer subdata is supported in WebGL2 only!");if(s<0||r<0)return void h.error("Problem getting subdata: offset and length were less than zero!");const n=function(e){return(0,i.zG)(e)}(e)?e.BYTES_PER_ELEMENT:1;if(n*((s??0)+(r??0))>e.byteLength)return void h.error("Problem getting subdata: offset and length exceeded destination size!");t+n*(r??0)>this.byteSize&&h.warn("Potential problem getting subdata: requested data exceeds buffer size!");const a=this._context.gl;this._context.bindBuffer(this,c.w0.COPY_READ_BUFFER),a.getBufferSubData(c.w0.COPY_READ_BUFFER,t,e,s,r),this._context.unbindBuffer(c.w0.COPY_READ_BUFFER)}async getSubDataAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;this._context.type===l.zO.WEBGL2?(await this._context.clientWaitAsync(),this.getSubData(e,t,s,i)):h.error("Get buffer subdata is supported in WebGL2 only!")}}},3384:(e,t,s)=>{s.d(t,{HH:()=>n,RG:()=>c,UF:()=>l,XP:()=>o,_V:()=>a,un:()=>h});s(93169);var i=s(92026),r=s(8548);function n(e){const t=e.gl;switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case t.INVALID_VALUE:return"A numeric argument is out of range";case t.INVALID_OPERATION:return"The specified command is not allowed for the current state";case t.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case t.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case t.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function a(e,t){return e.vertexBuffers[t].size/function(e){return e[0].stride}(e.layout[t])}function o(e,t,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const n=e.gl,a=e.capabilities.instancing;e.bindBuffer(s);for(const o of i){const e=t.get(o.name);void 0===e&&console.error(`There is no location for vertex attribute '${o.name}' defined.`);const s=r*o.stride;if(o.count<=4)n.vertexAttribPointer(e,o.count,o.type,o.normalized,o.stride,o.offset+s),n.enableVertexAttribArray(e),o.divisor>0&&a&&a.vertexAttribDivisor(e,o.divisor);else if(9===o.count)for(let t=0;t<3;t++)n.vertexAttribPointer(e+t,3,o.type,o.normalized,o.stride,o.offset+12*t+s),n.enableVertexAttribArray(e+t),o.divisor>0&&a&&a.vertexAttribDivisor(e+t,o.divisor);else if(16===o.count)for(let t=0;t<4;t++)n.vertexAttribPointer(e+t,4,o.type,o.normalized,o.stride,o.offset+16*t+s),n.enableVertexAttribArray(e+t),o.divisor>0&&a&&a.vertexAttribDivisor(e+t,o.divisor);else console.error("Unsupported vertex attribute element count: "+o.count)}}function l(e,t,s,i){const n=e.gl,a=e.capabilities.instancing;e.bindBuffer(s);for(const r of i){const e=t.get(r.name);if(r.count<=4)n.disableVertexAttribArray(e),r.divisor&&r.divisor>0&&a&&a.vertexAttribDivisor(e,0);else if(9===r.count)for(let t=0;t<3;t++)n.disableVertexAttribArray(e+t),r.divisor&&r.divisor>0&&a&&a.vertexAttribDivisor(e+t,0);else if(16===r.count)for(let t=0;t<4;t++)n.disableVertexAttribArray(e+t),r.divisor&&r.divisor>0&&a&&a.vertexAttribDivisor(e+t,0);else console.error("Unsupported vertex attribute element count: "+r.count)}e.unbindBuffer(r.w0.ARRAY_BUFFER)}function c(e){switch(e){case r.VI.ALPHA:case r.VI.LUMINANCE:case r.VI.RED:case r.VI.RED_INTEGER:case r.lP.R8:case r.lP.R8I:case r.lP.R8UI:case r.lP.R8_SNORM:case r.Tg.STENCIL_INDEX8:return 1;case r.VI.LUMINANCE_ALPHA:case r.VI.RG:case r.VI.RG_INTEGER:case r.lP.RGBA4:case r.lP.R16F:case r.lP.R16I:case r.lP.R16UI:case r.lP.RG8:case r.lP.RG8I:case r.lP.RG8UI:case r.lP.RG8_SNORM:case r.lP.RGB565:case r.lP.RGB5_A1:case r.Tg.DEPTH_COMPONENT16:return 2;case r.VI.DEPTH_COMPONENT:case r.VI.RGB:case r.VI.RGB_INTEGER:case r.lP.RGB8:case r.lP.RGB8I:case r.lP.RGB8UI:case r.lP.RGB8_SNORM:case r.lP.SRGB8:case r.Tg.DEPTH_COMPONENT24:return 3;case r.VI.DEPTH_STENCIL:case r.VI.RGBA:case r.VI.RGBA_INTEGER:case r.lP.RGBA8:case r.lP.R32F:case r.lP.R11F_G11F_B10F:case r.lP.RG16F:case r.lP.R32I:case r.lP.R32UI:case r.lP.RG16I:case r.lP.RG16UI:case r.lP.RGBA8I:case r.lP.RGBA8UI:case r.lP.RGBA8_SNORM:case r.lP.SRGB8_ALPHA8:case r.lP.RGB9_E5:case r.lP.RGB10_A2UI:case r.lP.RGB10_A2:case r.Tg.DEPTH_STENCIL:case r.Tg.DEPTH_COMPONENT32F:case r.Tg.DEPTH24_STENCIL8:return 4;case r.Tg.DEPTH32F_STENCIL8:return 5;case r.lP.RGB16F:case r.lP.RGB16I:case r.lP.RGB16UI:return 6;case r.lP.RG32F:case r.lP.RG32I:case r.lP.RG32UI:case r.lP.RGBA16F:case r.lP.RGBA16I:case r.lP.RGBA16UI:return 8;case r.lP.RGB32F:case r.lP.RGB32I:case r.lP.RGB32UI:return 12;case r.lP.RGBA32F:case r.lP.RGBA32I:case r.lP.RGBA32UI:return 16;case r.q_.COMPRESSED_RGB_S3TC_DXT1_EXT:case r.q_.COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case r.q_.COMPRESSED_RGBA_S3TC_DXT3_EXT:case r.q_.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case r.q_.COMPRESSED_R11_EAC:case r.q_.COMPRESSED_SIGNED_R11_EAC:case r.q_.COMPRESSED_RGB8_ETC2:case r.q_.COMPRESSED_SRGB8_ETC2:case r.q_.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case r.q_.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;case r.q_.COMPRESSED_RG11_EAC:case r.q_.COMPRESSED_SIGNED_RG11_EAC:case r.q_.COMPRESSED_RGBA8_ETC2_EAC:case r.q_.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}function h(e){if((0,i.Wi)(e))return 0;if("descriptor"in e)return e.glName?h(e.descriptor):0;const t=e.internalFormat||"pixelFormat"in e&&e.pixelFormat;if(!t)return 0;const s="hasMipmap"in e&&e.hasMipmap?1.3:1,r=e.width*e.height;return c(t)*r*s}},45412:(e,t,s)=>{s.d(t,{U:()=>l});var i=s(32718),r=s(92026),n=s(8548),a=s(3384);const o=i.Z.getLogger("esri.views.webgl.VertexArrayObject");class l{constructor(e,t,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._context=e,this._locations=t,this._layout=s,this._buffers=i,this._indexBuffer=r,this._glName=null,this._initialized=!1,e.instanceCounter.increment(n._g.VertexArrayObject,this)}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get size(){return Object.keys(this._buffers).reduce(((e,t)=>e+this._buffers[t].size),(0,r.pC)(this._indexBuffer)?this._indexBuffer.size:0)}get layout(){return this._layout}get locations(){return this._locations}dispose(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._context){if(this._glName){const e=this._context?.capabilities?.vao;e?(e.deleteVertexArray(this._glName),this._glName=null):o.warn("Leaked WebGL VAO")}if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),e){for(const e in this._buffers)this._buffers[e].dispose(),delete this._buffers[e];this._indexBuffer=(0,r.O3)(this._indexBuffer)}this._context.instanceCounter.decrement(n._g.VertexArrayObject,this),this._context=null}else(this._glName||e&&Object.getOwnPropertyNames(this._buffers).length>0)&&o.warn("Leaked WebGL VAO")}initialize(){if(this._initialized)return;const e=this._context.capabilities.vao;if(e){const t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t}this._initialized=!0}bind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}_bindLayout(){const{_buffers:e,_layout:t,_indexBuffer:s}=this;e||o.error("Vertex buffer dictionary is empty!");const i=this._context.gl;for(const r in e){const s=e[r];s||o.error("Vertex buffer is uninitialized!");const i=t[r];i||o.error("Vertex element descriptor is empty!"),(0,a.XP)(this._context,this._locations,s,i)}(0,r.pC)(s)&&(this._context.capabilities.vao?i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,s.glName):this._context.bindBuffer(s))}unbind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(null):this._unbindLayout()}_unbindLayout(){const{_buffers:e,_layout:t}=this;e||o.error("Vertex buffer dictionary is empty!");for(const s in e){const i=e[s];i||o.error("Vertex buffer is uninitialized!");const r=t[s];(0,a.UF)(this._context,this._locations,i,r)}(0,r.pC)(this._indexBuffer)&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}},40085:(e,t,s)=>{s.d(t,{O:()=>u});var i,r=s(27366),n=s(100),a=s(92026),o=s(66978),l=s(94172),c=s(49861),h=(s(63780),s(93169),s(25243),s(69912)),_=s(32845);!function(e){e[e.PENDING=0]="PENDING",e[e.WAIT_FOR_VIEW_READY=1]="WAIT_FOR_VIEW_READY",e[e.RUNNING=2]="RUNNING"}(i||(i={}));let u=class extends _.V{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.analysisView=null,this._reconnectViewTask=null,this._analysisBaseHandles=new n.Z,this._parentChangeFromReconnect=!1,this._startUserOperation=null;const t=e?.analysis;(0,a.pC)(t)?this.analysis=t:(this._set("analysis",this.constructAnalysis()),this._set("isAnalysisOwner",!0))}normalizeCtorArgs(e){const{analysis:t,...s}=e;return s}initialize(){this._analysisBaseHandles.add([(0,l.YP)((()=>(0,a.yw)(this.analysis,(e=>{let{parent:t}=e;return t}))),(e=>{this._parentChangeFromReconnect||e===this.view||this._set("isAnalysisOwner",!1);const t=!this._parentChangeFromReconnect;this._parentChangeFromReconnect=!1,t&&this._scheduleViewReconnect()}),l.Z_),(0,l.YP)((()=>({view:this.view,ready:(0,a.pC)(this.view)&&this.view.ready,supported:this.supported})),((e,t)=>{let{view:s}=e,{view:i}=t;s!==i&&(this._startUserOperation=(0,a.IM)(this._startUserOperation),this._disconnectFromView(i)),this._scheduleViewReconnect()}),l.tX),(0,l.YP)((()=>this.analysis.isEditable),((e,t)=>{(0,a.Wi)(this.analysisView)||(e&&!t&&(0,a.Wi)(this.tool)?this.createTool():!e&&t&&(0,a.pC)(this.tool)&&!this.tool.active&&this.removeTool())}))])}destroy(){this._analysisBaseHandles=(0,a.SC)(this._analysisBaseHandles),this._reconnectViewTask=(0,a.IM)(this._reconnectViewTask),this._startUserOperation=(0,a.IM)(this._startUserOperation),(0,a.pC)(this.analysisView)&&(this.analysisView.visible=void 0),this._disconnectFromView(this.view),(0,a.pC)(this.analysis)&&this.isAnalysisOwner&&(this.analysis.destroy(),this._set("analysis",null))}set analysis(e){e!==this._get("analysis")&&(this._startUserOperation=(0,a.IM)(this._startUserOperation),this._disconnectFromView(this.view),this._setExternalAnalysis(e),this._scheduleViewReconnect())}get ready(){return(0,a.pC)(this.analysisView)&&!this.connectingToView}get connectingToView(){return(0,a.pC)(this._reconnectViewTask)}get isAnalysisOwner(){return this._get("isAnalysisOwner")}set visible(e){this._set("visible",e),(0,a.pC)(this.analysisView)&&(this.analysisView.visible=e)}async start(){this.clear();const e={task:null,abort:null,state:i.PENDING},t=(0,o.vr)((async t=>{e.state=i.WAIT_FOR_VIEW_READY,await(0,l.N1)((()=>this.ready),t),e.state=i.RUNNING,this.createTool({interactive:!0})}));return e.task=t,e.abort=()=>t.abort(),this._startUserOperation=e,t.promise}clear(){this._startUserOperation=(0,a.IM)(this._startUserOperation),this.removeTool(),this.analysis.clear()}onConnectToAnalysisView(e){}onDisconnectFromAnalysisView(){}_scheduleViewReconnect(){this._reconnectViewTask=(0,a.IM)(this._reconnectViewTask);const e=(0,o.vr)((async t=>{try{await this._reconnectView(t)}catch(s){if((0,o.k_)(t),!(0,o.D_)(s))return void this.logger.warn("Failed to use analysis in view model",s);throw s}finally{e===this._reconnectViewTask&&(this._reconnectViewTask=null)}}));this._reconnectViewTask=e}async _reconnectView(e){const{view:t}=this,s=(0,a.pC)(t)&&t.ready&&this.supported,i=this.analysis;if(this._startUserOperation=d(this._startUserOperation),this._disconnectFromView(t),s&&!(0,a.Wi)(t)&&!(0,a.Wi)(i)){if(this.isAnalysisOwner){if((0,a.pC)(i.parent))return void this.logError("expected owned analysis to have null parent when connecting to view");this._parentChangeFromReconnect=!0,t.analyses.add(i)}this.analysisView=await t.whenAnalysisView(i),(0,o.Hc)(e)?this._startUserOperation=d(this._startUserOperation):(this.analysisView.visible=this.visible,this.onConnectToAnalysisView(this.analysisView),this.createTool())}}_disconnectFromView(e){this.removeTool(),(0,a.pC)(e)&&this.isAnalysisOwner&&(this._parentChangeFromReconnect=!0,e.analyses.remove(this.analysis),this.analysis.clear()),this.analysisView=null,this.onDisconnectFromAnalysisView()}_setExternalAnalysis(e){if((0,a.pC)(this.analysisView)&&!this.isAnalysisOwner&&(this.analysisView.visible=!0),this.analysisView=null,this._set("isAnalysisOwner",!1),this._set("analysis",e),this._parentChangeFromReconnect=!1,!e.isEditable){const t=e.nonEditableMessage;this.logger.warn(`The assigned ${e.type} analysis object will not be editable in the view. ${t}`)}}get testInfo(){return{analysisView:this.analysisView}}};function d(e){return(0,a.pC)(e)&&e.state>=i.RUNNING?(e.abort(),null):e}(0,r._)([(0,c.Cb)({nonNullable:!0})],u.prototype,"analysis",null),(0,r._)([(0,c.Cb)()],u.prototype,"analysisView",void 0),(0,r._)([(0,c.Cb)()],u.prototype,"ready",null),(0,r._)([(0,c.Cb)()],u.prototype,"connectingToView",null),(0,r._)([(0,c.Cb)({readOnly:!0})],u.prototype,"isAnalysisOwner",null),(0,r._)([(0,c.Cb)({type:Boolean,value:!0})],u.prototype,"visible",null),(0,r._)([(0,c.Cb)()],u.prototype,"_reconnectViewTask",void 0),u=(0,r._)([(0,h.j)("esri.widgets.support.InteractiveAnalysisViewModel")],u)},32845:(e,t,s)=>{s.d(t,{V:()=>_});var i=s(27366),r=s(85015),n=s(100),a=s(32718),o=s(92026),l=s(94172),c=s(49861),h=(s(63780),s(93169),s(25243),s(69912));let _=class extends r.Z{constructor(e){super(e),this.tool=null,this._baseHandles=new n.Z,this._loggedUnsupportedErrorOnce=!1,this.logger=a.Z.getLogger(this.declaredClass),e&&null!=e.visible&&(this.visible=e.visible)}initialize(){this._baseHandles.add((0,l.YP)((()=>({ready:(0,o.pC)(this.view)&&this.view.ready,supported:this.supported})),(e=>{let{ready:t,supported:s}=e;!t||s||this._loggedUnsupportedErrorOnce||(this.logError(this.unsupportedErrorMessage),this._loggedUnsupportedErrorOnce=!0)}),l.tX))}destroy(){this.removeTool(),this.view=null,this._baseHandles=(0,o.SC)(this._baseHandles)}get supported(){return(0,o.Wi)(this.view)||this.view.type===this.supportedViewType}get view(){return this._get("view")}set view(e){if(e===this.view)return;this.removeTool(),this._set("view",e);const t="tools";this._baseHandles.remove(t),(0,o.Wi)(e)||this._baseHandles.add(e.tools.on("after-remove",(e=>{e.item===this.tool&&this._set("tool",null)})),t)}set visible(e){this._set("visible",e),(0,o.pC)(this.tool)&&(this.tool.visible=e)}get active(){return(0,o.pC)(this.tool)&&this.tool.active}get disabled(){return(0,o.Wi)(this.view)||!this.view.ready||!this.supported}createTool(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{interactive:!1};if(this.removeTool(),(0,o.Wi)(this.view)||!this.view.ready||!this.supported)return;const t=this.constructTool();t.created?(this._set("tool",t),this.view.tools.add(t)):e.interactive?(this._set("tool",t),this.view.addAndActivateTool(t),(0,l.gx)((()=>t.created),(()=>{t.active&&(0,o.pC)(this.view)&&(this.view.activeTool=null)}),{initial:!0,once:!0})):t.destroy()}removeTool(){const e=this.tool;if((0,o.Wi)(e))return;const t=(0,o.yw)(this.view,(e=>e.tools));(0,o.pC)(t)?t.remove(e):e.destroy(),this._set("tool",null)}logError(){this.logger.error(...arguments)}};(0,i._)([(0,c.Cb)({constructOnly:!0})],_.prototype,"tool",void 0),(0,i._)([(0,c.Cb)()],_.prototype,"supported",null),(0,i._)([(0,c.Cb)({value:null})],_.prototype,"view",null),(0,i._)([(0,c.Cb)({type:Boolean,value:!0})],_.prototype,"visible",null),(0,i._)([(0,c.Cb)()],_.prototype,"active",null),(0,i._)([(0,c.Cb)()],_.prototype,"disabled",null),_=(0,i._)([(0,h.j)("esri.widgets.support.InteractiveToolViewModel")],_)}}]);
//# sourceMappingURL=8901.2761b4a6.chunk.js.map