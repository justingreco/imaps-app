"use strict";(globalThis.webpackChunkimaps_app=globalThis.webpackChunkimaps_app||[]).push([[8340],{88340:(e,t,o)=>{o.r(t),o.d(t,{Bookmarks:()=>Xe,default:()=>Je});var i=o(72791),s=o(85580),a=o(27366),r=o(98928),n=o(100),d=o(92026),l=o(94172),u=o(8025),k=(o(63780),o(93169),o(89125)),m=o(49861),c=o(69912),h=o(76969),b=o(26838),_=o(69407),p=o(85015);o(25243);let g=class extends p.Z{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}};(0,a._)([(0,m.Cb)()],g.prototype,"bookmark",void 0),(0,a._)([(0,m.Cb)({readOnly:!0})],g.prototype,"editedBookmark",null),(0,a._)([(0,m.Cb)()],g.prototype,"state",null),(0,a._)([(0,m.Cb)()],g.prototype,"validationState",void 0),(0,a._)([(0,m.Cb)()],g.prototype,"loading",void 0),g=(0,a._)([(0,c.j)("esri.widgets.Bookmarks.UserState")],g);const v=g;var B=o(13894),w=o(40281),f=o(10064),E=o(91505),y=o(32718),I=o(2284),S=o(99505);const C="esri.widgets.Bookmarks.BookmarksViewModel",x=y.Z.getLogger(C),A=w.Z.ofType(I.Z),T={width:128,height:128,format:"png"},U={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},M={time:!0};let N=class extends((0,S._)(E.Z.EventedAccessor)){constructor(e){super(e),this.abilities={...M},this.activeBookmark=null}destroy(){this.view=null,this._set("activeBookmark",null)}castAbilities(e){return{...M,...e}}set bookmarks(e){void 0!==e?this._override("bookmarks",e):this._clearOverride("bookmarks")}get bookmarks(){return this.get("view.map.bookmarks")||new A}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...U,...e})}get defaultCreateOptions(){return U}set defaultEditOptions(e){this._set("defaultEditOptions",{...U,...e})}get defaultEditOptions(){return U}get state(){const e=this.get("view");return e&&!e.ready?"loading":"ready"}get view(){return this._get("view")}set view(e){e&&"2d"!==e.type&&x.error(new f.Z("view:invalid-view","SceneView is not supported",{view:e})),this._set("view",e)}async createBookmark(e){const{view:t,defaultCreateOptions:o,abilities:i}=this;if(!t){const e=new f.Z("create-bookmark:invalid-view","Cannot create a bookmark without a view.");throw x.error(e),e}const{takeScreenshot:s,screenshotSettings:a,captureViewpoint:r,captureRotation:n,captureScale:l,captureTimeExtent:u}={...o,...e},k=s?await this._createThumbnail(a):void 0,m=i.time&&u&&(0,d.pC)(t.timeExtent)?t.timeExtent.clone():void 0;return new I.Z({...k&&{thumbnail:k},...u&&{timeExtent:m},...r&&{viewpoint:this._createViewpoint({view:t,captureScale:l,captureRotation:n})}})}async editBookmark(e,t){const{view:o,defaultEditOptions:i}=this;if(!o){const e=new f.Z("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");throw x.error(e),e}const{takeScreenshot:s,screenshotSettings:a,captureViewpoint:r,captureRotation:n,captureScale:l,captureTimeExtent:u}={...i,...t},k=s?await this._createThumbnail(a):void 0;return k&&(e.thumbnail=k),r&&(e.viewpoint=this._createViewpoint({view:o,captureScale:l,captureRotation:n})),u&&(0,d.pC)(o.timeExtent)&&(e.timeExtent=o.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:e}),e}goTo(e){const{abilities:t,view:o}=this;if(!o){const e=new f.Z("go-to:invalid-view","Cannot go to a bookmark without a view");return x.error(e),Promise.reject(e)}const i=e?.viewpoint;if(!i){const t=new f.Z("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:e});return x.error(t),Promise.reject(t)}this._set("activeBookmark",e);const s={target:i},a=this.callGoTo(s),r=e?.timeExtent;return t.time&&r&&(o.timeExtent=r),this.emit("bookmark-select",{bookmark:e}),a.catch((()=>{})).then((()=>this._set("activeBookmark",null))),a}async _createThumbnail(e){const t=await this.view.takeScreenshot({...T,...e});return new b.A({url:t.dataUrl})}_createViewpoint(e){let{view:t,captureRotation:o,captureScale:i}=e;const s=t.viewpoint?.clone();return new B.Z({targetGeometry:t.extent?.clone(),rotation:o&&s?.rotation||0,scale:i&&s?.scale||0})}};(0,a._)([(0,m.Cb)()],N.prototype,"abilities",void 0),(0,a._)([(0,k.p)("abilities")],N.prototype,"castAbilities",null),(0,a._)([(0,m.Cb)({readOnly:!0})],N.prototype,"activeBookmark",void 0),(0,a._)([(0,m.Cb)({type:A})],N.prototype,"bookmarks",null),(0,a._)([(0,m.Cb)()],N.prototype,"defaultCreateOptions",null),(0,a._)([(0,m.Cb)()],N.prototype,"defaultEditOptions",null),(0,a._)([(0,m.Cb)({readOnly:!0})],N.prototype,"state",null),(0,a._)([(0,m.Cb)({value:null})],N.prototype,"view",null),N=(0,a._)([(0,c.j)(C)],N);const O=N;var R=o(70098),Z=o(61524),D=o(96919),H=o(80975),F=o(80532),P=o(93531),L=o(67005),V=o(70281);const q="data-bookmark-uid",j="esri-bookmarks esri-widget--panel",z="esri-bookmarks__loader-container",$="esri-bookmarks__loader",G="esri-bookmarks__list",K="esri-bookmarks__list--sortable",Y="esri-bookmarks__bookmark",W="esri-bookmarks__bookmark-button",X="esri-bookmarks__bookmark-image-container",J="esri-bookmarks__bookmark-edit-button-container",Q="esri-bookmarks__bookmark-edit-button",ee="esri-bookmarks_bookmark-drag-handle",te="esri-bookmarks_bookmark-drag-handle-icon",oe="esri-bookmarks__bookmark-icon",ie="esri-bookmarks__image",se="esri-bookmarks__bookmark-label",ae="esri-bookmarks__bookmark-name",re="esri-bookmarks__bookmark-time-extent",ne="esri-bookmarks__bookmark--active",de="esri-widget__content--empty",le="esri-bookmarks__no-bookmarks-heading",ue="esri-widget__no-bookmark-icon",ke="esri-bookmarks__no-bookmarks-description",me="esri-bookmarks__adding-bookmark",ce="esri-bookmarks__add-bookmark",he="esri-bookmarks__add-bookmark-button",be="esri-bookmarks__add-bookmark-icon",_e="esri-bookmarks__authoring-card",pe="esri-bookmarks__authoring-container",ge="esri-bookmarks__authoring-form",ve="esri-bookmarks__authoring-label",Be="esri-bookmarks__authoring-actions",we="esri-bookmarks__authoring-input--invalid",fe="esri-bookmarks__authoring-delete-button",Ee="esri-bookmarks__authoring-cancel-button",ye="esri-bookmarks__time-extent-container",Ie="esri-bookmarks__time-extent",Se="esri-bookmarks__time-extent-group",Ce="esri-bookmarks__time-extent-date",xe="esri-bookmarks__time-extent-time",Ae="esri-widget",Te="esri-widget--disabled",Ue="esri-button",Me="esri-button--tertiary",Ne="esri-input",Oe="esri-icon-handle-vertical",Re="esri-icon-plus",Ze="esri-icon-edit",De="esri-icon-handle-horizontal",He="esri-icon-refresh",Fe="esri-icon-link",Pe="esri-icon-erase",Le="esri-icon-bookmark",Ve="esri-widget__heading",qe="esri-icon-loading-indicator",je="esri-rotating",ze={addBookmark:!0,thumbnail:!0,time:!0},$e=/^https:\/\/.*/i;let Ge=class extends _.Z{constructor(e,t){super(e,t),this._handles=new n.Z,this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._addBookmarkButtonNode=null,this._focusAddBookmarkButton=!1,this._focusEditInputBox=!1,this._focusAddInputBox=!1,this._focusUrlEditInputBox=!1,this._sortable=null,this._sortableNode=null,this._focusSortUid=null,this._selectedSortUid=null,this._sortableSavedItems=null,this._editIncludeTimeExtent=null,this._userState=null,this.defaultCreateOptions=null,this.defaultEditOptions=null,this.bookmarks=null,this.disabled=!1,this.editingEnabled=!1,this.headingLevel=2,this.goToOverride=null,this.iconClass=Le,this.label=void 0,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.view=null,this.viewModel=new O,this.visibleElements={...ze}}initialize(){this.own([(0,l.YP)((()=>this.viewModel?.bookmarks),(()=>this._bookmarksInitialized()),l.nn),(0,l.YP)((()=>this.editingEnabled),(()=>this._toggleSorting()),l.nn)])}destroy(){this._destroySortable(),this._handles.destroy(),this._handles=null,this._editMenu.destroy()}loadDependencies(){return Promise.all([o.e(1507).then(o.bind(o,51507)),o.e(9093).then(o.bind(o,69093))])}get _editMenuItems(){const{messages:e,_userState:t}=this,o=t?.editedBookmark?.thumbnail?.url;return[new Z.Z({label:e?.menu.refreshThumbnail,iconClass:He,clickFunction:()=>this._refreshThumbnail()}),new Z.Z({label:$e.test(o)?e?.menu.editImageUrl:e?.menu.useImageUrl,iconClass:Fe,clickFunction:()=>this._startUseImageUrl()}),o?new Z.Z({label:e?.menu.removeThumbnail,iconClass:Pe,clickFunction:()=>this._removeThumbnail()}):null].filter(Boolean)}get _editMenu(){const{_editMenuItems:e,messages:t,disabled:o}=this,i=this._get("_editMenu");i&&i.destroy();const s=new R.Z({disabled:o,iconClass:De,label:t?.menu.label});return s.items=e,s}castVisibleElements(e){return{...ze,...e}}endAddBookmark(){this._userState=null}goTo(e){return this.viewModel.goTo(e)}render(){const{state:e}=this.viewModel,t="loading"===e?this.renderLoading():this.renderBookmarks();return(0,L.u)("div",{class:this.classes(j,Ae,{[Te]:this.disabled})},t)}startAddBookmark(){this._userState=new v({state:"add"}),this._focusAddInputBox=!0,this.scheduleRender()}renderLoading(){return(0,L.u)("div",{class:z,key:"loader",tabIndex:this.disabled?-1:null},(0,L.u)("div",{class:$}))}renderNoBookmarksContainer(){const{messages:e,disabled:t}=this;return(0,L.u)("div",{class:de,key:"no-bookmarks",tabIndex:t?-1:null},(0,L.u)("span",{"aria-hidden":"true",class:this.classes(ue,Le)}),(0,L.u)(D.X6,{level:this.headingLevel,class:this.classes(Ve,le)},e?.noBookmarksHeading),(0,L.u)("p",{class:ke},e?.noBookmarksDescription))}renderAddBookmarkLoading(){return(0,L.u)("div",{key:"adding-bookmark",class:me},(0,L.u)("span",{"aria-hidden":"true",class:this.classes(qe,je)}),this.messages?.addingBookmark)}renderBookmarkItems(e){if(!e)return null;const{_userState:t,editingEnabled:o}=this;return e.map((e=>o&&e&&t&&("edit"===t.state||"edit-thumbnail"===t.state)&&t.bookmark===e?"edit-thumbnail"===t.state?this.renderEditingBookmarkUrl(t.editedBookmark):this.renderEditingBookmark(t.editedBookmark):this.renderBookmark(e))).toArray()}renderBookmarksContainer(e){const{_userState:t,editingEnabled:o,disabled:i}=this,s="add"===t?.state,a=o&&!s?this.renderAddBookmarkButton():null,r=o?s&&t.loading?this.renderAddBookmarkLoading():"add"===t?.state?this.renderAddingBookmark():null:null;return[(0,L.u)("ul",{key:"bookmark-list","aria-label":this.messages?.widgetLabel,class:this.classes(G,{[K]:this.editingEnabled}),afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"data-node-ref":"_sortableNode",bind:this,tabIndex:i?-1:null},this.renderBookmarkItems(e)),a,r]}renderAddBookmarkButton(){return this.visibleElements.addBookmark?(0,L.u)("div",{key:"add-bookmark-item",class:ce},(0,L.u)("button",{class:this.classes(Ue,Me,he),disabled:this.disabled,onclick:this.startAddBookmark,afterCreate:this._storeAddBookmarkButton,afterUpdate:this._storeAddBookmarkButton,"data-node-ref":"_addBookmarkButtonNode",bind:this,type:"button"},(0,L.u)("span",{"aria-hidden":"true",class:this.classes(be,Re)}),this.messages?.addBookmark)):null}renderBookmarks(){const{bookmarks:e}=this.viewModel,t=e&&e.filter(Boolean),o=t&&t.length,i=o||this.editingEnabled?this.renderBookmarksContainer(t):null;return[o?null:this.renderNoBookmarksContainer(),i]}renderEditContainer(e){const{messagesCommon:t,disabled:o}=this;return(0,L.u)("div",{class:J,key:"edit-container"},(0,L.u)("button",{disabled:o,title:t?.edit,"aria-label":t?.edit,"data-bookmark":e,onclick:this._showEditBookmarkForm,bind:this,class:Q,type:"button"},(0,L.u)("span",{"aria-hidden":"true",class:Ze})))}renderDragHandle(e){const{messagesCommon:t,disabled:o}=this,i={[q]:e.uid};return(0,L.u)("div",{role:"button",tabIndex:o?-1:0,key:"drag-handle",bind:this,class:ee,onkeydown:this._dragHandleKeydown,afterCreate:this._focusDragHandle,afterUpdate:this._focusDragHandle,onblur:this._dragHandleBlur,"aria-pressed":this._selectedSortUid===e.uid?"true":"false","aria-label":t?.dragHandleLabel,title:t?.dragHandleTitle,...i},(0,L.u)("span",{"aria-hidden":"true",class:this.classes(te,Oe)}))}renderBookmarkImageIcon(){return(0,L.u)("span",{"aria-hidden":"true",class:this.classes(oe,Le)})}renderBookmarkImage(e){const{visibleElements:t}=this,{thumbnail:o}=e,i=o&&o.url||"";return t.thumbnail&&i?(0,L.u)("img",{src:i,alt:"",class:ie}):null}renderBookmarkTimeSwitch(e){const{messages:t,disabled:o}=this,{timeExtent:i}=e,{view:s}=this.viewModel;return s.timeExtent||i?(0,L.u)("calcite-label",{layout:"inline-space-between","disable-spacing":"true"},t.includeTimeExtent,(0,L.u)("calcite-switch",{scale:"s",disabled:o,checked:!!i,onCalciteSwitchChange:e=>this._editIncludeTimeExtent=!!e.detail.switched})):null}renderBookmarkTimeExtent(e){const{visibleElements:t}=this,{timeExtent:o}=e;return o?(0,L.u)("span",{class:Ie},[(0,d.pC)(o.start)&&(0,L.u)("span",{key:"start-date-group",class:Se},(0,L.u)("span",{key:"start-date",class:Ce},this._formatDate(o.start)),t.time&&(0,L.u)("span",{key:"start-time",class:xe},this._formatTime(o.start))),(0,d.pC)(o.end)&&((0,d.Wi)(o.start)||o.start.getTime()!==o.end.getTime())&&(0,L.u)("span",{key:"end-date-group",class:Se},(0,L.u)("span",{key:"end-date",class:Ce},this._formatDate(o.end)),t.time&&(0,L.u)("span",{key:"end-time",class:xe},this._formatTime(o.end)))]):null}renderBookmarkButton(e){const{messagesCommon:t,disabled:o}=this,{name:i,timeExtent:s}=e,{abilities:a}=this.viewModel,r=i||t?.untitled,n=(0,L.u)("div",{class:X},this.renderBookmarkImage(e)||this.renderBookmarkImageIcon()),d=a.time&&s?(0,L.u)("span",{key:"time-extent",class:re},this.renderBookmarkTimeExtent(e)):null;return(0,L.u)("button",{disabled:o,key:"bookmark-button",class:W,bind:this,"data-bookmark":e,onclick:this._goToBookmark,type:"button"},n,(0,L.u)("div",{class:se},(0,L.u)("span",{key:"bookmark-title",class:ae},r),d))}renderBookmark(e){const{activeBookmark:t}=this.viewModel,o={[ne]:t===e},i=this.editingEnabled?this.renderEditContainer(e):null,s={[q]:e.uid},a=this.editingEnabled?this.renderDragHandle(e):null;return(0,L.u)("li",{key:e,class:this.classes(Y,o),...s},a,this.renderBookmarkButton(e),i)}renderEditingBookmarkName(e){const{messages:t,_userState:o,disabled:i}=this,s="name-required"===o.validationState;return(0,L.u)("label",{class:ve},t?.title,s?(0,L.u)("strong",null,t?.invalidTitle):null,(0,L.u)("input",{required:!0,disabled:i,bind:this,class:this.classes(Ne,s?we:null),type:"text",value:e.name,afterCreate:this._storeEditInput,afterUpdate:this._focusEditInput,"data-bookmark":e,"data-node-ref":"_editInputNode",placeholder:t?.titlePlaceholder}))}renderEditingBookmarkUrlActions(){const{messagesCommon:e,disabled:t}=this;return(0,L.u)("div",{class:Be},(0,L.u)("input",{type:"button",disabled:t,value:e?.back,class:this.classes(Ue,Me),onclick:this._closeUrlEditBookmarkForm,bind:this}),(0,L.u)("input",{class:Ue,disabled:t,type:"submit",value:e?.add}))}renderEditingBookmarkActions(){const{messagesCommon:e,disabled:t}=this,{bookmark:o}=this._userState;return(0,L.u)("div",{class:Be},(0,L.u)("input",{type:"button",disabled:t,value:e?.delete,class:this.classes(Ue,Me,fe),"data-bookmark":o,onclick:this._deleteBookmark,bind:this}),(0,L.u)("input",{disabled:t,type:"button",value:e?.cancel,class:this.classes(Ue,Me),onclick:this._closeEditBookmarkForm,bind:this}),(0,L.u)("input",{class:Ue,disabled:t,type:"submit",value:e?.save}))}renderEditingBookmarkUrlInput(e){const{messages:t,_userState:o,disabled:i}=this,s=e.thumbnail?.url,a=$e.test(s)?s:null,r="absolute-url-required"===o.validationState;return(0,L.u)("label",{class:ve},r?(0,L.u)("strong",null,t?.invalidImageUrl):null,(0,L.u)("input",{required:!0,disabled:i,bind:this,class:this.classes(Ne,r?we:null),type:"text",value:a,afterCreate:this._storeUrlEditInput,afterUpdate:this._focusUrlEditInput,"data-bookmark":e,"data-node-ref":"_urlEditInputNode",title:t?.imageUrlTooltip,placeholder:t&&`https://<${t.imageUrlPlaceholder}>`}))}renderEditingBookmarkUrl(e){const t={[q]:e.uid};return(0,L.u)("li",{key:"edit-bookmark-url-form",class:_e,...t},(0,L.u)("form",{class:ge,disabled:this.disabled,onsubmit:this._editBookmarkUrlSubmit,bind:this},this.renderEditingBookmarkUrlInput(e),this.renderEditingBookmarkUrlActions()))}renderEditingBookmark(e){const t={[q]:e.uid},{abilities:o}=this.viewModel,i=o.time?(0,L.u)("div",{key:"edit-bookmark-time-container",class:ye},this.renderBookmarkTimeSwitch(e),this._editIncludeTimeExtent&&this.renderBookmarkTimeExtent(e)):null;return(0,L.u)("li",{key:"edit-bookmark-form",class:_e,...t},(0,L.u)("form",{class:ge,disabled:this.disabled,onsubmit:this._editBookmarkSubmit,bind:this},(0,L.u)("div",{class:pe},(0,L.u)("div",{class:X},this.renderBookmarkImage(e),this._editMenu.render()),this.renderEditingBookmarkName(e)),i,this.renderEditingBookmarkActions()))}renderAddingBookmarkName(){const{_userState:e,messages:t,disabled:o}=this,i="name-required"===e.validationState;return(0,L.u)("label",{class:ve},t?.title,i?(0,L.u)("strong",null,t?.invalidTitle):null,(0,L.u)("input",{required:!0,disabled:o,bind:this,class:this.classes(Ne,i?we:null),type:"text",afterCreate:this._storeAddInput,afterUpdate:this._focusAddInput,"data-node-ref":"_addInputNode",value:"",placeholder:t?.titlePlaceholder}))}renderAddingBookmarkActions(){const{messagesCommon:e,disabled:t}=this;return(0,L.u)("div",{class:this.classes(Be)},(0,L.u)("input",{type:"button",disabled:t,value:e?.cancel,class:this.classes(Ue,Me,Ee),onclick:this._endAddBookmark.bind(this),bind:this}),(0,L.u)("input",{class:Ue,disabled:t,type:"submit",value:e?.add}))}renderAddingBookmark(){return(0,L.u)("div",{key:"add-bookmark-form",class:_e},(0,L.u)("form",{class:ge,onsubmit:this._addBookmarkSubmit,bind:this},this.renderAddingBookmarkName(),this.renderAddingBookmarkActions()))}_formatDate(e){return e?(0,h.p6)(e,(0,h.Ze)("short-date")):null}_formatTime(e){return e?(0,h.p6)(e,(0,h.Ze)("long-time")):null}_dragHandleBlur(){this._selectedSortUid=null,this.scheduleRender()}_dragHandleKeydown(e){const{_sortableSavedItems:t}=this,o=(0,r.kK)(e);if(!["ArrowDown","ArrowUp","Escape","Tab"," ","Enter"].includes(o))return;const{_sortable:i,_selectedSortUid:s}=this,a=i.toArray(),n=e.target.getAttribute(q),d=a.indexOf(n);if((0,H.pf)(o)){const e=s&&s===n;return this._selectedSortUid=e?null:n,this._sortableSavedItems=e?null:this._sortable.toArray(),void this.scheduleRender()}if("Tab"===o)return this._selectedSortUid=null,void this.scheduleRender();if("Escape"===o&&t)return e.stopPropagation(),this._selectedSortUid=null,this._updateSortItems(t,i,n),void this.scheduleRender();if(-1===d||!s)return;const l="ArrowUp"===o?d-1:d+1;l>=a.length||l<=-1||(function(e,t,o){e.splice(o,0,e.splice(t,1)[0])}(a,d,l),this._updateSortItems(a,i,n))}_updateSortItems(e,t,o){t.sort(e),this._sortBookmarks(t),this._focusSortUid=o,this._selectedSortUid=o}_focusDragHandle(e){const{_focusSortUid:t}=this;e&&t&&e.getAttribute(q)===t&&(e.focus(),this._focusSortUid=null)}_toggleSorting(){const{_sortable:e,_sortableNode:t,editingEnabled:o,disabled:i}=this;if(t)if(e)e.option("disabled",i||!o);else{const e=V.ZP.create(t,{dataIdAttr:q,handle:`.${ee}`,group:"bookmarks",disabled:i||!o,onSort:()=>this._sortBookmarks(e)});this._sortable=e}}_sortNodeCreated(e){this._sortableNode=e,this._toggleSorting()}_sortBookmarks(e){const{bookmarks:t}=this.viewModel;if(!t)return;const o=e.toArray();t.sort(((e,t)=>{const i=o.indexOf(e.uid),s=o.indexOf(t.uid);return i>s?1:i<s?-1:0}))}_destroySortable(){const{_sortable:e}=this;e&&e.destroy(),this._sortable=null}_endAddBookmark(){this._focusAddBookmarkButton=!0,this.endAddBookmark()}_bookmarksInitialized(){const e="bookmarks-init",{_handles:t}=this;t.remove(e),t.add((0,l.on)((()=>this.viewModel?.bookmarks),"change",(()=>this._bookmarksChanged())),e)}_bookmarksChanged(){const e="bookmarks-change",{bookmarks:t}=this.viewModel,{_handles:o}=this;o.remove(e);const i=t.map((e=>(0,l.YP)((()=>[e?.name,e?.thumbnail?.url]),(()=>this.scheduleRender()))));o.add(i,e),this.scheduleRender()}_showEditBookmarkForm(e){const t=e.currentTarget["data-bookmark"];this._editIncludeTimeExtent=!!t.timeExtent,this._focusEditInputBox=!0,this._userState=new v({bookmark:t,state:"edit"}),this.viewModel.goTo(t),this.scheduleRender()}_closeUrlEditBookmarkForm(){this._focusEditInputBox=!0,this._userState.state="edit"}_closeEditBookmarkForm(){this._userState=null}_addBookmarkSubmit(e){e.preventDefault();const{_addInputNode:t,_userState:o}=this,i=t&&t.value.trim();i?(o.loading=!0,this.viewModel.createBookmark().then((e=>{e.name=i,this.viewModel.bookmarks.add(e),this._endAddBookmark()}))):o.validationState="name-required"}async _editBookmarkAndClose(e,t){const{viewModel:o}=this;await o.editBookmark(e,{...o.defaultEditOptions,...t}),this._closeEditBookmarkForm()}_editBookmarkSubmit(e){e.preventDefault();const{_editInputNode:t,_userState:o,_editIncludeTimeExtent:i}=this,s=t&&t.value.trim();s?(o.bookmark.name=s,o.bookmark.thumbnail=o.editedBookmark.thumbnail,i||(o.bookmark.timeExtent=null),this._editBookmarkAndClose(o.bookmark,{takeScreenshot:!1,captureTimeExtent:i})):o.validationState="name-required"}_storeAddBookmarkButton(e){this._addBookmarkButtonNode=e,this._focusAddBookmark()}_storeEditInput(e){this._editInputNode=e,this._focusEditInput()}_storeAddInput(e){this._addInputNode=e,this._focusAddInput()}_storeUrlEditInput(e){this._urlEditInputNode=e,this._focusUrlEditInput()}_focusUrlEditInput(){this._urlEditInputNode&&this._focusUrlEditInputBox&&(this._focusUrlEditInputBox=!1,this._urlEditInputNode.focus())}_focusAddInput(){this._addInputNode&&this._focusAddInputBox&&(this._focusAddInputBox=!1,this._addInputNode.focus())}_focusAddBookmark(){this._addBookmarkButtonNode&&this._focusAddBookmarkButton&&(this._focusAddBookmarkButton=!1,this._addBookmarkButtonNode.focus())}_focusEditInput(){this._editInputNode&&this._focusEditInputBox&&(this._focusEditInputBox=!1,this._editInputNode.focus())}_deleteBookmark(e){const t=e.currentTarget["data-bookmark"];this.viewModel.bookmarks.remove(t)}_goToBookmark(e){const t=e.currentTarget["data-bookmark"];this.endAddBookmark(),this._closeEditBookmarkForm(),this.viewModel.goTo(t)}async _refreshThumbnail(){const{_userState:e,_editMenu:t,viewModel:o}=this;e.validationState=void 0,await o.editBookmark(this._userState.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}),t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_removeThumbnail(){const{_userState:e,_editMenu:t}=this;e.editedBookmark.thumbnail=null,e.validationState=void 0,t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_startUseImageUrl(){this._userState.state="edit-thumbnail",this._editMenu.open=!1,this._focusUrlEditInputBox=!0,this.scheduleRender()}_editBookmarkUrlSubmit(e){e.preventDefault();const{_urlEditInputNode:t,_userState:o}=this,i=t.value;$e.test(i)?(i&&(o.editedBookmark.thumbnail=new b.A({url:i})),this._closeUrlEditBookmarkForm()):o.validationState="absolute-url-required"}};(0,a._)([(0,m.Cb)()],Ge.prototype,"_editIncludeTimeExtent",void 0),(0,a._)([(0,m.Cb)({type:v})],Ge.prototype,"_userState",void 0),(0,a._)([(0,m.Cb)({readOnly:!0})],Ge.prototype,"_editMenuItems",null),(0,a._)([(0,m.Cb)({readOnly:!0})],Ge.prototype,"_editMenu",null),(0,a._)([(0,u.B)("viewModel.defaultCreateOptions")],Ge.prototype,"defaultCreateOptions",void 0),(0,a._)([(0,u.B)("viewModel.defaultEditOptions")],Ge.prototype,"defaultEditOptions",void 0),(0,a._)([(0,u.B)("viewModel.bookmarks")],Ge.prototype,"bookmarks",void 0),(0,a._)([(0,m.Cb)()],Ge.prototype,"disabled",void 0),(0,a._)([(0,m.Cb)()],Ge.prototype,"editingEnabled",void 0),(0,a._)([(0,m.Cb)()],Ge.prototype,"headingLevel",void 0),(0,a._)([(0,u.B)("viewModel.goToOverride")],Ge.prototype,"goToOverride",void 0),(0,a._)([(0,m.Cb)()],Ge.prototype,"iconClass",void 0),(0,a._)([(0,m.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Ge.prototype,"label",void 0),(0,a._)([(0,m.Cb)(),(0,F.H)("esri/widgets/Bookmarks/t9n/Bookmarks")],Ge.prototype,"messages",void 0),(0,a._)([(0,m.Cb)(),(0,F.H)("esri/t9n/common")],Ge.prototype,"messagesCommon",void 0),(0,a._)([(0,m.Cb)(),(0,F.H)("esri/core/t9n/Units")],Ge.prototype,"messagesUnits",void 0),(0,a._)([(0,m.Cb)()],Ge.prototype,"uiStrings",void 0),(0,a._)([(0,u.B)("viewModel.view")],Ge.prototype,"view",void 0),(0,a._)([(0,m.Cb)({type:O}),(0,P.s)(["select-bookmark","bookmark-edit","bookmark-select"])],Ge.prototype,"viewModel",void 0),(0,a._)([(0,m.Cb)()],Ge.prototype,"visibleElements",void 0),(0,a._)([(0,k.p)("visibleElements")],Ge.prototype,"castVisibleElements",null),(0,a._)([(0,m.Cb)()],Ge.prototype,"endAddBookmark",null),(0,a._)([(0,m.Cb)()],Ge.prototype,"startAddBookmark",null),Ge=(0,a._)([(0,c.j)("esri.widgets.Bookmarks")],Ge);const Ke=Ge;var Ye=o(9283),We=o(80184);const Xe=e=>{const t=(0,i.useRef)(),o=(0,i.useRef)(!1),[a,r]=(0,i.useState)(),[n,d]=(0,i.useState)(!1);(0,i.useEffect)((()=>{var i,s;return o.current||(o.current=!0,r((i=t.current,s=e.view,new Ke({view:s,container:i,editingEnabled:!0})))),()=>{a&&a.destroy()}}),[]),(0,i.useEffect)((()=>{d(e.isActive)}),[e.isActive]);const l=(0,i.useCallback)((t=>{e.toolDismissed()}),[]);return(0,We.jsxs)(s.N$,{id:"bookmarks-panel",heading:"Bookmarks","data-panel":"bookmarks",hidden:!n,closed:!n||void 0,dismissed:!n||void 0,dismissible:!0,onCalcitePanelDismiss:l,children:[(0,We.jsx)(s.G1,{icon:"chevron-up",text:"",slot:"header-actions-end",onClick:Ye.F$}),(0,We.jsx)("div",{ref:t})]})},Je=i.memo(Xe)}}]);
//# sourceMappingURL=8340.429f4f31.chunk.js.map