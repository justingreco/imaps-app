"use strict";(globalThis.webpackChunkimaps_app=globalThis.webpackChunkimaps_app||[]).push([[8340],{88340:(e,t,o)=>{o.r(t),o.d(t,{Bookmarks:()=>Ge,default:()=>Ke});var i=o(72791),s=o(85580),a=o(27366),r=o(98928),n=o(100),d=o(92026),l=o(94172),u=o(49861),k=(o(63780),o(89125)),m=o(69912),h=o(76969),c=o(26838),b=o(69407),_=o(85015);o(25243);let p=class extends _.Z{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}};(0,a._)([(0,u.Cb)()],p.prototype,"bookmark",void 0),(0,a._)([(0,u.Cb)({readOnly:!0})],p.prototype,"editedBookmark",null),(0,a._)([(0,u.Cb)()],p.prototype,"state",null),(0,a._)([(0,u.Cb)()],p.prototype,"validationState",void 0),(0,a._)([(0,u.Cb)()],p.prototype,"loading",void 0),p=(0,a._)([(0,m.j)("esri.widgets.Bookmarks.UserState")],p);const g=p;var v=o(13894),B=o(40281),f=o(10064),w=o(91505),E=o(2284),y=o(99505);const C=B.Z.ofType(E.Z),I={width:128,height:128,format:"png"},S={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},x={time:!0};let A=class extends((0,y._)(w.Z.EventedAccessor)){constructor(e){super(e),this.abilities={...x},this.activeBookmark=null,this.view=null}destroy(){this.view=null,this._set("activeBookmark",null)}castAbilities(e){return{...x,...e}}get bookmarks(){return this.view?.map?.bookmarks??new C}set bookmarks(e){this._overrideIfSome("bookmarks",e)}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...S,...e})}get defaultCreateOptions(){return S}set defaultEditOptions(e){this._set("defaultEditOptions",{...S,...e})}get defaultEditOptions(){return S}get state(){const e=this.get("view");return e&&!e.ready?"loading":"ready"}async createBookmark(e){const{view:t,defaultCreateOptions:o,abilities:i}=this;if(!t)throw new f.Z("create-bookmark:invalid-view","Cannot create a bookmark without a view.");const{takeScreenshot:s,screenshotSettings:a,captureViewpoint:r,captureRotation:n,captureScale:l,captureTimeExtent:u}={...o,...e},k=s?await this._createThumbnail(a):void 0,m=i.time&&u&&(0,d.pC)(t.timeExtent)?t.timeExtent.clone():void 0;return new E.Z({...k&&{thumbnail:k},...u&&{timeExtent:m},...r&&{viewpoint:this._createViewpoint({view:t,captureScale:l,captureRotation:n})}})}async editBookmark(e,t){const{view:o,defaultEditOptions:i}=this;if(!o)throw new f.Z("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");const{takeScreenshot:s,screenshotSettings:a,captureViewpoint:r,captureRotation:n,captureScale:l,captureTimeExtent:u}={...i,...t},k=s?await this._createThumbnail(a):void 0;return k&&(e.thumbnail=k),r&&(e.viewpoint=this._createViewpoint({view:o,captureScale:l,captureRotation:n})),u&&(0,d.pC)(o.timeExtent)&&(e.timeExtent=o.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:e}),e}goTo(e){const{abilities:t,view:o}=this;if(!o)throw new f.Z("go-to:invalid-view","Cannot go to a bookmark without a view");const i=e?.viewpoint;if(!i)throw new f.Z("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:e});this._set("activeBookmark",e);const s={target:i},a=this.callGoTo(s),r=e?.timeExtent;return t.time&&r&&(o.timeExtent=r),this.emit("bookmark-select",{bookmark:e}),a.catch((()=>{})).then((()=>this._set("activeBookmark",null))),a}async _createThumbnail(e){const t=await this.view.takeScreenshot({...I,...e});return new c.A({url:t.dataUrl})}_createViewpoint(e){let{view:t,captureRotation:o,captureScale:i}=e;const s=t.viewpoint?.clone();return new v.Z({targetGeometry:t.extent?.clone(),rotation:o&&s?.rotation||0,scale:i&&s?.scale||0})}};(0,a._)([(0,u.Cb)()],A.prototype,"abilities",void 0),(0,a._)([(0,k.p)("abilities")],A.prototype,"castAbilities",null),(0,a._)([(0,u.Cb)({readOnly:!0})],A.prototype,"activeBookmark",void 0),(0,a._)([(0,u.Cb)({type:C})],A.prototype,"bookmarks",null),(0,a._)([(0,u.Cb)()],A.prototype,"defaultCreateOptions",null),(0,a._)([(0,u.Cb)()],A.prototype,"defaultEditOptions",null),(0,a._)([(0,u.Cb)({readOnly:!0})],A.prototype,"state",null),(0,a._)([(0,u.Cb)()],A.prototype,"view",void 0),A=(0,a._)([(0,m.j)("esri.widgets.Bookmarks.BookmarksViewModel")],A);const T=A;var U=o(70098),M=o(61524),N=o(96919),O=o(80975),R=o(80532),Z=o(28907),D=o(67005),H=o(70281);const F="data-bookmark-uid",P="esri-bookmarks esri-widget--panel",$="esri-bookmarks__loader-container",V="esri-bookmarks__loader",q="esri-bookmarks__list",L="esri-bookmarks__list--sortable",j="esri-bookmarks__bookmark",z="esri-bookmarks__bookmark-button",G="esri-bookmarks__bookmark-image-container",K="esri-bookmarks__bookmark-edit-button-container",Y="esri-bookmarks__bookmark-edit-button",W="esri-bookmarks_bookmark-drag-handle",X="esri-bookmarks_bookmark-drag-handle-icon",J="esri-bookmarks__bookmark-icon",Q="esri-bookmarks__image",ee="esri-bookmarks__bookmark-label",te="esri-bookmarks__bookmark-name",oe="esri-bookmarks__bookmark-time-extent",ie="esri-bookmarks__bookmark--active",se="esri-widget__content--empty",ae="esri-bookmarks__no-bookmarks-heading",re="esri-widget__no-bookmark-icon",ne="esri-bookmarks__no-bookmarks-description",de="esri-bookmarks__adding-bookmark",le="esri-bookmarks__add-bookmark",ue="esri-bookmarks__add-bookmark-button",ke="esri-bookmarks__add-bookmark-icon",me="esri-bookmarks__authoring-card",he="esri-bookmarks__authoring-container",ce="esri-bookmarks__authoring-form",be="esri-bookmarks__authoring-label",_e="esri-bookmarks__authoring-actions",pe="esri-bookmarks__authoring-input--invalid",ge="esri-bookmarks__authoring-delete-button",ve="esri-bookmarks__authoring-cancel-button",Be="esri-bookmarks__time-extent-container",fe="esri-bookmarks__time-extent",we="esri-bookmarks__time-extent-group",Ee="esri-bookmarks__time-extent-date",ye="esri-bookmarks__time-extent-time",Ce="esri-widget",Ie="esri-widget--disabled",Se="esri-button",xe="esri-button--tertiary",Ae="esri-input",Te="esri-icon-handle-vertical",Ue="esri-icon-plus",Me="esri-icon-edit",Ne="esri-icon-handle-horizontal",Oe="esri-icon-refresh",Re="esri-icon-link",Ze="esri-icon-erase",De="esri-icon-bookmark",He="esri-widget__heading",Fe="esri-icon-loading-indicator",Pe="esri-rotating",$e={addBookmark:!0,thumbnail:!0,time:!0},Ve=/^https:\/\/.*/i;let qe=class extends b.Z{constructor(e,t){super(e,t),this._handles=new n.Z,this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._addBookmarkButtonNode=null,this._focusAddBookmarkButton=!1,this._focusEditInputBox=!1,this._focusAddInputBox=!1,this._focusUrlEditInputBox=!1,this._sortable=null,this._sortableNode=null,this._focusSortUid=null,this._selectedSortUid=null,this._sortableSavedItems=null,this._editIncludeTimeExtent=null,this._userState=null,this.disabled=!1,this.editingEnabled=!1,this.headingLevel=2,this.iconClass=De,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.viewModel=new T,this.visibleElements={...$e}}initialize(){this.addHandles([(0,l.YP)((()=>this.viewModel?.bookmarks),(()=>this._bookmarksInitialized()),l.nn),(0,l.YP)((()=>this.editingEnabled),(()=>this._toggleSorting()),l.nn)])}destroy(){this._destroySortable(),this._handles.destroy(),this._handles=null,this._editMenu.destroy()}loadDependencies(){return Promise.all([Promise.resolve().then(o.bind(o,67777)),Promise.resolve().then(o.bind(o,39754))])}get _editMenuItems(){const{messages:e,_userState:t}=this,o=t?.editedBookmark?.thumbnail?.url;return[new M.Z({label:e?.menu.refreshThumbnail,iconClass:Oe,clickFunction:()=>this._refreshThumbnail()}),new M.Z({label:Ve.test(o)?e?.menu.editImageUrl:e?.menu.useImageUrl,iconClass:Re,clickFunction:()=>this._startUseImageUrl()}),o?new M.Z({label:e?.menu.removeThumbnail,iconClass:Ze,clickFunction:()=>this._removeThumbnail()}):null].filter(Boolean)}get _editMenu(){const{_editMenuItems:e,messages:t,disabled:o}=this,i=this._get("_editMenu");i&&i.destroy();const s=new U.Z({disabled:o,iconClass:Ne,label:t?.menu.label});return s.items=e,s}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(e){this.viewModel.defaultEditOptions=e}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(e){this.viewModel.bookmarks=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...$e,...e}}endAddBookmark(){this._userState=null}goTo(e){return this.viewModel.goTo(e)}render(){const{state:e}=this.viewModel,t="loading"===e?this.renderLoading():this.renderBookmarks();return(0,D.u)("div",{class:this.classes(P,Ce,{[Ie]:this.disabled})},t)}startAddBookmark(){this._userState=new g({state:"add"}),this._focusAddInputBox=!0,this.scheduleRender()}renderLoading(){return(0,D.u)("div",{class:$,key:"loader",tabIndex:this.disabled?-1:null},(0,D.u)("div",{class:V}))}renderNoBookmarksContainer(){const{messages:e,disabled:t}=this;return(0,D.u)("div",{class:se,key:"no-bookmarks",tabIndex:t?-1:null},(0,D.u)("span",{"aria-hidden":"true",class:this.classes(re,De)}),(0,D.u)(N.X6,{level:this.headingLevel,class:this.classes(He,ae)},e?.noBookmarksHeading),(0,D.u)("p",{class:ne},e?.noBookmarksDescription))}renderAddBookmarkLoading(){return(0,D.u)("div",{key:"adding-bookmark",class:de},(0,D.u)("span",{"aria-hidden":"true",class:this.classes(Fe,Pe)}),this.messages?.addingBookmark)}renderBookmarkItems(e){if(!e)return null;const{_userState:t,editingEnabled:o}=this;return e.map((e=>o&&e&&t&&("edit"===t.state||"edit-thumbnail"===t.state)&&t.bookmark===e?"edit-thumbnail"===t.state?this.renderEditingBookmarkUrl(t.editedBookmark):this.renderEditingBookmark(t.editedBookmark):this.renderBookmark(e))).toArray()}renderBookmarksContainer(e){const{_userState:t,editingEnabled:o,disabled:i}=this,s="add"===t?.state,a=o&&!s?this.renderAddBookmarkButton():null,r=o?s&&t.loading?this.renderAddBookmarkLoading():"add"===t?.state?this.renderAddingBookmark():null:null;return[(0,D.u)("ul",{key:"bookmark-list","aria-label":this.messages?.widgetLabel,class:this.classes(q,{[L]:this.editingEnabled}),afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"data-node-ref":"_sortableNode",bind:this,tabIndex:i?-1:null},this.renderBookmarkItems(e)),a,r]}renderAddBookmarkButton(){return this.visibleElements.addBookmark?(0,D.u)("div",{key:"add-bookmark-item",class:le},(0,D.u)("button",{class:this.classes(Se,xe,ue),disabled:this.disabled,onclick:this.startAddBookmark,afterCreate:this._storeAddBookmarkButton,afterUpdate:this._storeAddBookmarkButton,"data-node-ref":"_addBookmarkButtonNode",bind:this,type:"button"},(0,D.u)("span",{"aria-hidden":"true",class:this.classes(ke,Ue)}),this.messages?.addBookmark)):null}renderBookmarks(){const{bookmarks:e}=this.viewModel,t=e&&e.filter(Boolean),o=t&&t.length,i=o||this.editingEnabled?this.renderBookmarksContainer(t):null;return[o?null:this.renderNoBookmarksContainer(),i]}renderEditContainer(e){const{messagesCommon:t,disabled:o}=this,i=this._getBookmarkTitle(e);return(0,D.u)("div",{class:K,key:"edit-container"},(0,D.u)("button",{disabled:o,title:`${t?.edit} ${i}`,"aria-label":`${t?.edit} ${i}`,"data-bookmark":e,onclick:this._showEditBookmarkForm,bind:this,class:Y,type:"button"},(0,D.u)("span",{"aria-hidden":"true",class:Me})))}renderDragHandle(e){const{messagesCommon:t,disabled:o}=this,i=this._getBookmarkTitle(e),s={[F]:e.uid};return(0,D.u)("div",{role:"button",tabIndex:o?-1:0,key:"drag-handle",bind:this,class:W,onkeydown:this._dragHandleKeydown,afterCreate:this._focusDragHandle,afterUpdate:this._focusDragHandle,onblur:this._dragHandleBlur,"aria-pressed":this._selectedSortUid===e.uid?"true":"false","aria-label":`${t?.dragHandleTitle} ${i}`,title:`${t?.dragHandleTitle} ${i}`,...s},(0,D.u)("span",{"aria-hidden":"true",class:this.classes(X,Te)}))}renderBookmarkImageIcon(){return(0,D.u)("span",{"aria-hidden":"true",class:this.classes(J,De)})}renderBookmarkImage(e){const{visibleElements:t}=this,{thumbnail:o}=e,i=o&&o.url||"";return t.thumbnail&&i?(0,D.u)("img",{src:i,alt:"",class:Q}):null}renderBookmarkTimeSwitch(e){const{messages:t,disabled:o}=this,{timeExtent:i}=e,{view:s}=this.viewModel;return s.timeExtent||i?(0,D.u)("calcite-label",{layout:"inline-space-between","disable-spacing":"true"},t.includeTimeExtent,(0,D.u)("calcite-switch",{scale:"s",disabled:o,checked:!!i,onCalciteSwitchChange:e=>this._editIncludeTimeExtent=!!e.detail.switched})):null}renderBookmarkTimeExtent(e){const{visibleElements:t}=this,{timeExtent:o}=e;return o?(0,D.u)("span",{class:fe},[(0,d.pC)(o.start)&&(0,D.u)("span",{key:"start-date-group",class:we},(0,D.u)("span",{key:"start-date",class:Ee},this._formatDate(o.start)),t.time&&(0,D.u)("span",{key:"start-time",class:ye},this._formatTime(o.start))),(0,d.pC)(o.end)&&((0,d.Wi)(o.start)||o.start.getTime()!==o.end.getTime())&&(0,D.u)("span",{key:"end-date-group",class:we},(0,D.u)("span",{key:"end-date",class:Ee},this._formatDate(o.end)),t.time&&(0,D.u)("span",{key:"end-time",class:ye},this._formatTime(o.end)))]):null}renderBookmarkButton(e){const{disabled:t}=this,{timeExtent:o}=e,{abilities:i}=this.viewModel,s=this._getBookmarkTitle(e),a=(0,D.u)("div",{class:G},this.renderBookmarkImage(e)||this.renderBookmarkImageIcon()),r=i.time&&o?(0,D.u)("span",{key:"time-extent",class:oe},this.renderBookmarkTimeExtent(e)):null;return(0,D.u)("button",{disabled:t,key:"bookmark-button",class:z,bind:this,"data-bookmark":e,onclick:this._goToBookmark,type:"button"},a,(0,D.u)("div",{class:ee},(0,D.u)("span",{key:"bookmark-title",class:te},s),r))}renderBookmark(e){const{activeBookmark:t}=this.viewModel,o={[ie]:t===e},i=this.editingEnabled?this.renderEditContainer(e):null,s={[F]:e.uid},a=this.editingEnabled?this.renderDragHandle(e):null;return(0,D.u)("li",{key:e,class:this.classes(j,o),...s},a,this.renderBookmarkButton(e),i)}renderEditingBookmarkName(e){const{messages:t,_userState:o,disabled:i}=this,s="name-required"===o.validationState;return(0,D.u)("label",{class:be},t?.title,s?(0,D.u)("strong",null,t?.invalidTitle):null,(0,D.u)("input",{required:!0,disabled:i,bind:this,class:this.classes(Ae,s?pe:null),type:"text",value:e.name,afterCreate:this._storeEditInput,afterUpdate:this._focusEditInput,"data-bookmark":e,"data-node-ref":"_editInputNode",placeholder:t?.titlePlaceholder}))}renderEditingBookmarkUrlActions(){const{messagesCommon:e,disabled:t}=this;return(0,D.u)("div",{class:_e},(0,D.u)("input",{type:"button",disabled:t,value:e?.back,class:this.classes(Se,xe),onclick:this._closeUrlEditBookmarkForm,bind:this}),(0,D.u)("input",{class:Se,disabled:t,type:"submit",value:e?.add}))}renderEditingBookmarkActions(){const{messagesCommon:e,disabled:t}=this,{bookmark:o}=this._userState;return(0,D.u)("div",{class:_e},(0,D.u)("input",{type:"button",disabled:t,value:e?.delete,class:this.classes(Se,xe,ge),"data-bookmark":o,onclick:this._deleteBookmark,bind:this}),(0,D.u)("input",{disabled:t,type:"button",value:e?.cancel,class:this.classes(Se,xe),onclick:this._closeEditBookmarkForm,bind:this}),(0,D.u)("input",{class:Se,disabled:t,type:"submit",value:e?.save}))}renderEditingBookmarkUrlInput(e){const{messages:t,_userState:o,disabled:i}=this,s=e.thumbnail?.url,a=Ve.test(s)?s:null,r="absolute-url-required"===o.validationState;return(0,D.u)("label",{class:be},r?(0,D.u)("strong",null,t?.invalidImageUrl):null,(0,D.u)("input",{required:!0,disabled:i,bind:this,class:this.classes(Ae,r?pe:null),type:"text",value:a,afterCreate:this._storeUrlEditInput,afterUpdate:this._focusUrlEditInput,"data-bookmark":e,"data-node-ref":"_urlEditInputNode",title:t?.imageUrlTooltip,placeholder:t&&`https://<${t.imageUrlPlaceholder}>`}))}renderEditingBookmarkUrl(e){const t={[F]:e.uid};return(0,D.u)("li",{key:"edit-bookmark-url-form",class:me,...t},(0,D.u)("form",{class:ce,disabled:this.disabled,onsubmit:this._editBookmarkUrlSubmit,bind:this},this.renderEditingBookmarkUrlInput(e),this.renderEditingBookmarkUrlActions()))}renderEditingBookmark(e){const t={[F]:e.uid},{abilities:o}=this.viewModel,i=o.time?(0,D.u)("div",{key:"edit-bookmark-time-container",class:Be},this.renderBookmarkTimeSwitch(e),this._editIncludeTimeExtent&&this.renderBookmarkTimeExtent(e)):null;return(0,D.u)("li",{key:"edit-bookmark-form",class:me,...t},(0,D.u)("form",{class:ce,disabled:this.disabled,onsubmit:this._editBookmarkSubmit,bind:this},(0,D.u)("div",{class:he},(0,D.u)("div",{class:G},this.renderBookmarkImage(e),this._editMenu.render()),this.renderEditingBookmarkName(e)),i,this.renderEditingBookmarkActions()))}renderAddingBookmarkName(){const{_userState:e,messages:t,disabled:o}=this,i="name-required"===e.validationState;return(0,D.u)("label",{class:be},t?.title,i?(0,D.u)("strong",null,t?.invalidTitle):null,(0,D.u)("input",{required:!0,disabled:o,bind:this,class:this.classes(Ae,i?pe:null),type:"text",afterCreate:this._storeAddInput,afterUpdate:this._focusAddInput,"data-node-ref":"_addInputNode",value:"",placeholder:t?.titlePlaceholder}))}renderAddingBookmarkActions(){const{messagesCommon:e,disabled:t}=this;return(0,D.u)("div",{class:this.classes(_e)},(0,D.u)("input",{type:"button",disabled:t,value:e?.cancel,class:this.classes(Se,xe,ve),onclick:this._endAddBookmark.bind(this),bind:this}),(0,D.u)("input",{class:Se,disabled:t,type:"submit",value:e?.add}))}renderAddingBookmark(){return(0,D.u)("div",{key:"add-bookmark-form",class:me},(0,D.u)("form",{class:ce,onsubmit:this._addBookmarkSubmit,bind:this},this.renderAddingBookmarkName(),this.renderAddingBookmarkActions()))}_getBookmarkTitle(e){return e.name||this.messagesCommon?.untitled}_formatDate(e){return e?(0,h.p6)(e,(0,h.Ze)("short-date")):null}_formatTime(e){return e?(0,h.p6)(e,(0,h.Ze)("long-time")):null}_dragHandleBlur(){this._selectedSortUid=null,this.scheduleRender()}_dragHandleKeydown(e){const{_sortableSavedItems:t}=this,o=(0,r.kK)(e);if(!["ArrowDown","ArrowUp","Escape","Tab"," ","Enter"].includes(o))return;const{_sortable:i,_selectedSortUid:s}=this,a=i.toArray(),n=e.target.getAttribute(F),d=a.indexOf(n);if((0,O.pf)(o)){const e=s&&s===n;return this._selectedSortUid=e?null:n,this._sortableSavedItems=e?null:this._sortable.toArray(),void this.scheduleRender()}if("Tab"===o)return this._selectedSortUid=null,void this.scheduleRender();if("Escape"===o&&t)return e.stopPropagation(),this._selectedSortUid=null,this._updateSortItems(t,i,n),void this.scheduleRender();if(-1===d||!s)return;const l="ArrowUp"===o?d-1:d+1;l>=a.length||l<=-1||(function(e,t,o){e.splice(o,0,e.splice(t,1)[0])}(a,d,l),this._updateSortItems(a,i,n))}_updateSortItems(e,t,o){t.sort(e),this._sortBookmarks(t),this._focusSortUid=o,this._selectedSortUid=o}_focusDragHandle(e){const{_focusSortUid:t}=this;e&&t&&e.getAttribute(F)===t&&(e.focus(),this._focusSortUid=null)}_toggleSorting(){const{_sortable:e,_sortableNode:t,editingEnabled:o,disabled:i}=this;if(t)if(e)e.option("disabled",i||!o);else{const e=H.ZP.create(t,{dataIdAttr:F,handle:`.${W}`,group:"bookmarks",disabled:i||!o,onSort:()=>this._sortBookmarks(e)});this._sortable=e}}_sortNodeCreated(e){this._sortableNode=e,this._toggleSorting()}_sortBookmarks(e){const{bookmarks:t}=this.viewModel;if(!t)return;const o=e.toArray();t.sort(((e,t)=>{const i=o.indexOf(e.uid),s=o.indexOf(t.uid);return i>s?1:i<s?-1:0}))}_destroySortable(){const{_sortable:e}=this;e&&e.destroy(),this._sortable=null}_endAddBookmark(){this._focusAddBookmarkButton=!0,this.endAddBookmark()}_bookmarksInitialized(){const e="bookmarks-init",{_handles:t}=this;t.remove(e),t.add((0,l.on)((()=>this.viewModel?.bookmarks),"change",(()=>this._bookmarksChanged())),e)}_bookmarksChanged(){const e="bookmarks-change",{bookmarks:t}=this.viewModel,{_handles:o}=this;o.remove(e);const i=t.map((e=>(0,l.YP)((()=>[e?.name,e?.thumbnail?.url]),(()=>this.scheduleRender()))));o.add(i,e),this.scheduleRender()}_showEditBookmarkForm(e){const t=e.currentTarget["data-bookmark"];this._editIncludeTimeExtent=!!t.timeExtent,this._focusEditInputBox=!0,this._userState=new g({bookmark:t,state:"edit"}),this.viewModel.goTo(t),this.scheduleRender()}_closeUrlEditBookmarkForm(){this._focusEditInputBox=!0,this._userState.state="edit"}_closeEditBookmarkForm(){this._userState=null}_addBookmarkSubmit(e){e.preventDefault();const{_addInputNode:t,_userState:o}=this,i=t&&t.value.trim();i?(o.loading=!0,this.viewModel.createBookmark().then((e=>{e.name=i,this.viewModel.bookmarks.add(e),this._endAddBookmark()}))):o.validationState="name-required"}async _editBookmarkAndClose(e,t){const{viewModel:o}=this;await o.editBookmark(e,{...o.defaultEditOptions,...t}),this._closeEditBookmarkForm()}_editBookmarkSubmit(e){e.preventDefault();const{_editInputNode:t,_userState:o,_editIncludeTimeExtent:i}=this,s=t&&t.value.trim();s?(o.bookmark.name=s,o.bookmark.thumbnail=o.editedBookmark.thumbnail,i||(o.bookmark.timeExtent=null),this._editBookmarkAndClose(o.bookmark,{takeScreenshot:!1,captureTimeExtent:i})):o.validationState="name-required"}_storeAddBookmarkButton(e){this._addBookmarkButtonNode=e,this._focusAddBookmark()}_storeEditInput(e){this._editInputNode=e,this._focusEditInput()}_storeAddInput(e){this._addInputNode=e,this._focusAddInput()}_storeUrlEditInput(e){this._urlEditInputNode=e,this._focusUrlEditInput()}_focusUrlEditInput(){this._urlEditInputNode&&this._focusUrlEditInputBox&&(this._focusUrlEditInputBox=!1,this._urlEditInputNode.focus())}_focusAddInput(){this._addInputNode&&this._focusAddInputBox&&(this._focusAddInputBox=!1,this._addInputNode.focus())}_focusAddBookmark(){this._addBookmarkButtonNode&&this._focusAddBookmarkButton&&(this._focusAddBookmarkButton=!1,this._addBookmarkButtonNode.focus())}_focusEditInput(){this._editInputNode&&this._focusEditInputBox&&(this._focusEditInputBox=!1,this._editInputNode.focus())}_deleteBookmark(e){const t=e.currentTarget["data-bookmark"];this.viewModel.bookmarks.remove(t)}_goToBookmark(e){const t=e.currentTarget["data-bookmark"];this.endAddBookmark(),this._closeEditBookmarkForm(),this.viewModel.goTo(t)}async _refreshThumbnail(){const{_userState:e,_editMenu:t,viewModel:o}=this;e.validationState=void 0,await o.editBookmark(this._userState.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}),t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_removeThumbnail(){const{_userState:e,_editMenu:t}=this;e.editedBookmark.thumbnail=null,e.validationState=void 0,t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_startUseImageUrl(){this._userState.state="edit-thumbnail",this._editMenu.open=!1,this._focusUrlEditInputBox=!0,this.scheduleRender()}_editBookmarkUrlSubmit(e){e.preventDefault();const{_urlEditInputNode:t,_userState:o}=this,i=t.value;Ve.test(i)?(i&&(o.editedBookmark.thumbnail=new c.A({url:i})),this._closeUrlEditBookmarkForm()):o.validationState="absolute-url-required"}};(0,a._)([(0,u.Cb)()],qe.prototype,"_editIncludeTimeExtent",void 0),(0,a._)([(0,u.Cb)({type:g})],qe.prototype,"_userState",void 0),(0,a._)([(0,u.Cb)({readOnly:!0})],qe.prototype,"_editMenuItems",null),(0,a._)([(0,u.Cb)({readOnly:!0})],qe.prototype,"_editMenu",null),(0,a._)([(0,u.Cb)()],qe.prototype,"defaultCreateOptions",null),(0,a._)([(0,u.Cb)()],qe.prototype,"defaultEditOptions",null),(0,a._)([(0,u.Cb)()],qe.prototype,"bookmarks",null),(0,a._)([(0,u.Cb)()],qe.prototype,"disabled",void 0),(0,a._)([(0,u.Cb)()],qe.prototype,"editingEnabled",void 0),(0,a._)([(0,u.Cb)()],qe.prototype,"headingLevel",void 0),(0,a._)([(0,u.Cb)()],qe.prototype,"goToOverride",null),(0,a._)([(0,u.Cb)()],qe.prototype,"iconClass",void 0),(0,a._)([(0,u.Cb)()],qe.prototype,"label",null),(0,a._)([(0,u.Cb)(),(0,R.H)("esri/widgets/Bookmarks/t9n/Bookmarks")],qe.prototype,"messages",void 0),(0,a._)([(0,u.Cb)(),(0,R.H)("esri/t9n/common")],qe.prototype,"messagesCommon",void 0),(0,a._)([(0,u.Cb)(),(0,R.H)("esri/core/t9n/Units")],qe.prototype,"messagesUnits",void 0),(0,a._)([(0,u.Cb)()],qe.prototype,"uiStrings",void 0),(0,a._)([(0,u.Cb)()],qe.prototype,"view",null),(0,a._)([(0,u.Cb)({type:T}),(0,Z.s)(["select-bookmark","bookmark-edit","bookmark-select"])],qe.prototype,"viewModel",void 0),(0,a._)([(0,u.Cb)()],qe.prototype,"visibleElements",void 0),(0,a._)([(0,k.p)("visibleElements")],qe.prototype,"castVisibleElements",null),(0,a._)([(0,u.Cb)()],qe.prototype,"endAddBookmark",null),(0,a._)([(0,u.Cb)()],qe.prototype,"startAddBookmark",null),qe=(0,a._)([(0,m.j)("esri.widgets.Bookmarks")],qe);const Le=qe;var je=o(9283),ze=o(80184);const Ge=e=>{const t=(0,i.useRef)(),o=(0,i.useRef)(!1),[a,r]=(0,i.useState)(),[n,d]=(0,i.useState)(!1);(0,i.useEffect)((()=>{var i,s;return o.current||(o.current=!0,r((i=t.current,s=e.view,new Le({view:s,container:i,editingEnabled:!0})))),()=>{a&&a.destroy()}}),[]),(0,i.useEffect)((()=>{d(e.isActive)}),[e.isActive]);const l=(0,i.useCallback)((t=>{e.toolDismissed()}),[]);return(0,ze.jsxs)(s.N$,{id:"bookmarks-panel",heading:"Bookmarks","data-panel":"bookmarks",hidden:!n,closed:!n||void 0,dismissed:!n||void 0,dismissible:!0,onCalcitePanelDismiss:l,children:[(0,ze.jsx)(s.G1,{icon:"chevron-up",text:"",slot:"header-actions-end",onClick:je.F$}),(0,ze.jsx)("div",{ref:t})]})},Ke=i.memo(Ge)}}]);
//# sourceMappingURL=8340.f4a24f97.chunk.js.map