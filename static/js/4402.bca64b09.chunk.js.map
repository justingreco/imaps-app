{"version":3,"file":"static/js/4402.bca64b09.chunk.js","mappings":"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","sources":["components/Panels/Layers/DevPlanFilter.tsx","components/Panels/Layers/utils/layers.tsx","components/Panels/Layers/utils/tips.ts","components/Panels/Layers/utils/useLayers.ts","components/Panels/Layers/Layers.tsx"],"sourcesContent":["import {\n    CalciteSlider,\n  } from \"@esri/calcite-components-react\";\n  import React, { useCallback } from \"react\";\n  import { useEffect, useRef, useState } from \"react\";\n  import \"./Layers.css\";\n  export const DevPlanFilter = (args: any) => {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const loaded = useRef(false);\n    const [maxYear, setMaxYear] = useState<number>(0);\n    const [minYear, setMinYear] = useState<number>(0);\n\n    const getMinMax = async (layer: __esri.FeatureLayer, datefield: string) => {\n        (args.layer as __esri.FeatureLayer).queryFeatures({\n          where: `EXTRACT(YEAR,${datefield}) >= 2010`,\n          returnGeometry: false,\n            outStatistics: [{\n              statisticType: 'max',\n              onStatisticField: datefield,\n              outStatisticFieldName: 'MAX_DATE'\n            },{\n              statisticType: 'min',\n              onStatisticField: datefield,\n              outStatisticFieldName: 'MIN_DATE'\n            }],\n            outFields: ['MAX_DATE','MIN_DATE']\n\n        }).then((stats) => {\n          if (stats?.features.length) {\n            const max = new Date(stats.features[0].getAttribute('MAX_DATE')).getFullYear();\n            const min = new Date(stats.features[0].getAttribute('MIN_DATE')).getFullYear();\n            layer.definitionExpression = `EXTRACT(YEAR FROM ${args.datefield}) >= ${min}\n            AND EXTRACT(YEAR FROM ${args.datefield}) <= ${max}\n            `;\n            layer.refresh();\n            setMaxYear(max);\n            setMinYear(min);\n            \n          }\n        }).catch(reason => {\n          console.log(reason);\n        });\n\n    }\n    useEffect( () => {\n     if (args.layer && args.datefield && !loaded.current) {\n        loaded.current = true;\n        getMinMax(args.layer, args.datefield).then(() => {\n\n        });\n     }\n\n    }, []); // only after first render\n\n  \n    return (\n      <div>\n        {/* <CalciteInputDatePicker overlay-positioning=\"fixed\" scale=\"m\" max={`2022-11-11`}\n        onCalciteInputDatePickerChange={e => {\n            console.log(e.detail);\n        }}\n        ></CalciteInputDatePicker> */}\n        <CalciteSlider \n          labelHandles \n          labelTicks \n          min={minYear} \n          max={maxYear} \n          maxValue={maxYear} \n          minValue={maxYear - 1} \n          minLabel={minYear.toString()} \n          maxLabel={maxYear.toString()}\n          onCalciteSliderChange={(e) => {\n            args.layer.definitionExpression = `EXTRACT(YEAR FROM ${args.datefield}) >= ${e.target.minValue}\n            AND EXTRACT(YEAR FROM ${args.datefield}) <= ${e.target.maxValue}\n            `;\n            args.layer.refresh();\n          }}\n          ></CalciteSlider>\n      </div>\n    );\n  };\n  export default DevPlanFilter;\n  ","import MapView from \"@arcgis/core/views/MapView\";\nimport WebMap from \"@arcgis/core/WebMap\";\nimport Collection from \"@arcgis/core/core/Collection\";\nimport ActionToggle from \"@arcgis/core/support/actions/ActionToggle\";\nimport LayerList from \"@arcgis/core/widgets/LayerList\";\nimport { lazy, Suspense } from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport FeatureLayer from \"@arcgis/core/layers/FeatureLayer\";\nimport DevPlanFilter from \"../DevPlanFilter\";\nconst OpacitySlider = lazy(() => import(\"../OpacitySlider\"));\n\nexport function initializeLayers(\n  ref: HTMLDivElement,\n  view: MapView\n): Promise<LayerList> {\n  return new Promise((resolve, reject) => {\n    addLayersFromWebmap(view).then(() => {\n      const layers = new LayerList({\n        view: view,\n        container: ref,\n        listItemCreatedFunction: layerListItemCreated,\n      });\n      layers.on(\n        \"trigger-action\",\n        (event: __esri.LayerListTriggerActionEvent) => {\n          if (event.item.layer.title === \"Property\") {\n            togglePropertyLabels(event);\n          }\n        }\n      );\n      resolve(layers);\n    });\n  });\n}\n\nfunction addLayersFromWebmap(view: MapView) {\n  return new Promise((resolve, reject) => {\n    const map = new WebMap({\n      portalItem: {\n        id: \"95092428774c4b1fb6a3b6f5fed9fbc4\",\n      },\n    });\n    map.load().then(() => {\n      const groups = view.map.allLayers\n        .filter((layer) => {\n          return layer.type === \"group\";\n        })\n        .toArray();\n      groups.forEach((group) => {\n        const match = map.allLayers.find((layer) => {\n          return layer.type === \"group\" && layer.title === group.title;\n        }) as __esri.GroupLayer;\n\n        (group as __esri.GroupLayer).addMany(\n          match.layers\n            .filter((layer) => {\n              const found = (group as __esri.GroupLayer).findLayerById(layer.id);\n              //attempting to update stored layer if updated in webmap (popup and renderer)\n              if (found !== undefined) {\n                if (found.type === 'feature') {\n                  (found as __esri.FeatureLayer).popupTemplate = (layer as __esri.FeatureLayer).popupTemplate;\n                  (found as __esri.FeatureLayer).renderer = (layer as __esri.FeatureLayer).renderer;\n                }\n              }\n\n              return (\n                (group as __esri.GroupLayer).findLayerById(layer.id) ===\n                undefined\n              );\n            })\n            .toArray()\n        );\n      });\n      resolve(true);\n    });\n  });\n}\nconst setPropertyColor = (layer: FeatureLayer, light: boolean) => {\n  const renderer = (layer.renderer as __esri.SimpleRenderer).clone();\n  if (light) {\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.r = 0;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.g = 0;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.b = 0;\n  } else {\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.r = 255;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.g = 255;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.b = 255;\n  }\n  layer.renderer = renderer;\n};\nconst togglePropertyColor = (layer: FeatureLayer, sections: any) => {\n  if (sections.length > 1) {\n    setPropertyColor(layer, !sections.getItemAt(1).getItemAt(0).value);\n  }\n};\nexport const togglePropertyLabels = (\n  event: __esri.LayerListTriggerActionEvent\n) => {\n  if (event.item.layer.title === \"Property\") {\n    togglePropertyColor(\n      event.item.layer as FeatureLayer,\n      event.item.actionsSections\n    );\n    if (!(event.item.layer as __esri.FeatureLayer).labelsVisible) {\n      (event.item.layer as __esri.FeatureLayer).labelsVisible = true;\n    }\n    const selected = event.item.actionsSections\n      .getItemAt(0)\n      .filter((section) => {\n        return (section as ActionToggle).value;\n      });\n\n    const selectedTitles = selected.map((section) => {\n      return (section as ActionToggle).title;\n    });\n\n    const selectedExpressions = propertyLabelExpressions.filter(\n      (expression) => {\n        return selectedTitles.includes(expression.title);\n      }\n    );\n    const expressions = selectedExpressions.map((expression) => {\n      return expression.expression;\n    });\n    const expression = expressions.join(\"+ TextFormatting.NewLine+\");\n    (event.item.layer as __esri.FeatureLayer).labelingInfo = [];\n\n    //if ((event.action as ActionToggle).value) {\n    (event.item.layer as __esri.FeatureLayer).labelingInfo = [\n      {\n        // autocasts as new LabelClass()\n        symbol: {\n          type: \"text\", // autocasts as new TextSymbol()\n          color: \"black\",\n          haloColor: \"white\",\n          haloSize: 1,\n          font: {\n            family: \"AvenirNext LT Pro Regular\",\n            style: \"normal\",\n            weight: \"bold\",\n          },\n        },\n        labelExpressionInfo: {\n          expression: expression,\n        },\n        maxScale: 0,\n        minScale: 5000,\n      } as any,\n    ];\n    // }\n    // } else {\n    //   (event.item.layer as __esri.FeatureLayer).labelingInfo = (\n    //     event.item.layer as __esri.FeatureLayer\n    //   ).labelingInfo.filter((info) => {\n    //     return info.labelExpressionInfo.expression != expression.expression;\n    //   });\n    // }\n  }\n};\nconst propertyLabelExpressions: any[] = [\n  {\n    expression: `First(Split($feature['SITE_ADDRESS'], ' '))`,\n    title: \"Address\",\n  },\n  {\n    expression: `$feature['PIN_NUM']`,\n    title: \"PIN\",\n  },\n  {\n    expression: `$feature['REID']`,\n    title: \"REID\",\n  },\n  {\n    expression: `When(IsEmpty($feature[\"SALE_DATE\"]),null, Concatenate(Month($feature[\"SALE_DATE\"])+1, '/',Day($feature[\"SALE_DATE\"]), '/',Year($feature[\"SALE_DATE\"])))`,\n    title: \"Sale Date\",\n  },\n  {\n    expression: `Text($feature.TOTSALPRICE,'$#,###')`,\n    title: \"Sale Price\",\n  },\n];\n\nconst addPropertyLabelToggles = (item: any) => {\n  if (\n    item.layer.title === \"Property\" &&\n    item.layer.type !== \"group\" &&\n    item.actionsSections.length === 0\n  ) {\n    let toggles: Collection = new Collection();\n    toggles.addMany(\n      propertyLabelExpressions.map((expression) => {\n        return new ActionToggle({\n          value: item.layer.labelingInfo?.find((info: any) => {\n            return (\n              info.labelExpressionInfo?.expression.includes(\n                expression.expression\n              ) && item.layer.labelsVisible\n            );\n          }),\n          title: expression.title,\n          visible: true,\n        });\n      })\n    );\n    (item as __esri.ListItem).actionsSections.push(toggles);\n\n    toggles = new Collection();\n    toggles.add(\n      new ActionToggle({\n        value: item.layer.renderer.symbol.outline.color.isBright,\n        title: \"Light Outline\",\n        visible: true,\n      }) as any\n    );\n    (item as __esri.ListItem).actionsSections.push(toggles);\n\n    (item as __esri.ListItem).actionsOpen = true;\n    setTimeout(() => {\n      const title = document.createElement(\"h4\");\n      title.id = \"labels-actions-title\";\n      title.textContent = \"Labels\";\n      title.setAttribute(\"style\", \"padding: 0.5em;margin: 0;\");\n      const actions = document.querySelector(\".esri-layer-list__item-actions\");\n      if (\n        actions?.parentElement &&\n        !document.getElementById(\"labels-actions-title\")\n      ) {\n        actions.prepend(title);\n      }\n    }, 500);\n  }\n};\n\nconst addDevPlanFilters = (item: any) => {\n  if (\n    item.layer.title.includes('Development Plans') &&\n    item.layer.type !== \"group\" &&\n    item.actionsSections.length === 0\n  ) {\n    const filter = document.createElement(\"filter-container\");\n    const root = createRoot(filter as HTMLDivElement);\n    root.render(\n      <Suspense fallback={\"\"}>\n        <DevPlanFilter datefield={'apply_date'} layer={item.layer} />\n      </Suspense>\n    );\n    ((item as __esri.ListItem).panel.content as any[]).push(filter);\n  }\n}\n\nconst createPanel = (item: __esri.ListItem) => {\n  if (\n    item.visible &&\n    !item.panel &&\n    item.layer.type !== \"group\" &&\n    item.layer.type !== undefined\n  ) {\n    const slider = document.createElement(\"slider-container\");\n    const root = createRoot(slider as HTMLDivElement);\n    root.render(\n      <Suspense fallback={\"\"}>\n        <OpacitySlider value={item.layer.opacity} layer={item.layer} />\n      </Suspense>\n    );\n\n    item.panel = {\n      content: [slider, \"legend\"],\n      open: false,\n    } as __esri.ListItemPanel;\n    addDevPlanFilters(item);\n\n  }\n};\n\nconst layerListItemCreated = (event: any): void => {\n  const item = event.item;\n  createPanel(item);\n  item.open = item.layer.visible;\n  item.layer.watch(\"visible\", (visible: boolean) => {\n    // if (item.panel) {\n    //   item.panel.open = visible;\n    // }\n    item.open = visible;\n    createPanel(item);\n\n    if (visible) {\n      if (item.layer.parent) {\n        if (item.layer.parent.type === \"group\") {\n          item.layer.parent.visible = true;\n        }\n      }\n      if (item.layer.parent.parent) {\n        if (item.layer.parent.parent.type === \"group\") {\n          item.layer.parent.parent.visible = true;\n        }\n      }\n    }\n  });\n  addPropertyLabelToggles(item);\n};\n\nexport const filterLayers = (\n  value: string,\n  layerList: __esri.LayerList\n): void => {\n  if (!value) {\n    value = \"\";\n  }\n  layerList.operationalItems.forEach((item: __esri.ListItem) => {\n    if (item.layer.type === \"group\") {\n      let open = false;\n      (item.layer as __esri.GroupLayer).layers.forEach((layer) => {\n        if (layer.title.toLowerCase().includes(value.toLowerCase())) {\n          layer.listMode = \"show\";\n          open = true;\n        } else {\n          layer.listMode = \"hide\";\n        }\n        //handle second level group layers\n        if (layer.type === \"group\") {\n          (layer as __esri.GroupLayer).layers.forEach((sublayer) => {\n            if (sublayer.title.toLowerCase().includes(value.toLowerCase())) {\n              layer.listMode = \"show\";\n              sublayer.listMode = \"show\";\n              open = true;\n            } else {\n              sublayer.listMode = \"hide\";\n            }\n          });\n        }\n      });\n      item.open = value.length > 0 && open;\n      if (!value.length || open) {\n        document\n          .getElementById(\n            `${(layerList as any).id}_${(item as any).uid}__title`\n          )\n          ?.parentElement?.parentElement?.parentElement?.removeAttribute(\n            \"hidden\"\n          );\n      }\n      if (!open) {\n        document\n          .getElementById(\n            `${(layerList as any).id}_${(item as any).uid}__title`\n          )\n          ?.parentElement?.parentElement?.parentElement?.setAttribute(\n            \"hidden\",\n            \"\"\n          );\n      }\n    }\n  });\n};\n\nexport const resetLayers = (list: __esri.LayerList) => {\n  const groups: Collection<__esri.GroupLayer> = list?.view.map.allLayers.filter(layer => {\n    return layer.type === 'group';\n  }) as Collection<__esri.GroupLayer>;\n  groups.forEach((group) => {\n    group.visible = group.title === 'Property';\n    group.layers.forEach(layer => {\n      layer.visible = layer.title === \"Property\";\n    })\n  });  \n};\n","export const tips = {title: 'Layer List Tips', tips: [\n    {\n      title: 'Group Layers',\n      text: 'Layers in the layer list are now grouped based on category, making it easier to find layers.',\n    }\n]}","import { useCallback, useEffect, useRef, useState } from \"react\";\nimport { initializeLayers } from \"./layers\";\nimport { tips } from \"./tips\";\n\nconst useLayers = (args: any) => {\n\n    const ref = useRef() as any;\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const loaded = useRef(false);\n    const [layerList, setLayerList] = useState<__esri.LayerList>();\n    const [isLoading, setIsLoading] = useState(true);\n    const [isActive, setIsActive] = useState(false);\n  \n    useEffect(() => {\n      if (!loaded.current) {\n        loaded.current = true;\n        initializeLayers(ref.current, args.view).then(\n          (layerList: __esri.LayerList) => {\n            setLayerList(layerList);\n            layerList.when(() => {\n              setIsLoading(false);\n            });\n          }\n        );\n      }\n      return () => {\n        layerList && layerList?.destroy();\n      };\n    }, []); // only after first render\n  \n    useEffect(() => {\n      setIsActive(args.isActive);\n    }, [args.isActive]);\n    const panelDismissed = useCallback((e: any) => {\n        args.panelDismissed();\n        }, []);\n    const tipsClicked = useCallback((e: any) => {\n        args.showTips(tips);\n        }, []);    \n    return {\n        ref,\n        layerList,\n        isLoading,\n        isActive,\n        panelDismissed,\n        tipsClicked        \n        }        \n}\nexport default useLayers;","import {\n  CalciteAction,\n  CalciteInput,\n  CalciteScrim,\n  CalcitePanel,\n  CalciteTooltip,\n} from \"@esri/calcite-components-react\";\nimport React from \"react\";\nimport { filterLayers, resetLayers } from \"./utils/layers\";\nimport \"./Layers.css\";\nimport useLayers from \"./utils/useLayers\";\nexport const Layers = (args: any) => {\n  \n  const { \n    ref,\n    layerList,\n    isLoading,\n    isActive,\n    panelDismissed,\n    tipsClicked      \n  } = useLayers(args);\n\n  return (\n    <CalcitePanel\n      id=\"layers-panel\"\n      heading=\"Layers\"\n      hidden={!isActive}\n      closed={!isActive ? true : undefined}\n      dismissed={!isActive ? true : undefined}\n      dismissible\n      onCalcitePanelDismiss={panelDismissed}\n    >\n      <CalciteAction id=\"tip\" icon=\"lightbulb\"  text=\"Tips\" slot=\"header-actions-end\" onClick={tipsClicked}></CalciteAction>\n      <CalciteTooltip label=\"Show Tip\" referenceElement=\"tip\">Show Tip</CalciteTooltip>\n      <div className=\"layers\">\n        {layerList && (\n          <div className=\"row sticky\">\n            <CalciteInput\n              clearable\n              placeholder=\"Filter by layer name\"\n              scale=\"m\"\n              onCalciteInputInput={(e) => {\n                if (layerList) {\n                  filterLayers(e.target.value, layerList);\n                }\n              }}\n            ></CalciteInput>\n            <CalciteAction\n              text=\"clear\"\n              icon=\"viewHide\"\n              scale=\"s\"\n              onClick={() => resetLayers(layerList)}\n            ></CalciteAction>\n          </div>\n        )}\n        <div ref={ref}></div>\n        <CalciteScrim\n          loading\n          hidden={isLoading ? undefined : true}\n        ></CalciteScrim>\n      </div>\n    </CalcitePanel>\n  );\n};\nexport default Layers;\n"],"names":["args","loaded","useRef","maxYear","setMaxYear","useState","minYear","setMinYear","useEffect","layer","datefield","current","async","queryFeatures","where","returnGeometry","outStatistics","statisticType","onStatisticField","outStatisticFieldName","outFields","then","stats","features","length","max","Date","getAttribute","getFullYear","min","definitionExpression","refresh","catch","reason","console","log","getMinMax","labelHandles","labelTicks","maxValue","minValue","minLabel","toString","maxLabel","onCalciteSliderChange","e","target","OpacitySlider","lazy","initializeLayers","ref","view","Promise","resolve","reject","map","WebMap","portalItem","id","load","allLayers","filter","type","toArray","forEach","group","match","find","title","addMany","layers","found","findLayerById","undefined","popupTemplate","renderer","addLayersFromWebmap","LayerList","container","listItemCreatedFunction","layerListItemCreated","on","event","item","togglePropertyLabels","sections","actionsSections","light","clone","symbol","outline","color","r","g","b","setPropertyColor","getItemAt","value","labelsVisible","selectedTitles","section","selectedExpressions","propertyLabelExpressions","expression","includes","expressions","join","labelingInfo","haloColor","haloSize","font","family","style","weight","labelExpressionInfo","maxScale","minScale","createPanel","visible","panel","slider","document","createElement","createRoot","render","Suspense","fallback","opacity","content","open","push","addDevPlanFilters","watch","parent","toggles","Collection","ActionToggle","info","add","isBright","actionsOpen","setTimeout","textContent","setAttribute","actions","querySelector","parentElement","getElementById","prepend","addPropertyLabelToggles","tips","text","layerList","setLayerList","isLoading","setIsLoading","isActive","setIsActive","when","destroy","panelDismissed","useCallback","tipsClicked","showTips","Layers","useLayers","heading","hidden","closed","dismissed","dismissible","onCalcitePanelDismiss","icon","slot","onClick","label","referenceElement","className","clearable","placeholder","scale","onCalciteInputInput","operationalItems","toLowerCase","listMode","sublayer","uid","removeAttribute","filterLayers","list","loading"],"sourceRoot":""}