"use strict";(globalThis.webpackChunkimaps_app=globalThis.webpackChunkimaps_app||[]).push([[1468],{11468:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var a=s(85580),i=s(72791),l=s(87616),d=s(79803),r=s(585);const n=e=>{const t=(0,i.useRef)(!1),s=(0,i.useRef)(null),a=(0,i.useRef)(null),n=(0,i.useRef)(null),[c,u]=(0,i.useState)(""),[o,v]=(0,i.useState)(!1),[p,h]=(0,i.useState)(!1);let m,f;const[g,x]=(0,i.useState)("dd"),b=(0,i.useRef)("dd"),w=(0,i.useCallback)((e=>{v((e=>!e))}),[]),k=(0,i.useCallback)((e=>{h((e=>!e))}),[]),C=(0,i.useCallback)((t=>{var s,a,i;(t.target.active=!t.target.active,t.target.active)?(null===(s=m)||void 0===s||s.remove(),R(e.view,e.clickActivated)):(null===(a=f)||void 0===a||a.remove(),e.view.popup.autoOpenEnabled=!0,null===(i=document.querySelector(".identify-widget"))||void 0===i||i.classList.add("active"),A())}),[]),S=(0,i.useCallback)((e=>{console.log(e.target.value),x(e.target.value),b.current=e.target.value}),[b]),j=(0,i.useCallback)((t=>{l.zD().then((()=>{let t=null,i=!0;if("dd"===b.current&&(isFinite(a.current.value)&&Math.abs(a.current.value)<=90?(a.current.setAttribute("status","valid"),i=!1):a.current.setAttribute("status","invalid"),isFinite(s.current.value)&&Math.abs(s.current.value)<=180?(s.current.setAttribute("status","valid"),i=!1):s.current.setAttribute("status","invalid"),t=new r.Z({x:s.current.value,y:a.current.value,spatialReference:{wkid:4326}})),"dms"===b.current){const e=$(!0,a.current.value);a.current.setAttribute("status",e);const d=$(!1,s.current.value);s.current.setAttribute("status",d),i="valid"===e&&"valid"===d,t=l.QU(`${a.current.value} ${s.current.value}`)}"spft"===b.current&&(t=new r.Z({x:s.current.value,y:a.current.value,spatialReference:{wkid:4326}}),t=d.iV(t,e.view.map.spatialReference)),"usng"===b.current&&(t=l.cZ(n.current.value,e.view.map.spatialReference)),"mgrs"===b.current&&(t=l.BZ(n.current.value,e.view.map.spatialReference,"automatic")),"utm"===b.current&&(t=l.DR(n.current.value,e.view.map.spatialReference,"latitude-band-indicators")),i&&e.view.goTo(t)}))}),[]),$=(e,t)=>(e?/^((90[\xb0|\s]\s*)(0{1,2}['|\s]\s*)(0{1,2}([.|,]0{1,20})?["|\s]\s*)|(([1-8]\d|\d)[\xb0|\s]\s*)(([0-5]\d|\d)['|\s]\s*)(([0-5]\d|\d)([.|,]\d{1,20})?["|\s]\s*))$/gm:/^[-]((180[\xb0|\s]\s*)(0{1,2}['|\s]\s*)(0{1,2}([.|,]0{1,20})?["|\s]\s*)|((1[0-7]\d|\d\d|\d)[\xb0|\s]\s*)(([0-5]\d|\d)['|\s]\s*)(([0-5]\d|\d)([.|,]\d{1,20})?["|\s]\s*))/gm).test(`${t} `)?"valid":"invalid",y=t=>{const s=e.view.toMap({x:t.x,y:t.y}),a=new r.Z({x:s.longitude,y:s.latitude,spatialReference:{wkid:4326}});if("dd"===b.current){let e=l.Ow(a,"dd",7).replaceAll("078.","78.").split(" ");e[0].includes("S")&&(e[0]=`-${e[0].replace("S","")}`),e[0].includes("N")&&(e[0]=`${e[0].replace("N","")}`),e[1].includes("W")&&(e[1]=`-${e[1].replace("W","")}`),e[1].includes("E")&&(e[1]=`${e[1].replace("N","")}`),u(e.join(" "))}else if("dms"===b.current){const e=l.Ow(a,"dms",7).split(" "),t=`${e[0]}\xb0 ${e[1]}' ${e[2].replace("N",'"')} -${e[3].substring(1)}\xb0 ${e[4]}' ${e[5].replace("W",'"')}`;u(t)}else if("usng"===b.current)u(l.on(a,5,!0));else if("mgrs"===b.current)u(l.$B(a,"automatic",5,!0));else if("utm"===b.current)u(l.$i(a,"latitude-band-indicators",!0));else if("spft"===b.current){const e=d.iV(s,{wkid:2264});u(`${e.x.toString()}E, ${e.y.toString()}N`)}},R=(t,s)=>{var a;s(t),e.view.popup.autoOpenEnabled=!1,null===(a=document.querySelector(".identify-widget"))||void 0===a||a.classList.remove("active"),f=e.view.on("click",(e=>{y(e)}))},A=()=>{m=e.view.on("pointer-move",(e=>{y(e)}))};return(0,i.useEffect)((()=>{if(!t.current&&e.view)return t.current=!0,e.expand&&(e.expand.hasHandles()||e.expand.watch("expanded",(e=>{var t,s;e||(null===(t=m)||void 0===t||t.remove(),null===(s=f)||void 0===s||s.remove())}))),A(),()=>{}}),[]),{loaded:t,coordinates:c,settingsClicked:w,showSettings:o,formats:[{value:"dd",label:"Decimal Degrees"},{value:"dms",label:"Degrees Minutes Seconds"},{value:"spft",label:"Stateplane Feet"},{value:"usng",label:"US National Grid"},{value:"mgrs",label:"MGRS"},{value:"utm",label:"UTM"}],formatChanged:S,searchClicked:k,showSearch:p,selectedFormat:g,searchCoordinates:j,x:s,y:a,other:n,modeClicked:C}};var c=s(80184);function u(e){var t,s;const{loaded:i,coordinates:l,settingsClicked:d,showSettings:r,formats:u,formatChanged:o,searchClicked:v,showSearch:p,selectedFormat:h,searchCoordinates:m,x:f,y:g,other:x,modeClicked:b}=n(e);return(0,c.jsxs)("div",{id:"coordinatesWidget",children:[(0,c.jsx)("div",{hidden:!r||void 0,children:(0,c.jsx)(a.ko,{scale:"s",label:"Coordinate Systems",onCalciteSelectChange:o,children:u.map((e=>(0,c.jsx)(a.GB,{value:e.value,children:e.label},e.value)))})}),(0,c.jsxs)("div",{hidden:!p||void 0,children:[(0,c.jsxs)(a.ZK,{scale:"s",children:["dd"===h?"Latitude":"spft"===h?"Northing":"dms"===h?"Latitude":"",(0,c.jsx)(a.e,{scale:"s",ref:g,hidden:!["dd","spft","dms"].includes(h)||void 0,id:"ycoord",placeholder:"dd"===h?"-78.8079653":"spft"===h?"731166.165":"dms"===h?"35\xb0 45' 29.7116777\"":""}),(0,c.jsx)(a.Bi,{hidden:"invalid"!==(null===(t=g.current)||void 0===t?void 0:t.getAttribute("status"))||void 0,status:"invalid",children:"Value is not valid"})]}),(0,c.jsxs)(a.ZK,{scale:"s",children:["dd"===h?"Longitude":"spft"===h?"Easting":"dms"===h?"Longitude":"",(0,c.jsx)(a.e,{scale:"s",ref:f,hidden:!["dd","spft","dms"].includes(h)||void 0,id:"xcoord",placeholder:"dd"===h?"35.7582196":"spft"===h?"2056872.973":"dms"===h?"-78\xb0 48' 31.524\"":""}),(0,c.jsx)(a.Bi,{hidden:"invalid"!==(null===(s=f.current)||void 0===s?void 0:s.getAttribute("status"))||void 0,status:"invalid",children:"Value is not valid"})]}),(0,c.jsx)(a.e,{scale:"s",ref:x,hidden:!!["dd","spft","dms"].includes(h)||void 0,id:"othercoord",placeholder:"usng"===h?"17S PV 98178 59368":"mrgs"===h?"17S PV 98136 59346":"utm"===h?"17S 698184 3959363":""}),(0,c.jsx)(a.ln,{onClick:m,width:"full",scale:"s",children:"Search"})]}),(0,c.jsxs)("div",{className:"coordinates-row",children:[(0,c.jsx)("div",{className:"coordinates-text",children:l}),(0,c.jsx)(a.G1,{scale:"s",text:"",icon:"search",active:!!p||void 0,onClick:v}),(0,c.jsx)(a.G1,{scale:"s",text:"",icon:"gear",onClick:d,active:!(!r&&!p)||void 0}),(0,c.jsx)(a.G1,{scale:"s",text:"",icon:"pin",onClick:b})]})]})}const o=i.memo(u)}}]);
//# sourceMappingURL=1468.0dd37ee5.chunk.js.map